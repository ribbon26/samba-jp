.\"     Title: smb.conf
.\"    Author: 
.\" Generator: DocBook XSL Stylesheets v1.73.2 <http://docbook.sf.net/>
.\"      Date: 12/01/2008
.\"    Manual: ファイルフォーマットと変換
.\"    Source: Samba 3.2
.\"
.TH "SMB\.CONF" "5" "12/01/2008" "Samba 3\.2" "ファイルフォーマットと変換"
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
smb.conf - Samba の設定ファイル
.SH "概要"
.PP
\fIsmb\.conf\fR
ファイルは Samba システムの設定ファイルである。\fIsmb\.conf \fR
には、Samba システムの各プログラムが実行時に参照する設定情報が記述される。
\fIsmb\.conf\fR
ファイルは、\fBswat\fR(8)
プログラムによって設定、 管理されるように設計されている。 以下参照目的で、ファイルの形式と設定可能なパラメータに関して網羅的に記述する。
.SH "ファイルの形式"
.PP
ファイルはセクションとパラメータから構成される。セクションは、 大括弧(\(lq[\(rq
と
\(lq]\(rq) で囲まれたセクション名で始まり、次のセクションが始まるまで 続く。セクション内には以下の形式でパラメータが記述される:
.sp
.RS 4
.nf
\fIパラメータ名（パラメータ）\fR = \fIパラメータ値（値）\fR
.fi
.RE
.PP
ファイルは行を基本単位とし、改行で終了する各行は、コメント、 セクション名、パラメータのいずれかを表す。
.PP
セクション名およびパラメータ名は大文字と小文字を区別しない。
.PP
パラメータを示す行では、最初の 「=」 文字に重要な意味がある。 最初の 「=」 文字の前後の空白文字は破棄される。 セクション名およびパラメータ名の先頭、 途中、末尾にある空白文字は 無視される。パラメータ値の先頭と末尾にある空白文字も無視される。 ただし、パラメータ値の途中にある空白文字はそのまま意味を持つ。
.PP
セミコロン (\(lq:\(rq)、シャープ (\(lq#\(rq) で始まる行や、空白のみの行は 無視される。
.PP
\(lq\e\(rq
文字で終わる行は、UNIX の慣習通り次の行へ継続する。
.PP
「=」文字に続くパラメータ値には、文字列 (引用符で囲む必要はない)、または真偽値を表す、yes/no、0/1、true/false のいずれかを記述する。真偽値の場合、大文字と小文字は同じ意味だが、 記述されたとおりの文字列が保存される。 create mask など、幾つかのパラメータ値は数値となる。
.SH "セクションの説明"
.PP
設定ファイル中の ([global] セクションを除く) 各セクションでは、 共有リソース (単に\(lq共有\(rqとも呼ぶ (訳注: 「サービス」とも呼ばれる)) の設定が行なわれる。 セクション名は共有リソース名となり、 セクション内のパラメータは共有の設定に利用される。
.PP
[global]、[homes]、[printers] という 3 つの特殊なセクションに ついては、\fI特殊なセクション\fR
で説明する。 以下の説明は、通常のセクションについてのものである。
.PP
共有の設定としては、大きくアクセスを許可するディレクトリの設定と それを利用するユーザに対するアクセス許可の設定とがある。 その他いくつかの補助的なオプションの指定も可能である。
.PP
セクションは、ファイル共有サービス (クライアントからファイルシステムの延長として利用される) とプリントサービス (クライアントからサーバ上で動作している 印刷サービスにアクセスするために利用される) のいずれかに分類される。
.PP
セクションは、パスワードなしでアクセスできる
\fIゲスト\fR
サービスとして構成することもできる。 この場合、UNIX 側で指定された\fIゲストアカウント\fRの権限でアクセスが 行なわれる。
.PP
ゲストサービス以外のセクションにアクセスするにはパスワードが 必要である。通常クライアントからはユーザ名も提供されるが、 年代物のクライアントはパスワードのみでユーザ名を提供しないため、
\(lquser =\(rq
パラメータで指定したユーザのリストを用いてパスワードの検証を 行なうことも可能である。Windows 95/98/Me/NT/2000 のような最近の クライアントでは、このパラメータは不要である。
.PP
Samba より与えられたアクセス権は、システムより UNIX ユーザ (またはゲストユーザ) に与えられたアクセス権によって制限されることに注意して欲しい。 Samba はシステムが許可する以上のアクセス権を許可することはできない。
.PP
以下の簡単なセクションは、ファイル共有を定義するものである。 ユーザは
\fI/home/bar\fR
に対して書き込みができる。 共有は、foo
という共有名でアクセス可能である:
.sp
.RS 4
.nf
	\fI[foo]\fR
	\fIpath = /home/bar\fR
	\fIread only = no\fR
.fi
.RE
.PP
以下の簡単なセクションは印刷サービスを定義するものである。 共有は読み取りのみであるが、印刷可能である。これは、 スプールファイルのオープン、書き込み、クローズという作業についてのみ書き込みが許可されるということである。\fIguest ok\fR
パラメータは、(別途定義された) デフォルトのゲストユーザとしてアクセスが許可されていることを意味する:
.sp
.RS 4
.nf
	\fI[aprinter]\fR
	\fIpath = /usr/spool/public\fR
	\fIread only = yes\fR
	\fIprintable = yes\fR
	\fIguest ok = yes\fR
.fi
.RE
.sp
.SH "特殊なセクション"
.SS "[global] セクション"
.PP
このセクション中のパラメータは、サーバ全体に対して、 もしくは各セクションで項目が定義していないときの既定値として 適用される。詳細な情報はパラメータ(PARAMETERS)の節を参照のこと。
.SS "[homes] セクション"
.PP
homes セクションが設定ファイル中にあると、 接続してきたユーザのホームディレクトリを共有するサービスが 必要時にサーバによって作成されるようになる。
.PP
接続の要求が行なわれると、存在するセクションが検索される。 要求に合致するセクションが見つかった場合はそのセクションが 利用される。見つからなかった場合は、 要求されたセクション名をユーザ名とみなしてローカルのパスワードファイルが検索される。 ファイル中に名前が存在して、パスワードが適切だった場合、 [homes] セクションの設定を引き継ぐ形で共有が作成される。
.PP
新しく作成される共有に対しては、 幾つかの変更が行なわれる:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
共有名は、homes からユーザ名に変更される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
path パラメータが設定されていなかった場合、 ディレクトリのパスはユーザのホームディレクトリに設定される。
.sp
.RE
.PP
\fIpath = \fR
行を [homes] セクションに記述した場合、"%S" マクロを用いると便利になる 場合があるかも知れない。以下に一例を示す:
.PP
\fBpath = /data/pchome/%S\fR
.PP
これは、UNIX からのアクセスと PC からのアクセスとでホームディレクトリが異なる場合に便利である。
.PP
これは多数のクライアントに対するホームディレクトリの 提供を最小の手間で素早く簡単に実現する方法である。
.PP
要求されたセクション名が
\(lqhomes\(rq
の場合にも同様の処理が行われるが、共有名が要求したユーザの 名前に変更されることはない。 [homes] セクションを使用する 方法は、複数のユーザがクライアント PC を共有する場合に 便利である。
.PP
[homes] セクションでは、通常のサービスで指定可能な すべてのパラメータを指定できるが、幾つかのものは他の セクションと少し違った意味になる。以下は典型的な [homes] セクションの例である:
.sp
.RS 4
.nf
\fI[homes]\fR
\fIread only = no\fR
.fi
.RE
.PP
重要な点として、[homes] セクションでゲストアクセスを許可した場合、 全てのホームディレクトリが全てのクライアントから
\fIパスワードなしで\fR
アクセス可能になるという点が挙げられる。 ほとんどあり得ないと思うが、もしこの設定を実際に行なうのであれば、\fI読み取り専用\fR
アクセスの設定にしておくことが好ましいであろう。
.PP
自動的に作成されるホームディレクトリの
\fIbrowseable\fR
パラメータの値は、[homes] セクションの browseable パラメータからではなく、[global] セクションの browseable パラメータより継承される。これは、 [homes] セクションで
\fIbrowseable = no\fR
を指定して [homes] 共有を不可視にしても、自動的に作成されるホームディレクトリを表示させるようにするための仕様である。
.SS "[printers] セクション"
.PP
このセクションは、プリンタ用の [homes] セクションに 相当する。
.PP
[printers] セクションが設定されていると、ユーザは、 ローカルホストの printcap ファイルで設定されている各プリンタに接続することが可能となる。
.PP
接続の要求が行なわれると、存在するセクションが検索される。 要求に合致するセクションが見つかった場合はそのセクションが利用される。 見つからなかった場合、[homes] セクションがあれば前述した処理が行なわれる。 それでも要求が解決できない場合は、 要求されたセクション名をプリンタ名とみなし、 適切な pritcap ファイルが検索され、 要求されたセクション名をプリンタ共有名とみなすかどうかの 確認が行なわれる。ファイル中に名前が存在した場合は、 [printers] セクションの設定を引き継ぐ形でプリンタ共有が 作成される。
.PP
新しく作成される共有に対しては、 幾つかの変更が行なわれる:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
共有名には、実際のプリンタ名が設定される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
プリンタ名が設定されていない場合、 プリンタ名として実際のプリンタ名が設定される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
共有がゲストアクセスを許可しておらず、 username パラメータも指定されていない場合、username に実際のプリンタ名が設定される。
.sp
.RE
.PP
[printers] サービスは、必ず printable にすること。 それ以外の設定を行なうと、サーバが設定ファイルの読み取りを 拒否してしまう。
.PP
通常指定されるパスは、sticky ビットが設定され、 誰でも書き込み可能になっているスプールディレクトリである。 典型的な [printers] のエントリは次のようになる:
.sp
.RS 4
.nf
\fI[printers]\fR
\fIpath = /usr/spool/public\fR
\fIguest ok = yes\fR
\fIprintable = yes\fR
.fi
.RE
.PP
printcap ファイル中で定義されているすべてのプリンタの エイリアス(別名)は、プリンタ名として認識される。 印刷システムが printcap ファイルのような機構を使用して いないのであれば、仮の printcap ファイルを設定する必要がある。 このファイルは以下のような形式の行で構成される:
.sp
.RS 4
.nf
alias|alias|alias|alias\.\.\.    
.fi
.RE
.PP
各エイリアスは、印刷システムが処理可能なプリンタ名で ある必要がある。[global] セクションで、別のファイルを printcap ファイルとして指定することで、仮想的な printcap ファイル中にある名前のみがサーバに認識される。 もちろんこのファイル中には任意のエイリアスを記述することが 可能である。このテクニックは、ローカルプリンタの一部のみに アクセスを制限する機能を簡単に実現するためにも利用できる。
.PP
なお、エイリアスとは printcap ファイル中の各レコードの 最初のエントリに続く各要素をさす。 各レコードは改行コードで区切られ、各要素は (複数個存在する場合) 縦棒 (|) で区切られる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
.PP
lpstat コマンドによりシステムで定義されている プリンタの一覧を取得可能な SYSV 系のシステムでは、
printcap name = lpstat
とすることで、 プリンタの一覧を取得することが可能である。 詳細は、printcap name
オプションを参照のこと。
.SH "ユーザ定義共有"
.PP
Samba 3\.0\.23 より、root 以外のユーザが共有の追加、修正、削除を行なうことを可能とする機能が追加された。 この機能を
\fIユーザ定義共有(usershares)\fR
と呼び、 smb\.conf の

セクションで定義される一連のパラメータによって制御される。 関連するパラメータを以下に示す :
.PP
usershare allow guests
.RS 4
ユーザ定義共有でゲストアクセスを許可するかどうかを制御する。
.RE
.PP
usershare max shares
.RS 4
作成を許可するユーザ定義共有の最大数を制御する。
.RE
.PP
usershare owner only
.RS 4
有効にすると、ユーザが所有しているディレクトリのみが共有可能となる。
.RE
.PP
usershare path
.RS 4
ユーザ定義共有を作成可能なディレクトリを指定する。 実際にユーザ定義共有を作成可能かどうかは、ファイルシステム上のディレクトリのパーミッションに依存する。
.RE
.PP
usershare prefix allow list
.RS 4
共有を許可するディレクトリの絶対パス名をコンマで区切って列挙する。 ここで指定されたパス名から始まるディレクトリのみが共有を許可される。
.RE
.PP
usershare prefix deny list
.RS 4
共有を拒否するディレクトリの絶対パス名をコンマで区切って列挙する。 ここで指定されたパス名から始まるディレクトリは共有を拒否される。
.RE
.PP
usershare template share
.RS 4
新しいユーザ定義共有を作成する際のテンプレートとなる既存の共有を指定する。 ユーザ定義共有の定義時に指定されなかったすべての共有に関するパラメータは、この共有のものが用いられる。
.RE
.PP
UNIX グループ
foo
のメンバにユーザ定義共有の作成を許可したい場合は、 共有の定義ファイルを格納するディレクトリを以下のように作成する:
.PP
root 権限で以下を実施:
.sp
.RS 4
.nf
mkdir /usr/local/samba/lib/usershares
chgrp foo /usr/local/samba/lib/usershares
chmod 1770 /usr/local/samba/lib/usershares
.fi
.RE
.PP
ついで、以下のパラメータ
.sp
.RS 4
.nf
	\fIusershare path = /usr/local/samba/lib/usershares\fR
	\fIusershare max shares = 10\fR # (もしくは必要な共有数)
.fi
.RE
.PP
を
\fIsmb\.conf\fRの global セクションに追加。 これにより foo グループのメンバは、以下のコマンドでユーザ定義共有を作成することが可能となる。
.PP
net usershare add sharename path [comment] [acl] [guest_ok=[y|n]]
.RS 4
これにより、ユーザ定義共有を作成もしくは修正(上書き)する。
.RE
.PP
net usershare delete sharename
.RS 4
ユーザ定義共有を削除する。
.RE
.PP
net usershare list wildcard\-sharename
.RS 4
ユーザ定義共有を一覧する。
.RE
.PP
net usershare info wildcard\-sharename
.RS 4
ユーザ定義共有の情報を表示する。
.RE
.SH "パラメータ"
.PP
パラメータはセクションの属性を定義するものである。
.PP
幾つかのパラメータ (\fIsecurity\fR
など) は、 [global] セクションで指定する。また幾つかのパラメータ (\fIcreate mask\fR
など) は、すべてのセクションで 利用可能である。それ以外のパラメータは、通常のセクションでのみ 利用できる。以下の説明では、[homes] と [printers] セクションを "通常の" セクションとして扱う。(\fIG\fR) がついたパラメータは、 [global] セクションでのみ指定できる。(\fIS\fR) がついたパラメータは、個々のサービスを表すセクションで指定できる。 ただし、(\fIS\fR) がついたパラメータは、[global] セクション中で指定することも可能である。この場合、それらはすべての サービスに対するデフォルト値として機能する。
.PP
パラメータはアルファベット順に説明されている。 最良の順序とはいえないが、少なくとも目的のパラメータを見つけることは できるだろう。同義語がある場合は、主として用いるべき表記の部分で 説明が行なわれ、他はその表記への参照になっている。
.SH "変数による置換"
.PP
設定ファイルに記述可能な文字列の多くには、変数による置換を利用できる。 たとえば、\(lqpath = /tmp/%u\(rq
は、john というユーザ名でユーザが 接続すると、\(lqpath = /tmp/john\(rq
として解釈される。
.PP
これら置換の詳細については、各々のパラメータの説明にて 解説するが、どのパラメータに対しても適用される共通の変数置換もいくつか 存在する。それらを以下に記載する:
.PP
%U
.RS 4
セッションのユーザ名 (クライアントが接続時に 送信したものであるが、実際に接続したユーザ名と同じであるとは 限らない)。
.RE
.PP
%G
.RS 4
%U のプライマリグループ。
.RE
.PP
%h
.RS 4
Samba が動作しているマシンの インターネットホスト名。
.RE
.PP
%m
.RS 4
クライアントマシンの NetBIOS 名 (とても便利)。
.sp
Samba がポート 445 で待機している場合、クライアントがこの情報を送信しないため、この変数は利用できない。 Samba がドメインコントローラであるドメインで include パラメータにおいてこの変数を用いている場合などは、 [global] セクションで
\fIsmb ports = 139\fR
の設定を行なうこと。 これにより Samba はポート 445 で待機しなくなり、Samba 2\.X で実現していた include 機能が利用できる。
.RE
.PP
%L
.RS 4
サーバの NetBIOS 名。これを用いることで、 クライアントから呼ばれた名前に応じて設定を変更することが 可能となる。これによりサーバは
\(lq二つの顔\(rq
を持つことができる。
.RE
.PP
%M
.RS 4
クライアントマシンのインターネットホスト名。
.RE
.PP
%R
.RS 4
プロトコルのネゴシエーションを経て選択された プロトコルレベル。これは CORE、COREPLUS、LANMAN1、LANMAN2、NT1 のいずれかの値をとる。
.RE
.PP
%d
.RS 4
サーバプロセスのプロセス ID。
.RE
.PP
%a
.RS 4
リモートマシンのアーキテクチャ。 現在認識できるのは Samba (\fBSamba\fR)、 Linux の CIFS ファイルシステム (\fBCIFSFS\fR)、 OS/2 (\fBOS2\fR)、 Windows for Workgroups (\fBWfWg\fR)、 Windows 9x/Me (\fBWin95\fR)、 Windows NT (\fBWinNT\fR)、 Windows 2000 (\fBWin2K\fR)、 Windows XP (\fBWinXP\fR)、 Windows XP 64\-bit(\fBWinXP64\fR), 2003R2 (\fBWin2K3\fR)を含むWindows Server 2003 (\fBWin2K3\fR)と, Windows Vista (\fBVista\fR) である。 それ以外のものは
\(lqUNKNOWN\(rq
となる。
.RE
.PP
%I
.RS 4
クライアントマシンの IP アドレス。
.RE
.PP
%i
.RS 4
クライアントが接続してきたサーバの IP アドレス。
.RE
.PP
%T
.RS 4
現在の日付と時間。
.RE
.PP
%D
.RS 4
現ユーザが所属するドメインかワークグループ名。
.RE
.PP
%w
.RS 4
Winbind のセパレータ
.RE
.PP
%$(\fIenvvar\fR)
.RS 4
環境変数\fIenvvar\fRの値。
.RE
.PP
以下の置換マクロは (すでに接続が確立されている場合に) いくつかの 設定オプションに対して有効なものである:
.PP
%S
.RS 4
現在のサービス名 (存在する場合)。
.RE
.PP
%P
.RS 4
現在のサービスのトップディレクトリ (存在する場合)。
.RE
.PP
%u
.RS 4
現在のサービスのユーザ名 (存在する場合)。
.RE
.PP
%g
.RS 4
%u のプライマリグループ。
.RE
.PP
%H
.RS 4
%u で指定されたユーザのホームディレクトリ。
.RE
.PP
%N
.RS 4
NIS のホームディレクトリサーバの名前。 これは NIS の auto\.map エントリから取得される。Samba が
\fI\-\-with\-automount\fR
オプションをつけて コンパイルされていない場合、このオプションは %L と同じになる。
.RE
.PP
%p
.RS 4
NIS auto\.map エントリから取得された サーバの ホームディレクトリのパス。NIS auto\.map エントリは
%N:%p
のように分割されている。
.RE
.PP
これらの置換操作とその他の
\fIsmb\.conf\fR
のパラメータを組み合わせると、非常に凝った動作を設定できる。
.SH "名前の短縮(NAME MANGLING)"
.PP
Samba は、DOS や Windows クライアントが 8\.3 形式に準拠しない 名前のファイルを扱うことができるように
\(lq名前の短縮\(rq
機能を提供している。この機能により、8\.3 形式のファイル名についても 文字の case (大文字、小文字) を調整可能である。
.PP
短縮時の動作を制御するパラメータが幾つか存在しており、 それらは個々に解説を行なわず、ここでまとめて説明を行なう。 デフォルト値は testparm コマンドの出力を参照のこと。
.PP
以下のオプションは、すべて共有毎に設定できる (もちろん全体に対しても設定できる)。
.PP
オプションは以下の通りである:
.PP
case sensitive = yes/no/auto
.RS 4
ファイル名の case を識別するかどうかを制御する。 識別を行なわない場合、Samba は指定された名前に合致する ファイル名の有無を検索することが必要になる。デフォルトは
\fIauto\fR
であり、ファイル名の case を識別するクライアント(現在のところ Linux CIFSVFS や Samba 3\.0\.5 以降の smbclient) に対しては、case を識別する(UNIX の case を識別する挙動に準拠する) ファイルシステム上の Samba サーバにアクセスしているものとして通知する。 Windows および DOS システムでは case を識別するファイル名はサポートされておらず、このパラメータを auto に設定した場合、no の設定で動作する。 デフォルトは
\fIauto\fR
である。
.RE
.PP
default case = upper/lower
.RS 4
新しく作成されるファイル(現在ファイルシステム上に存在していないファイル)のファイル名のデフォルトの case を制御する。 デフォルトは
\fIlower\fR
である。 重要:
\fIcase sensitive = yes\fR、
\fIpreserve case = No\fR、
\fIshort preserve case = No\fR
の場合、このオプションにより、新しく作られるファイル名だけではなく、クライアントから渡される
\fIすべての\fR
ファイル名の case が変更されることに注意。 非常に多くのファイルを格納するディレクトリの最適化作業の一貫として、この設定変更が必要となる。
.RE
.PP
preserve case = yes/no
.RS 4
新しく作成されるファイル(現在ファイルシステム上に存在していないファイル)のファイル名について、クライアントから 渡された case で作成するか、デフォルトの case で作成するかを制御する。 デフォルトは
\fIyes\fRである。
.RE
.PP
short preserve case = yes/no
.RS 4
すべて大文字で適切な長さの 8\.3 形式に 準拠した新しく作成されるファイル(現在ファイルシステム上に存在していないファイル)のファイル名について、大文字で作成するか、
デフォルト
の case で作成するかを制御する。 このオプションにより、preserve case = yes
で長いファイル名が case を保持する設定の時であっても、 短いファイル名は小文字で作成するといったことが可能になる。 デフォルトは
\fIyes\fR
である。
.RE
.PP
Samba 3\.0 のデフォルトは、Windows NT のサーバと同様に動作する。 すなわち、case を識別しないが case は保持する。 ただし、大量のファイルが存在するディレクトリにおいては、case 関連のパラメータを "case sensitive = yes"、"case preserve = no"、"short preserve case = no" に設定するとよいであろう。 これにより、"default case" パラメータが有効になり、クライアントから送信されるすべてのファイル名が変更される。 (訳注: 上記設定は、case sensitive = yes によりファイル名の検索を抑止することで、パフォーマンスを向上させようとする意図だと思われる)
.SH "ユーザ名とパスワード認証についての注意"
.PP
ユーザがサービスに接続するための方法は幾つかある。サーバは、 以下のステップを踏みサービスに対して接続を許可するかどうかを確認する。 すべてのステップが失敗した場合、接続要求は拒否される。 いずれかのステップで成功した場合、それ以降のステップは行なわれない。
.PP
サービスが
\(lqguest only = yes\(rq
となっており、 サーバが共有レベルのセキュリティ (\(lqsecurity = share\(rq) で構成されている場合、ステップ 1 から 5 は省かれる。
.sp
.RS 4
\h'-04' 1.\h'+02'クライアントからユーザ名とパスワードが 提供されており、それが UNIX システムのパスワード機構によって 認証された場合、そのユーザ名を使った接続が行なわれる。この ステップは
\e\eserver\eservice%\fIusername\fR
形式でユーザ名が提供された場合にも行なわれることに注意。
.RE
.sp
.RS 4
\h'-04' 2.\h'+02'クライアントからシステムに登録されている ユーザ名が提供された場合、そのユーザ名に対する適切な パスワードが提供されれば、接続が許可される。
.RE
.sp
.RS 4
\h'-04' 3.\h'+02'クライアントの NetBIOS 名および以前に使われた ユーザ名について提供されたパスワードとの確認が行なわれ、 合致すれば、対応するユーザ名を使った接続が許可される。
.RE
.sp
.RS 4
\h'-04' 4.\h'+02'クライアントが既にユーザ名とパスワードを 提供してサーバに認証されており、その際の認証トークンが 提示された場合、そのユーザ名が使われる。
.RE
.sp
.RS 4
\h'-04' 5.\h'+02'user =
フィールドが
\fIsmb\.conf\fR
ファイルで 該当サービスに対して設定されており、クライアントから提供された パスワードが (UNIX システムのパスワード認証により)
user =
行に記述されたユーザ名のいずれかのものと 合致した場合、接続は、user =
行で設定された ユーザ名で行なわれる。user =
リスト中のユーザ名の 中に
@
ではじまるものがあった場合、それはその名前の グループに所属するユーザ名のリストに展開される。
.RE
.sp
.RS 4
\h'-04' 6.\h'+02'サービスがゲストサービスの場合、 提供されたパスワードがなんであっても、そのサービスの
guest account =
で指定されたユーザ名で接続が 行なわれる。
.RE
.SH "レジストリベースの設定方法"
.PP
Sambaのバージョン 3\.2\.0 から、レジストリ中にSambaの設定を 格納する機能が有効になった。Sambaの設定は、レジストリキー
\fIHKLM\eSoftware\eSamba\esmbconf\fR中に格納される。 レジストリベースの設定は2つのレベルがある。
.sp
.RS 4
\h'-04' 1.\h'+02'レジストリに共有の定義を格納する。 これは、\fIsmb\.conf\fR中のグローバル パラメータ\fIregistry shares\fR
を\(lqyes\(rqに設定することで利用可能になる。
.sp
レジストリ定義の共有はスタートアップ時にはロードされ ないが、\fIsmbd\fRによって、実行時に動的に ロードされる。\fIsmb\.conf\fR中の共有定義 はレジストリ中での同じ名前の共有定義に優先する。
.RE
.sp
.RS 4
\h'-04' 2.\h'+02'グローバルな\fIsmb\.conf\fR
オプションをレジストリに格納する。これは,以下の2つの異なった 方法で有効にできる:
.sp
1番めは、\fIsmb\.conf\fR中の [global]セクション中の\fIconfig backend = registry\fRを設定することで、レジストリのみの 設定を有効にできる。これは,この時点まで読み込んだ設定ファイ ルの内容をすべてリセットし、レジストリからグローバルセク ションの内容を読む。これは、レジストリベースの設定方法を使う 時の推奨方法である。
.sp
2番目は\fIsmb\.conf\fRの[global] セクション中の、特別に新しい意味を持つ、\fIinclude = registry\fRパラメータによって有効にできる 混成設定方法である。これは,テキストファイルをインクルード するのと同じような優先度で、レジストリからグローバルオプ ションを読む。これは,初期設定がレジストリにアクセスするのに 必要な場合に特に有益である。
.sp
グローバルレジストリオプションの有効化は、レジストリ ベースの共有が有効になることで自動的に行われる。そのため、 レジストリのみの場合、共有は要求時にのみロードされる。
.RE
.sp
.RE
.PP
レジストリベースの設定に伴うシステムの破壊を限定的にするために、 レジストリでの設定中では、\fIlock directory\fRと
\fIconfig backend\fRの使用は無効化 されることに注意。 特に、レジストリでの設定中に、\fIlock directory\fRを 変更してしまい、それがいったん有効化されてしまうと、 デーモンからはそれの設定自体が見えなくなる、壊れた設定を作成することになる。
.PP
レジストリベースの設定は、キー\fIHKLM\eSoftware\eSamba\esmbconf\fRを
\fIregedit\fRや\fInet (rpc) registry\fRを使ってアクセスすることもできる。 利便性のため、\fBnet\fR(8)ユーティリティ の\fIconf\fRサブコマンドが、レジストリ ベースの設定をローカルに読み書きするための特別なインタフェース として提供されている。すなわち、データベースファイルに直接 アクセスし、サーバを迂回できる。
.SH "各パラメータの説明"


abort shutdown script (G)
.PP
.RS 4
このパラメータは、
\fBsmbd\fR(8)
が呼び出すことで、
\fIshutdown script\fR
によって実行されたシャットダウン処理を停止させるスクリプトのフルパス名である。
.sp
接続しているユーザが
\fBSeRemoteShutdownPrivilege\fR
権限を保持している場合、このコマンドはユーザ権限で呼び出される。
.sp
Default:
\fI\fIabort shutdown script\fR\fR\fI = \fR\fI""\fR\fI \fR
.sp
Example:
\fI\fIabort shutdown script\fR\fR\fI = \fR\fI/sbin/shutdown \-c\fR\fI \fR
.RE

acl check permissions (S)
.PP
.RS 4
この真偽値パラメータは、
\fBsmbd\fR(8)
が Windows クライアントから「open for delete」というプロトコル要求を受けとった際の挙動を制御する。 Windows クライアントにファイル削除のパーミッションがない場合は、オープン時に失敗することが想定される挙動である。しかし、POSIX システムでは、実際にファイルやディレクトリを削除しようとした段階で、初めて削除のパーミッション確認が行なわれる。 Windows クライアントは「delete on close」ビットを外すことで、削除のリクエストを「取り止める」ことが可能である。 このため、Samba が「open for delete」リクエストが行なわれた時点で該当のファイルを削除してみるといった方策も、 一度削除されたファイルを復活させることはできないため難しい。 このパラメータが true (デフォルト) の場合、smbd は「open for delete」リクエストの際にファイルシステムのパーミッションを直接チェックし、 ファイルシステムのパーミッション上削除できないと考えられる場合、該当のリクエストを拒否するようになる。 これは完全な方法ではなく、Samba がパーミッションを適切に確認できない場合に、ユーザがファイルを削除できてしまう可能性があるが、 大半の場合は Windows と同様の挙動となるであろう。 通常 Samba は POSIX ACL の挙動を適切に確認できるはずである。
.sp
このパラメータを「false」に設定した場合、Samba は「open for delete」リクエストの際にパーミッションの確認を行なわずにオープンを許可する。 ユーザにファイルを削除するアクセス許可がない場合は、クローズする時までわからない。 Windows 上のツールにとって、クローズ時点でこれが判明しても遅過ぎるため、ユーザにエラーメッセージが表示されるだろう。 また、削除したように見えたファイルが Windows 側のエクスプローラで再表示すると「魔法のように」復活するといった現象も発生するであろう。 これは非常に高度なプロトコルに関するパラメータであり、通常変更する必要はないはずである。 このパラメータは Samba 3\.0\.21 で現在の形となったが、現在とは若干挙動が異なる古い版は Samba 3\.0\.20 で導入された。古い版の挙動について、ここでは言及していない。
.sp
Default:
\fI\fIacl check permissions\fR\fR\fI = \fR\fITrue\fR\fI \fR
.RE

acl compatibility (S)
.PP
.RS 4
This parameter specifies what OS ACL semantics should be compatible with\. Possible values are
\fIwinnt\fR
for Windows NT 4,
\fIwin2k\fR
for Windows 2000 and above and
\fIauto\fR\. If you specify
\fIauto\fR, the value for this parameter will be based upon the version of the client\. There should be no reason to change this parameter from the default\.
.sp
Default:
\fI\fIacl compatibility\fR\fR\fI = \fR\fIAuto\fR\fI \fR
.sp
Example:
\fI\fIacl compatibility\fR\fR\fI = \fR\fIwin2k\fR\fI \fR
.RE

acl group control (S)
.PP
.RS 4
In a POSIX filesystem, only the owner of a file or directory and the superuser can modify the permissions and ACLs on a file\. If this parameter is set, then Samba overrides this restriction, and also allows the
\fIprimary group owner\fR
of a file or directory to modify the permissions and ACLs on that file\.
.sp
On a Windows server, groups may be the owner of a file or directory \- thus allowing anyone in that group to modify the permissions on it\. This allows the delegation of security controls on a point in the filesystem to the group owner of a directory and anything below it also owned by that group\. This means there are multiple people with permissions to modify ACLs on a file or directory, easing managability\.
.sp
This parameter allows Samba to also permit delegation of the control over a point in the exported directory hierarchy in much the same way as Windows\. This allows all members of a UNIX group to control the permissions on a file or directory they have group ownership on\.
.sp
This parameter is best used with the
\fIinherit owner\fR
option and also on on a share containing directories with the UNIX
\fIsetgid bit\fR
set on them, which causes new files and directories created within it to inherit the group ownership from the containing directory\.
.sp
This is parameter has been was deprecated in Samba 3\.0\.23, but re\-activated in Samba 3\.0\.31 and above, as it now only controls permission changes if the user is in the owning primary group\. It is now no longer equivalent to the
\fIdos filemode\fR
option\.
.sp
Default:
\fI\fIacl group control\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

acl map full control (S)
.PP
.RS 4
この真偽値パラメータは、
\fBsmbd\fR(8)
が POSIX の ACE エントリでは最大のアクセス権を許可した状態である「rwx(read/write/execute)」を Windows 側の ACL の「フルコントロール」に対応づけるかどうかを制御する。 このパラメータを true に設定した場合、POSIX ACE で「rwx」のエントリに対して、Windows 側の ACL としては「フルコントロール」が返却される。 このパラメータが false に設定された場合、POSIX ACE で「rwx」のエントリに対して、 Windows 側の ACL としては read/write/execute を表すビットを設定したエントリが返却される。
.sp
Default:
\fI\fIacl map full control\fR\fR\fI = \fR\fITrue\fR\fI \fR
.RE

add group script (G)
.PP
.RS 4
このパラメータは、新しいグループの作成が要求された際に、
\fBsmbd\fR(8)
によって
\fIROOT 権限で\fR
実行されるスクリプトのフルパス名である。
\fI%g\fR
はグループ名に展開される。 スクリプトは Windows NT のドメイン管理ツールを使用して設定を行なう際にのみ有効である。 このスクリプトでは、UNIX側のグループ名の制約に捕らわれず、任意の名前のグループを作成することができる。 ただし、その場合スクリプトは標準出力に作成されたグループの gid の数値を表示する必要がある。
.sp
Default:
\fI\fIadd group script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd group script\fR\fR\fI = \fR\fI/usr/sbin/groupadd %g\fR\fI \fR
.RE

add machine script (G)
.PP
.RS 4
このパラメータは、"$"を付けたマシン名が、SambaのドメインとUnix アカウントと一致しなかった場合に、
\fBsmbd\fR(8)がマシンを追加する時に実行されるスクリプトのフルパス名である。
.sp
このオプションは、\fIadd user script\fRととてもよく 似ていて、さらに、アカウント名の置換として%uを使う。%mの置換を使ってはいけない。
.sp
Default:
\fI\fIadd machine script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd machine script\fR\fR\fI = \fR\fI/usr/sbin/adduser \-n \-g machines \-c Machine \-d /var/lib/nobody \-s /bin/false %u\fR\fI \fR
.RE

add port command (G)
.PP
.RS 4
Samba 3\.0\.23 では、Windows の「Add Standard TCP/IP Port ウィザード」によるリモートからのプリンタポートの追加がサポートされた。 このオプションは、smbd がシステムに対する新しいポートの追加要求を受信した際に、 実行される外部のコマンドを定義する。 スクリプトは以下の 2 つのパラメータをとる。
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIポートの名称\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIdevice URI\fR
.sp
.RE
deviceURI は socket://<hostname>[:<portnumber>] もしくは lpd://<hostname>/<queuename> のように指定する。
.sp
Default:
\fI\fIadd port command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd port command\fR\fR\fI = \fR\fI/etc/samba/scripts/addport\.sh\fR\fI \fR
.RE

add printer command (G)
.PP
.RS 4
Samba 2\.2における Windows NT/2000 クライアントに対応した MS\-RPC ベースの印刷サポートの実装にともない、 共有の一覧に表示される"Printers\.\.\. " フォルダ中の 「プリンタの追加」ウィザード(Add Printer Wizard (APW))アイコンを利用することが可能になった。 APWにより、SambaやWindows NT/ 2000プリンタサーバに別のマシンからのプリンタ追加が可能となった。
.sp
Sambaホストの場合、これは、下位レイヤの印刷システムにプリンタを物理的に追加できる必要があるということである。
\fIadd printer command\fR
は、 印刷システムにプリンタを追加するとともに、
\fIsmb\.conf\fR
ファイルに対して、
\fBsmbd\fR(8)
によって共有が行なわれるサービスのエントリを適切に追加するのに必要な処理を行なうスクリプトを設定する。
.sp
\fIadd printer command\fR
は 以下のパラメータを(順番に)付加して自動的に実行される:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIprinter name\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIshare name\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIport name\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIdriver name\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIlocation\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIWindows 9x driver location\fR
.sp
.RE
すべてのパラメータは、一つの例外を除き、 Windows NT/2000 クライアントから送信される PRINTER_INFO_2 構造体から取得される。 「Windows 9x driver location」パラメータは、下位互換性を保つためにのみ提供される。 それ以外の構造体のフィールドは、APWの質問に対する回答から生成される。
.sp

\fIadd printer command\fR
が実行されると、
smbd
は、
\fIsmb\.conf\fR
を再度読み込んで、 APWで設定された共有がすでに存在していないかを確認する。 共有名が不正な場合、smbd
は、 クライアントに対して ACCESS_DENIED エラーを返却する。
.sp
「add printer command」は Samba が新しいプリンタが接続するポートとして設定した文字列からなる1行を返却する。 返却されない場合、Samba は印刷共有の再読み込みを行なわない。
.sp
Default:
\fI\fIadd printer command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd printer command\fR\fR\fI = \fR\fI/usr/bin/addprinter\fR\fI \fR
.RE

add share command (G)
.PP
.RS 4
Samba 2\.2\.0 では、 Windows NT 4\.0 のサーバーマネージャーを用いて動的に共有を追加したり削除したりする機能が追加された。
\fIadd share command\fR
は、 新しいサービスの設定を
\fIsmb\.conf\fR
に追加する外部のプログラム、もしくはスクリプトを設定するためのパラメータである。
\fIadd share command\fR
を実行するため、管理者は
smbd
に対して root アカウント(uid = 0)を利用して接続する必要がある。
.sp
接続したアカウントが
SeDiskOperatorPrivilege
を持っている場合、\fIchange share\fR
パラメータで定義されたスクリプトは root 権限で実行される。
.sp
コマンド実行時に、smbd
は自動的に以下の 5 つの引数を付加して
\fIadd share command\fRを実行する。
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIconfigFile\fR
\-
\fIsmb\.conf\fRファイルの場所
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIshareName\fR
\- 新しい共有名
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIpathName\fR
\- ディスク上に「存在している」ディレクトリへのパス名
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIcomment\fR
\- 新しい共有に対するコメント文字列
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fImax connections\fR
共有への最大同時接続数。
.sp
.RE
このパラメータは、ファイル共有の追加にのみ使われる。 印刷共有の追加については、
\fIaddprinter command\fR
を参照のこと。
.sp
Default:
\fI\fIadd share command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd share command\fR\fR\fI = \fR\fI/usr/local/bin/addshare\fR\fI \fR
.RE

add user script (G)
.PP
.RS 4
このパラメータは、以下に記述する特別な条件下において、
\fBsmbd\fR(8)
によって
\fIROOT 権限で\fR
実行されるスクリプトのフルパス名である。
.sp
通常、Samba サーバでは、サーバ上のファイルにアクセスするすべてのユーザに対して対応する UNIX ユーザが存在している必要がある。しかし、Windows NT のアカウントデータベースをユーザデータベースのマスタとして使うサイトでは、 Samba サーバ上のユーザの作成や保守を Windows NT の PDC と同期して行なうのは骨の折れる作業である。このオプションにより、Samba サーバに対してユーザがアクセスした時点で smbd が UNIX のユーザを
\fI必要に応じて\fR
作成することが可能になる。
.sp
このオプションを使う場合、
\fBsmbd\fR(8)
は
\fI決して\fR
\fIsecurity = share\fR
で構成されていてはならず、
\fIadd user script\fR
には、 作成される UNIX のユーザ名を表す
\fI%u\fR
を引数にとり、 UNIX ユーザを作成するスクリプトのフルパス名が設定されている必要がある。
.sp
Windows のユーザが Samba サーバにアクセスしようとして、 ログイン(SMB プロトコルの session setup) を行なう時に、
\fBsmbd\fR(8)
は、送信されたユーザ名とパスワードを認証するために、
\fIpassword server\fR
と通信を行なう。 認証が成功すると、
smbd
は UNIX 上のパスワードデータベース中から対応する UNIX のユーザを検索して Windows のユーザに対応づけようとする。この検索が失敗し、
\fIadd user script\fR
が設定されていると、
smbd
は、
\fI%u\fR
引数を作成すべきユーザ名に展開した上で、 設定されたスクリプトを
\fIROOT 権限で\fR
呼び出す。
.sp
スクリプトがユーザの作成に成功すると、
smbd
は、その UNIX ユーザがすでに存在していたかのようにして処理を継続する。このようにして、存在する Windows NT のアカウントに対応する UNIX のユーザが動的に作成される。
.sp
(訳注: この他に、Samba のドメイン環境において add user script はリモートからの要求によりユーザを作成するという重要な役割がある。)
.sp

\fIsecurity\fR,
\fIpassword server\fR,
\fIdelete user script\fR
も参照のこと。
.sp
Default:
\fI\fIadd user script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd user script\fR\fR\fI = \fR\fI/usr/local/samba/bin/add_user %u\fR\fI \fR
.RE

add user to group script (G)
.PP
.RS 4
このパラメータは、 Windows NT のドメイン管理ツールによってユーザにグループが追加された際に実行されるスクリプトのフルパス名である。 これは
\fBsmbd\fR(8)
によって
\fIROOT 権限で\fR
呼び出される。
\fI%g\fR
はグループ名に置換され、
\fI%u\fR
はユーザ名に置換される。
.sp

adduser
コマンドは、すべてのシステムにおいて、 以下の例で用いた構文をサポートしているわけではないことに注意。
.sp
Default:
\fI\fIadd user to group script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadd user to group script\fR\fR\fI = \fR\fI/usr/sbin/adduser %u %g\fR\fI \fR
.RE

administrative share (S)
.PP
.RS 4
このパラメータが共有のために
\fByes\fR
になっている場合、その共有は管理用となる。管理用の共有は Windows NT ベースのすべてのオペレーティングシステムで作られるデフォルトの ネットワーク共有であり、C$, D$, ADMIN$ などと同様のものである。 これらの共有のタイプは STYPE_DISKTREE_HIDDEN となる。
.sp
このオプションに関する詳細は、後述の
\fIsecurity\fR
を参照してほしい。
.sp
Default:
\fI\fIadministrative share\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

admin users (S)
.PP
.RS 4
This is a list of users who will be granted administrative privileges on the share\. This means that they will do all file operations as the super\-user (root)\.
.sp
You should use this option very carefully, as any user in this list will be able to do anything they like on the share, irrespective of file permissions\.
.sp
This parameter will not work with the
\fIsecurity = share\fR
in Samba 3\.0\. This is by design\.
.sp
Default:
\fI\fIadmin users\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIadmin users\fR\fR\fI = \fR\fIjason\fR\fI \fR
.RE

afs share (S)
.PP
.RS 4
このパラメータは、共有に対して AFS 特有の機能を有効にするかどうかを指定する。 もし有効な場合、\fIpath\fR
パラメータでエクスポートされているディレクトリをローカルの AFS インポートとして扱う。 特殊な AFS の機能というのは、もし configure 時に \-\-with\-fake\-kaserver オプションを有効にした場合に、 AFS トークンを作成しようとする機能などが含まれる。
.sp
Default:
\fI\fIafs share\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

afs username map (G)
.PP
.RS 4
ダミーの kaserver の AFS 機能を使用している場合、 作成するトークンのユーザ名を指定したい場合もあるだろう。 たとえば、AFS Protection Database に複数のドメインのユーザが混在している場合などが挙げられる。 一つの解決策は、winbind と同じように + をセパレータとして DOMAIN+User と指定することである。
.sp
マップされたユーザ名はログインするためのセル名を含んでいる必要がある。 そのため、このパラメータが指定されていない場合、トークンは使用されない。
.sp
(訳注: AFSに関する知識不足のため、訳の正確性については担保できない)
.sp
Default:
\fI\fIafs username map\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIafs username map\fR\fR\fI = \fR\fI%u@afs\.samba\.org\fR\fI \fR
.RE

aio read size (S)
.PP
.RS 4
If Samba has been built with asynchronous I/O support and this integer parameter is set to non\-zero value, Samba will read from file asynchronously when size of request is bigger than this value\. Note that it happens only for non\-chained and non\-chaining reads and when not using write cache\.
.sp
Current implementation of asynchronous I/O in Samba 3\.0 does support only up to 10 outstanding asynchronous requests, read and write combined\.
.sp
Related command:
\fIwrite cache size\fR
.sp
Related command:
\fIaio write size\fR
.sp
Default:
\fI\fIaio read size\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIaio read size\fR\fR\fI = \fR\fI16384 # Use asynchronous I/O for reads bigger than 16KB request size\fR\fI \fR
.RE

aio write size (S)
.PP
.RS 4
If Samba has been built with asynchronous I/O support and this integer parameter is set to non\-zero value, Samba will write to file asynchronously when size of request is bigger than this value\. Note that it happens only for non\-chained and non\-chaining reads and when not using write cache\.
.sp
Current implementation of asynchronous I/O in Samba 3\.0 does support only up to 10 outstanding asynchronous requests, read and write combined\.
.sp
Related command:
\fIwrite cache size\fR
.sp
Related command:
\fIaio read size\fR
.sp
Default:
\fI\fIaio write size\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIaio write size\fR\fR\fI = \fR\fI16384 # Use asynchronous I/O for writes bigger than 16KB request size\fR\fI \fR
.RE

algorithmic rid base (G)
.PP
.RS 4
This determines how Samba will use its algorithmic mapping from uids/gid to the RIDs needed to construct NT Security Identifiers\.
.sp
Setting this option to a larger value could be useful to sites transitioning from WinNT and Win2k, as existing user and group rids would otherwise clash with sytem users etc\.
.sp
All UIDs and GIDs must be able to be resolved into SIDs for the correct operation of ACLs on the server\. As such the algorithmic mapping can\'t be \'turned off\', but pushing it \'out of the way\' should resolve the issues\. Users and groups can then be assigned \'low\' RIDs in arbitrary\-rid supporting backends\.
.sp
Default:
\fI\fIalgorithmic rid base\fR\fR\fI = \fR\fI1000\fR\fI \fR
.sp
Example:
\fI\fIalgorithmic rid base\fR\fR\fI = \fR\fI100000\fR\fI \fR
.RE

allocation roundup size (S)
.PP
.RS 4
This parameter allows an administrator to tune the allocation size reported to Windows clients\. The default size of 1Mb generally results in improved Windows client performance\. However, rounding the allocation size may cause difficulties for some applications, e\.g\. MS Visual Studio\. If the MS Visual Studio compiler starts to crash with an internal error, set this parameter to zero for this share\.
.sp
The integer parameter specifies the roundup size in bytes\.
.sp
Default:
\fI\fIallocation roundup size\fR\fR\fI = \fR\fI1048576\fR\fI \fR
.sp
Example:
\fI\fIallocation roundup size\fR\fR\fI = \fR\fI0 # (to disable roundups)\fR\fI \fR
.RE

allow trusted domains (G)
.PP
.RS 4
This option only takes effect when the
\fIsecurity\fR
option is set to
\fBserver\fR,
\fBdomain\fR
or
\fBads\fR\. If it is set to no, then attempts to connect to a resource from a domain or workgroup other than the one which smbd is running in will fail, even if that domain is trusted by the remote server doing the authentication\.
.sp
This is useful if you only want your Samba server to serve resources to users in the domain it is a member of\. As an example, suppose that there are two domains DOMA and DOMB\. DOMB is trusted by DOMA, which contains the Samba server\. Under normal circumstances, a user with an account in DOMB can then access the resources of a UNIX account with the same account name on the Samba server even if they do not have an account in DOMA\. This can make implementing a security boundary difficult\.
.sp
Default:
\fI\fIallow trusted domains\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

announce as (G)
.PP
.RS 4
このパラメータは、
\fBnmbd\fR(8)
が、 自身を「ネットワークコンピュータ」中のブラウズリストにアナウンスする際のサーバの種類を指定する。 デフォルトでは Windows NT に設定されている。有効な値は: 「NT Server」(これは「NT」と表記することもできる)、 「NT Workstation」、「Win95」、「WfW」であり、各々 Windows NT Server、 Windows NT Workstation、Windows 95、Windows for Workgroups を意味する。 変更を行なうと、Samba サーバがブラウザサーバ(訳注: ポテンシャルブラウザの意?)に正しく参加できなくなるかも知れないため、 Samba サーバを NT サーバとして表示させたくない特別な理由がない限り、 このパラメータを変更しないこと。
.sp
Default:
\fI\fIannounce as\fR\fR\fI = \fR\fINT Server\fR\fI \fR
.sp
Example:
\fI\fIannounce as\fR\fR\fI = \fR\fIWin95\fR\fI \fR
.RE

announce version (G)
.PP
.RS 4
このパラメータは、 nmbd が自身をサーバとしてアナウンスする際に指定するメジャーおよびマイナーバージョン番号を指定する。 デフォルトは 4\.9 である。 Samba サーバをより下位のサーバとして設定する特別な必要性がない限り、このパラメータは変更しないこと。
.sp
Default:
\fI\fIannounce version\fR\fR\fI = \fR\fI4\.9\fR\fI \fR
.sp
Example:
\fI\fIannounce version\fR\fR\fI = \fR\fI2\.0\fR\fI \fR
.RE

auth methods (G)
.PP
.RS 4
This option allows the administrator to chose what authentication methods
smbd
will use when authenticating a user\. This option defaults to sensible values based on
\fIsecurity\fR\. This should be considered a developer option and used only in rare circumstances\. In the majority (if not all) of production servers, the default setting should be adequate\.
.sp
Each entry in the list attempts to authenticate the user in turn, until the user authenticates\. In practice only one method will ever actually be able to complete the authentication\.
.sp
Possible options include
\fBguest\fR
(anonymous access),
\fBsam\fR
(lookups in local list of accounts based on netbios name or domain name),
\fBwinbind\fR
(relay authentication requests for remote users through winbindd),
\fBntdomain\fR
(pre\-winbindd method of authentication for remote domain users; deprecated in favour of winbind method),
\fBtrustdomain\fR
(authenticate trusted users by contacting the remote DC directly from smbd; deprecated in favour of winbind method)\.
.sp
Default:
\fI\fIauth methods\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIauth methods\fR\fR\fI = \fR\fIguest sam winbind\fR\fI \fR
.RE

available (S)
.PP
.RS 4
このパラメータにより、サービスを「無効」とすることが可能である。
\fIavailable = no\fR
の場合、 サービスに対する接続は\fIすべて\fR失敗する。これらの失敗は記録される。
.sp
Default:
\fI\fIavailable\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

bind interfaces only (G)
.PP
.RS 4
このグローバルパラメータにより、 Samba 管理者が SMB 要求を受け付けるインタフェースを制限できるようになる。 この影響は、ファイルサービス
\fBsmbd\fR(8)
とネームサービス
\fBnmbd\fR(8)
とで多少異なる。
.sp
このパラメータを指定すると、ネームサービス
nmbd
は、
\fIinterfaces\fR
パラメータで指定されたインタフェースのポート 137 と 138 にバインドする。
nmbd
は、ブロードキャストメッセージを受信するために、 「すべてのアドレス」となるインタフェース (0\.0\.0\.0) のポート 137 と 138 にもバインドする。このオプションが設定されていない場合、
nmbd
は、これらすべてのソケットに対してネームサービスを提供する。
\fIbind interfaces only\fR
が設定されていると、
nmbd
はブロードキャストパケットの送信元アドレスを確認して、
\fIinterfaces\fR
パラメータで指定されたインタフェースのブロードキャストアドレスを経由しないパケットを破棄する。 他のソケットでユニキャストパケットを受信した場合、
nmbd
は、
\fIinterfaces\fR
パラメータで指定されたインタフェースを経由しないパケットを送出したマシンに対してはネームサービスを拒否する。 もっとも、IP ソースアドレスを偽造 (spoofing) することで、この単純なチェックは破られてしまう。 そのため、このパラメータを
nmbd
のセキュリティ機能と位置付けて本格的に利用すべきではない。
.sp
ファイルサービスの場合、このパラメータを指定すると、
\fBsmbd\fR(8)
が
\fIinterfaces\fR
パラメータで指定されたインタフェースにのみバインドするようになる。 これにより、
smbd
がサービスを提供するネットワークを指定したインタフェース経由のものに制限することが可能である。 PPP などの間欠的なネットワークインタフェースや、非ブロードキャストなネットワークインタフェースにサービスを提供している場合は、 これらの非永続的なインタフェースをうまく処理できないため、このパラメータを使わないこと。
.sp
\fIbind interfaces only\fR
が設定されているが、
\fI127\.0\.0\.1\fR
のネットワークアドレスが
\fIinterfaces\fR
パラメータに指定されていない場合は、 以下に示すような理由のため、\fBsmbpasswd\fR(8)
や
\fBswat\fR(8)
などが期待したように動作しないことがある。
.sp
ユーザの SMB パスワードを変更するために、
smbpasswd
はデフォルトで
\fIlocalhost \- 127\.0\.0\.1\fR
のアドレスに SMB クライアントとして接続を行ない、パスワード変更要求を送信する。
\fIbind interfaces only\fR
が設定されているにも関わらず、
\fI127\.0\.0\.1\fR
のネットワークアドレスが
\fIinterfaces\fR
パラメータに含まれていなかった場合、
smbpasswd
のデフォルトの状態では接続に失敗してしまう。
smbpasswd
については、
\fBsmbpasswd\fR(8)
に
\fI\-r \fR\fI\fIremote machine\fR\fR
パラメータを指定して、
\fIremote machine\fR
にローカルホストのプライマリインタフェースのIPアドレスを設定することにより、 強制的にローカルホストのプライマリIPインタフェースを利用させることも可能である。
.sp

swat
のステータス(status)ページは、
smbd
と
nmbd
が実行されているかを確認するために、
\fI127\.0\.0\.1\fR
から接続を行なおうとする。 そのため、\fI127\.0\.0\.1\fRを追加していない場合、smbd
と
nmbd
は実際には動作している場合でも、 常に「not running」と表示される。更に、swat
から
smbd
と
nmbd
の開始/停止/再起動を行なうこともできなくなる。
.sp
Default:
\fI\fIbind interfaces only\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

blocking locks (S)
.PP
.RS 4
このパラメータは、クライアントからオープン中のファイルの一部範囲に対して、 バイト範囲のロック(byte range lock)が要求された際に、タイムアウトが発生した場合の
\fBsmbd\fR(8)
の動作を制御する。
.sp
このパラメータが設定されている場合にロック範囲の要求が即座に処理できない場合、 Samba は内部的にロック要求をキューイングして、タイムアウトが来るまで定期的にロックを取得する動作を行なう。
.sp
このパラメータが
\fBno\fR
の場合、 Samba は以前のバージョンの Samba (訳注: Samba 1\.9\.x 以前)と同様に振舞い、 ロック範囲が取得できない場合にただちにロック要求を失敗させる。
.sp
Default:
\fI\fIblocking locks\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

block size (S)
.PP
.RS 4
This parameter controls the behavior of
\fBsmbd\fR(8)
when reporting disk free sizes\. By default, this reports a disk block size of 1024 bytes\.
.sp
Changing this parameter may have some effect on the efficiency of client writes, this is not yet confirmed\. This parameter was added to allow advanced administrators to change it (usually to a higher value) and test the effect it has on client write performance without re\-compiling the code\. As this is an experimental option it may be removed in a future release\.
.sp
Changing this option does not change the disk free reporting size, just the block size unit reported to the client\.
.sp
Default:
\fI\fIblock size\fR\fR\fI = \fR\fI1024\fR\fI \fR
.sp
Example:
\fI\fIblock size\fR\fR\fI = \fR\fI4096\fR\fI \fR
.RE

browsable
.PP
.RS 4
This parameter is a synonym for
browseable\.
.RE

browseable (S)
.PP
.RS 4
このパラメータは、net view コマンドやブラウズリスト中に現れる利用可能な共有の一覧にこの共有を表示させるかどうかを制御する。
.sp
Default:
\fI\fIbrowseable\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

browse list (G)
.PP
.RS 4
このパラメータは、クライアントからの
NetServerEnum
コールに対して、
\fBsmbd\fR(8)
がブラウズリストを提供するかどうかを制御する。 通常
\fBtrue\fR
に設定されている。 これを変更する必要はまずないであろう。
.sp
Default:
\fI\fIbrowse list\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

casesignames
.PP
.RS 4
This parameter is a synonym for
case sensitive\.
.RE

case sensitive (S)
.PP
.RS 4
\fIname mangling\fR
セクションでの説明を参照のこと。
.sp
Default:
\fI\fIcase sensitive\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

change notify (S)
.PP
.RS 4
このパラメータは、Samba がクライアントからのファイル変更通知要求に対して 返信するべきかどうかを指定する。
.sp
このパラメータを変更する必要はないはずである
.sp
Default:
\fI\fIchange notify\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

change share command (G)
.PP
.RS 4
Samba 2\.2\.0 では、Windows NT 4\.0 のサーバマネージャから動的な共有の追加や削除を行なう機能が実現されている。
\fIchange share command\fR
は
\fIsmb\.conf\fR
に存在しているサービスの定義を修正するための外部のプログラムやスクリプトを指定するために用いられる。
\fIchange share command\fR
を適切に実行するためには、 管理者は root アカウント(uid == 0) で
smbd
に接続しておく必要がある。(訳注: SeDiskOperatorPrivilege 権限のあるアカウントでも可能)
.sp
スクリプト実行時には
smbd
が以下の5つのパラメータを設定して自動的に
\fIchange share command\fR
を実行する。
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIconfigFile\fR
\- グローバルな
\fIsmb\.conf\fR
ファイルの位置
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIshareName\fR
\- 新しい共有名
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIpathName\fR
\- ディスク上に 「存在している」ディレクトリのパス名
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIcomment\fR
\- 新しい共有に設定するコメント文字列
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fImax connections\fR
共有への最大同時接続数。
.sp
.RE
このパラメータは、既に存在するファイル共有の設定を修正するためにのみ用いられる。 印刷共有の設定を修正する場合、Samba ホストをブラウズすると表示される「Printers\.\.\.」フォルダから行なうこと。
.sp
Default:
\fI\fIchange share command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIchange share command\fR\fR\fI = \fR\fI/usr/local/bin/addshare\fR\fI \fR
.RE

check password script (G)
.PP
.RS 4
The name of a program that can be used to check password complexity\. The password is sent to the program\'s standard input\.
.sp
The program must return 0 on a good password, or any other value if the password is bad\. In case the password is considered weak (the program does not return 0) the user will be notified and the password change will fail\.
.sp
Note: In the example directory is a sample program called
crackcheck
that uses cracklib to check the password quality\.
.sp
Default:
\fI\fIcheck password script\fR\fR\fI = \fR\fIDisabled\fR\fI \fR
.sp
Example:
\fI\fIcheck password script\fR\fR\fI = \fR\fIcheck password script = /usr/local/sbin/crackcheck\fR\fI \fR
.RE

client lanman auth (G)
.PP
.RS 4
This parameter determines whether or not
\fBsmbclient\fR(8)
and other samba client tools will attempt to authenticate itself to servers using the weaker LANMAN password hash\. If disabled, only server which support NT password hashes (e\.g\. Windows NT/2000, Samba, etc\.\.\. but not Windows 95/98) will be able to be connected from the Samba client\.
.sp
The LANMAN encrypted response is easily broken, due to it\'s case\-insensitive nature, and the choice of algorithm\. Clients without Windows 95/98 servers are advised to disable this option\.
.sp
Disabling this option will also disable the
client plaintext auth
option
.sp
Likewise, if the
client ntlmv2 auth
parameter is enabled, then only NTLMv2 logins will be attempted\.
.sp
Default:
\fI\fIclient lanman auth\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

client ldap sasl wrapping (G)
.PP
.RS 4
The
\fIclient ldap sasl wrapping\fR
defines whether ldap traffic will be signed or signed and encrypted (sealed)\. Possible values are
\fIplain\fR,
\fIsign\fR
and
\fIseal\fR\.
.sp
The values
\fIsign\fR
and
\fIseal\fR
are only available if Samba has been compiled against a modern OpenLDAP version (2\.3\.x or higher)\.
.sp
This option is needed in the case of Domain Controllers enforcing the usage of signed LDAP connections (e\.g\. Windows 2000 SP3 or higher)\. LDAP sign and seal can be controlled with the registry key "HKLM\eSystem\eCurrentControlSet\eServices\e
NTDS\eParameters\eLDAPServerIntegrity" on the Windows server side\.
.sp
Depending on the used KRB5 library (MIT and older Heimdal versions) it is possible that the message "integrity only" is not supported\. In this case,
\fIsign\fR
is just an alias for
\fIseal\fR\.
.sp
The default value is
\fIplain\fR
which is not irritable to KRB5 clock skew errors\. That implies synchronizing the time with the KDC in the case of using
\fIsign\fR
or
\fIseal\fR\.
.sp
Default:
\fI\fIclient ldap sasl wrapping\fR\fR\fI = \fR\fIplain\fR\fI \fR
.RE

client ntlmv2 auth (G)
.PP
.RS 4
This parameter determines whether or not
\fBsmbclient\fR(8)
will attempt to authenticate itself to servers using the NTLMv2 encrypted password response\.
.sp
If enabled, only an NTLMv2 and LMv2 response (both much more secure than earlier versions) will be sent\. Many servers (including NT4 < SP4, Win9x and Samba 2\.2) are not compatible with NTLMv2\.
.sp
Similarly, if enabled, NTLMv1,
client lanman auth
and
client plaintext auth
authentication will be disabled\. This also disables share\-level authentication\.
.sp
If disabled, an NTLM response (and possibly a LANMAN response) will be sent by the client, depending on the value of
client lanman auth\.
.sp
Note that some sites (particularly those following \'best practice\' security polices) only allow NTLMv2 responses, and not the weaker LM or NTLM\.
.sp
Default:
\fI\fIclient ntlmv2 auth\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

client plaintext auth (G)
.PP
.RS 4
Specifies whether a client should send a plaintext password if the server does not support encrypted passwords\.
.sp
Default:
\fI\fIclient plaintext auth\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

client schannel (G)
.PP
.RS 4
This controls whether the client offers or even demands the use of the netlogon schannel\.
\fIclient schannel = no\fR
does not offer the schannel,
\fIclient schannel = auto\fR
offers the schannel but does not enforce it, and
\fIclient schannel = yes\fR
denies access if the server is not able to speak netlogon schannel\.
.sp
Default:
\fI\fIclient schannel\fR\fR\fI = \fR\fIauto\fR\fI \fR
.sp
Example:
\fI\fIclient schannel\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

client signing (G)
.PP
.RS 4
This controls whether the client offers or requires the server it talks to to use SMB signing\. Possible values are
\fIauto\fR,
\fImandatory\fR
and
\fIdisabled\fR\.
.sp
When set to auto, SMB signing is offered, but not enforced\. When set to mandatory, SMB signing is required and if set to disabled, SMB signing is not offered either\.
.sp
Default:
\fI\fIclient signing\fR\fR\fI = \fR\fIauto\fR\fI \fR
.RE

client use spnego (G)
.PP
.RS 4
この値により、Samba クライアントが認証の際に Simple and Protected NEGOciation (RFC2478 で規定) をサポートしたサーバ (Windows XP 、 Windows 2000 、Samba 3\.0 を含む) に対して SPNEGO の使用を試みるかどうかが制御される。 SPNEGO は Kerberos 認証の際に有効となる。
.sp
Default:
\fI\fIclient use spnego\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

cluster addresses (G)
.PP
.RS 4
このパラメータを使うと、nmbd が WINS サーバに登録する追加のアドレスを 付加することができる。これらのアドレス(群)は、すべてのノード上で 同時に存在しなければならないわけではないが、これらは WINS サーバに 登録されるため、クライアントはこれらのうちのどのノードにも接続できる。
.sp
Default:
\fI\fIcluster addresses\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIcluster addresses\fR\fR\fI = \fR\fI10\.0\.0\.1 10\.0\.0\.2 10\.0\.0\.3\fR\fI \fR
.RE

clustering (G)
.PP
.RS 4
このパラメータは、Samba が ctdb に接続して tdb ファイルにアクセスし、 さらにメッセージ処理のバックエンドとして ctdb を使うべきかどうかを 指定する。
.sp
ctdb が動作している状態でクラスタ構成を取る場合にのみ、 このパラメータを
yes
にすること。
.sp
Default:
\fI\fIclustering\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

comment (S)
.PP
.RS 4
これは、クライアントから「ネットワークコンピュータ」や
net view
コマンド経由でサーバ上で利用可能な共有を一覧する際に、共有名の横に表示される文字列である。
.sp
コンピュータ名の横に表示される文字列を設定したい場合は、\fIserver string\fR
パラメータを参照のこと。
.sp
Default:
\fI\fIcomment\fR\fR\fI = \fR\fI # コメント文字列なし\fR\fI \fR
.sp
Example:
\fI\fIcomment\fR\fR\fI = \fR\fIFred\'s Files\fR\fI \fR
.RE

config backend (G)
.PP
.RS 4
設定内容を格納するためのバックエンドを切り替える。設定可能な値は
\fIfile\fR（デフォルト）および\fIregistry\fR
である。\fIsmb\.conf\fR
を読み込んでいる途中で
\fIconfig backend = registry\fR
を検出すると、それまでに読み込まれた設定内容は破棄され、その代りに グローバルオプションがレジストリから読み込まれる。つまり、これは レジストリのみの設定にするための仕組みである。共有の定義は即時には 読み込まれないが、その代りに
\fIregistry shares\fR
を
\fIyes\fR
にセットしてくれる。
.sp
注意：このオプションは、レジストリ設定自身の中でセットすることもできる。
.sp
Default:
\fI\fIconfig backend\fR\fR\fI = \fR\fIfile\fR\fI \fR
.sp
Example:
\fI\fIconfig backend\fR\fR\fI = \fR\fIregistry\fR\fI \fR
.RE

config file (G)
.PP
.RS 4
このオプションを指定することで、デフォルトの設定ファイル (通常\fIsmb\.conf\fR)の代わりのファイルを利用して、 設定を上書きすることが可能になる。このオプション自身が config file 中に記述されるため、これには「鶏と卵」問題がある。
.sp
そのため、このパラメータによって設定ファイルが変更されると、 新しい設定ファイルの内容が先頭からロードされる。
.sp
このオプションには、通常の変数置換が適用されるので、 うまく使えばとても便利であろう。
.sp
指定された設定ファイルが存在しない場合は読み込まれない (これにより、特定クライアントに対して、 特別な設定ファイルを指定するということが可能となる)。
.sp
\fINo default\fR
.sp
Example:
\fI\fIconfig file\fR\fR\fI = \fR\fI/usr/local/samba/lib/smb\.conf\.%m\fR\fI \fR
.RE

copy (S)
.PP
.RS 4
このパラメータにより、サービスエントリの「複製」 が可能となる。指定されたサービスの設定が単純に現在のサービスへと複製される。 現在のセクションに設定されているパラメータは、 複製元のセクションの設定を上書きする。
.sp
この機能を使うと、「ひな型(template)」となるサービスを作成した上で、 同様の設定のサービスを単純に作成するということが可能となる。 複製元のサービスは、 設定ファイル内で複製先のサービスより前に記述する必要があることに注意。
.sp
Default:
\fI\fIcopy\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIcopy\fR\fR\fI = \fR\fIotherservice\fR\fI \fR
.RE

create mode
.PP
.RS 4
This parameter is a synonym for
create mask\.
.RE

create mask (S)
.PP
.RS 4
When a file is created, the necessary permissions are calculated according to the mapping from DOS modes to UNIX permissions, and the resulting UNIX mode is then bit\-wise \'AND\'ed with this parameter\. This parameter may be thought of as a bit\-wise MASK for the UNIX modes of a file\. Any bit
\fInot\fR
set here will be removed from the modes set on a file when it is created\.
.sp
The default value of this parameter removes the
group
and
other
write and execute bits from the UNIX modes\.
.sp
Following this Samba will bit\-wise \'OR\' the UNIX mode created from this parameter with the value of the
\fIforce create mode\fR
parameter which is set to 000 by default\.
.sp
This parameter does not affect directory masks\. See the parameter
\fIdirectory mask\fR
for details\.
.sp
Note that this parameter does not apply to permissions set by Windows NT/2000 ACL editors\. If the administrator wishes to enforce a mask on access control lists also, they need to set the
\fIsecurity mask\fR\.
.sp
Default:
\fI\fIcreate mask\fR\fR\fI = \fR\fI0744\fR\fI \fR
.sp
Example:
\fI\fIcreate mask\fR\fR\fI = \fR\fI0775\fR\fI \fR
.RE

csc policy (S)
.PP
.RS 4
このパラメータは、\fIクライアントサイドのキャッシングポリシー\fRを規定し、 オフラインキャッシュ機能を持つクライアントが、 共有上のファイルをどのようにキャッシュするかを規定する。 有効な値は、manual, documents, programs, disable である。
.sp
これらの値は、Windows のサーバ側の設定に対応している。
.sp
例えば、移動プロファイルが格納されている共有では、
\fIcsc policy = disable\fR
とすることで、 オフラインキャッシュを無効にできる。
.sp
Default:
\fI\fIcsc policy\fR\fR\fI = \fR\fImanual\fR\fI \fR
.sp
Example:
\fI\fIcsc policy\fR\fR\fI = \fR\fIprograms\fR\fI \fR
.RE

ctdbd socket (G)
.PP
.RS 4

clustering=yes
の指定を行う場合は、 ctdbd がどの unix ドメインソケットを監視するのかを、Samba に対して 教えてやる必要がある。ctdb 1\.0 におけるデフォルトのパスは /tmp/ctdb\.socket であるが、これを smb\.conf で明示してやらなければならない。
.sp
Default:
\fI\fIctdbd socket\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIctdbd socket\fR\fR\fI = \fR\fI/tmp/ctdb\.socket\fR\fI \fR
.RE

cups options (S)
.PP
.RS 4
このパラメータは
\fIprinting\fR
が
\fBcups\fR
に設定されている場合のみ有効である。 この値は、 CUPS ライブラリに直接渡されるオプションを記述した任意の形式の文字列である。
.sp
CUPS で有効な一般の印刷オプション ( CUPS の「Spftware Users\' Manual」に記載されているもの ) はすべて設定できる。 また、設定対象のキューで有効な ( 「lpoptions \-d printername \-l」で表示される ) 任意のプリンタ固有のオプションも設定できる。
.sp
Windows クライアントが Samba を経由して印刷を行なう際に CUPS サーバの
\fIerror_log\fR
ファイルに 「Unsupported format \'application/octet\-stream\'」といったメッセージが含まれている場合、 このパラメータを
\fBraw\fR
に設定するとよい。 現在では
\fI/etc/cups/mime\.{convs,types}\fR
において、 システム全体で raw 印刷を有効にする必要はない。
.sp
Default:
\fI\fIcups options\fR\fR\fI = \fR\fI""\fR\fI \fR
.sp
Example:
\fI\fIcups options\fR\fR\fI = \fR\fI"raw,media=a4,job\-sheets=secret,secret"\fR\fI \fR
.RE

cups server (G)
.PP
.RS 4
このパラメータは
\fIprinting\fR
が
\fBcups\fR
に設定されている場合のみ有効である。
.sp
このパラメータが設定されると、CUPS の
\fIclient\.conf\fR
で設定された ServerName オプションの値が置き換えられる。 これは、仮想 Samba サーバ毎に異なる CUPS デーモンに接続する際に必要である。
.sp
なお、サーバ名に引続きコロンの後ろにポート番号を記述することで、ポー ト番号を指定することも可能である。 ポートの指定が行なわれ名張った場合、IPP のデフォルトポート (631) が用いられる。
.sp
Default:
\fI\fIcups server\fR\fR\fI = \fR\fI""\fR\fI \fR
.sp
Example:
\fI\fIcups server\fR\fR\fI = \fR\fImycupsserver\fR\fI \fR
.sp
Example:
\fI\fIcups server\fR\fR\fI = \fR\fImycupsserver:1631\fR\fI \fR
.RE

deadtime (G)
.PP
.RS 4
The value of the parameter (a decimal integer) represents the number of minutes of inactivity before a connection is considered dead, and it is disconnected\. The deadtime only takes effect if the number of open files is zero\.
.sp
This is useful to stop a server\'s resources being exhausted by a large number of inactive connections\.
.sp
Most clients have an auto\-reconnect feature when a connection is broken so in most cases this parameter should be transparent to users\.
.sp
Using this parameter with a timeout of a few minutes is recommended for most systems\.
.sp
A deadtime of zero indicates that no auto\-disconnection should be performed\.
.sp
Default:
\fI\fIdeadtime\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIdeadtime\fR\fR\fI = \fR\fI15\fR\fI \fR
.RE

debug class (G)
.PP
.RS 4
With this boolean parameter enabled, the debug class (DBGC_CLASS) will be displayed in the debug header\.
.sp
For more information about currently available debug classes, see section about
\fIlog level\fR\.
.sp
Default:
\fI\fIdebug class\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

debug hires timestamp (G)
.PP
.RS 4
ログメッセージに秒単位以上のタイムスタンプが必要な場合、 この真偽値のパラメータを有効にすることにより、 マイクロ秒単位のタイムスタンプがメッセージに付加される。
.sp
このパラメータを有効にする際は、
\fIdebug timestamp\fR
が有効になっている必要があることに注意。
.sp
Default:
\fI\fIdebug hires timestamp\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

debug pid (G)
.PP
.RS 4
fork されて生成された
\fBsmbd\fR(8)
プロセスが同一のログファイルを共用している場合、 どのプロセスがメッセージを出力しているかを識別することは非常に難しい。 この真偽値パラメータを有効にすることで、ログファイル中のタイムスタンプメッセージのヘッダにプロセスIDが付加されるようになる。
.sp
このパラメータを有効にする際は、
\fIdebug timestamp\fR
が有効になっている必要があることに注意。
.sp
Default:
\fI\fIdebug pid\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

debug prefix timestamp (G)
.PP
.RS 4
With this option enabled, the timestamp message header is prefixed to the debug message without the filename and function information that is included with the
\fIdebug timestamp\fR
parameter\. This gives timestamps to the messages without adding an additional line\.
.sp
Note that this parameter overrides the
\fIdebug timestamp\fR
parameter\.
.sp
Default:
\fI\fIdebug prefix timestamp\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

timestamp logs
.PP
.RS 4
This parameter is a synonym for
debug timestamp\.
.RE

debug timestamp (G)
.PP
.RS 4
Samba のデバッグログのメッセージには、 デフォルトでタイムスタンプが付加されるが、 高い、\fIdebug level\fR
を設定している場合、 このタイムスタンプが目障りに感じることもあるだろう。 この真偽値パラメータにより、タイムスタンプの付加を抑止することができる。
.sp
Default:
\fI\fIdebug timestamp\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

debug uid (G)
.PP
.RS 4
Samba は root 権限で動作する時もあれば、 接続したユーザの権限で動作する時もある。 このパラメータを有効にすると、現在の euid、egid、uid、gid をログファイル中のタイムスタンプメッセージに付加する。
.sp
このパラメータを有効にする際は、
\fIdebug timestamp\fR
が有効になっている必要があることに注意。
.sp
Default:
\fI\fIdebug uid\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

default case (S)
.PP
.RS 4
\fIname mangling\fR
セクションを参照のこと。
\fIshort preserve case\fR
パラメータにも注意。
.sp
Default:
\fI\fIdefault case\fR\fR\fI = \fR\fIlower\fR\fI \fR
.RE

default devmode (S)
.PP
.RS 4
このパラメータは、\fIprintable\fR
サービスにのみ適用される。 smbd が、Windows NT/2000/XP クライアントに対してプリンタドライバを提供する際に、 Samba サーバ上の各プリンタでは、用紙サイズ、 orientation, duplex, settings といった情報が定義されたデバイスモード(device mode)という値を設定する必要がある。 デバイスモードの適切な値は、プリンタドライバ自身のみが生成することができる (この処理は、Win32 プラットフォームでのみ実行することができる)。 smbd はデバイスモードを生成するドライバのコードを実行できないため、 このフィールドのデフォルト値としては、NULL が設定される。
.sp
Windows NT/2000/XP クライアントに対してプリンタドライバを提供する上での問題点の多くは、 デバイスモードの生成に関するものである。 ドライバによっては、デバイスモードとして NULL を設定すると、 クライアント側の Explorer\.exe をクラッシュさせるものがある。 また、デバイスモードがドライバ自身によって生成されていないと（たとえば smbd がデフォルトのデバイスモードを生成するなど）、 クライアントのスプーラサービス(spoolsv\.exe)を停止させてしまうものもある。
.sp
このパラメータは、熟慮の上、プリンタドライバのテストを行なった上で用いること。 デバイスモードを NULL のままにしておき、Windows クライアントに適切な値を設定される方が好ましい。 ただし、ドライバが常にこの処理を行なうとは限らないため、
default devmode = yes
の設定を行なうことで、smbd にデフォルトのデバイスモードを生成するような指示を行なうことができるようになっている。
.sp
Windows NT/2000 の印刷システムやデバイスモードに関する詳細な情報については、
MSDN documentation
を参照のこと。
.sp
Default:
\fI\fIdefault devmode\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

default
.PP
.RS 4
This parameter is a synonym for
default service\.
.RE

default service (G)
.PP
.RS 4
このパラメータは、 要求されたサービスが存在しなかった場合に接続されるサービス名を指定する。 パラメータの値に、大括弧(\'[\' と \']\')は\fI不要である\fRことに注意(設定例を参照のこと)。
.sp
このパラメータにデフォルト値はない。 このパラメータが設定されていない場合、 存在しない共有に対する接続は失敗する。
.sp
default service は
\fIguest ok\fR
と
\fIread\-only\fR
パラメータを有効にしたサービスにするのが一般的である。
.sp
外面的なサービス名はクライアントから要求されたサービス名に変換される。 これは、\fI%S\fR
のようなマクロをワイルドカードサービスに適用する際に、非常に有用である。
.sp
default service のサービス名に現れる「_」文字は、「/」にマッピングされる。 これにより、いろいろと面白いことができるだろう。
.sp
Default:
\fI\fIdefault service\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIdefault service\fR\fR\fI = \fR\fIpub\fR\fI \fR
.RE

defer sharing violations (G)
.PP
.RS 4
Windows ではファイルのオープン時に他のプロセスとの共有方法を指定することができる。 あるプロセスがファイルを開こうとした時に指定した共有方法が 別のプロセスによって指定された共有方法と共存できないようなものであった際に 共有違反が発生する。 このパラメータにより、smbd は Windows サーバのように動作するようになり、 「共有違反」のエラーメッセージを 1 秒待ってから返却するようになり、 クライアントはこの間に共有違反を起こしたファイルをクローズすることが可能となる。
.sp
UNIX のデフォルトでは、こうした挙動は行なわれない。
.sp
このパラメータは Samba の挙動をより Windows に近づけるためのものであり、 無効にする必然性はないであろう。
.sp
Default:
\fI\fIdefer sharing violations\fR\fR\fI = \fR\fITrue\fR\fI \fR
.RE

delete group script (G)
.PP
.RS 4
このパラメータは、グループの削除が要求された際に、
\fBsmbd\fR(8)
によって
\fIROOT 権限で\fR
実行されるスクリプトのフルパス名である。
\fI%g\fR
はグループ名に置換される。 スクリプトは Windows NT のドメイン管理ツールを使用して設定を行なう際にのみ有効である。
.sp
Default:
\fI\fIdelete group script\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

deleteprinter command (G)
.PP
.RS 4
Samba 2\.2における Windows NT/2000 クライアントに対応した MS\-RPC ベースの印刷サポートの実装にともない、 DeletePrinter() RPC呼び出しを発行することにより、 実行中にプリンタを削除することが可能になった。
.sp
Samba ホスト上では、 実際の印刷システム上から物理的にプリンタが削除される。
\fIdeleteprinter command\fR
パラメータには、 プリンタを印刷システムと\fIsmb\.conf\fRから削除するために 必要な操作を実行するためのスクリプトを設定する。
.sp
\fIdeleteprinter command\fR
は
\fI「プリンタ名」\fRのみをパラメータに設定されて自動的に呼び出される。
.sp
\fIdeleteprinter command\fR
が実行されると、
smbd
は削除対象のプリンタを無効にするために、
\fIsmb\.conf\fR
を読み直す。 共有名が依然として有効な場合、smbd
はクライアントに ACCESS_DENIED エラーを返却する。
.sp
Default:
\fI\fIdeleteprinter command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIdeleteprinter command\fR\fR\fI = \fR\fI/usr/bin/removeprinter\fR\fI \fR
.RE

delete readonly (S)
.PP
.RS 4
このパラメータにより、読み取り専用のファイルの削除が可能になる。 これは DOS の仕様ではないが、UNIX では可能な処理である。
.sp
このオプションは、rcs のようなアプリケーションを動作させるのに有用で、 UNIX ファイルの所有者に関する仕様がファイルのパーミッション変更を妨げたり、 DOS の仕様が読み取り専用ファイルの削除を妨げたりする問題を回避する。
.sp
Default:
\fI\fIdelete readonly\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

delete share command (G)
.PP
.RS 4
Samba 2\.2\.0 では、Windows NT 4\.0 のサーバマネージャから動的な共有の追加や削除を行なう機能が実現されている。
\fIdelete share command\fR
は
\fIsmb\.conf\fR
に存在しているサービスの定義を削除するための外部のプログラムやスクリプトを指定するために用いられる。
\fIdelete share command\fR
を適切に実行するためには、 管理者は root アカウント(uid == 0) で
smbd
に接続しておく必要がある。
.sp
接続中のアカウントが
SeDiskOperatorPrivilege
権限を持っている場合、\fIchange share\fR
パラメータで定義されたスクリプトは root 権限で実行される。
.sp
スクリプト実行時には
smbd
が以下の2つのパラメータを設定して自動的に
\fIdelete share command\fR
を実行する。
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIconfigFile\fR
\- グローバルな
\fIsmb\.conf\fR
ファイルの位置
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIshareName\fR
\- 既存のサービス名
.sp
.RE
このパラメータはファイル共有を削除する際にのみ利用される。 印刷共有の削除については、
\fIdeleteprinter command\fR
を参照のこと。
.sp
Default:
\fI\fIdelete share command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIdelete share command\fR\fR\fI = \fR\fI/usr/local/bin/delshare\fR\fI \fR
.RE

delete user from group script (G)
.PP
.RS 4
このパラメータは、 Windows NT のドメイン管理ツールによってユーザがグループから削除された際に実行されるスクリプトのフルパス名である。 これは
\fBsmbd\fR(8)
によって
\fIROOT 権限で\fR
呼び出される。
\fI%g\fR
はグループ名に置換され、
\fI%u\fR
はユーザ名に置換される。
.sp
Default:
\fI\fIdelete user from group script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIdelete user from group script\fR\fR\fI = \fR\fI/usr/sbin/deluser %u %g\fR\fI \fR
.RE

delete user script (G)
.PP
.RS 4
このパラメータは、リモート RPC (NT) ツールによってユーザの管理が行なわれた際に、
\fBsmbd\fR(8)
によって実行されるスクリプトのフルパス名である。
.sp
このスクリプトは、「ドメインユーザマネージャ」や
rpcclient
により、リモートのクライアントがサーバからユーザを削除した際に呼び出される。
.sp
このスクリプトは指定されたユーザ名の UNIX ユーザを削除するものでなければならない。
.sp
Default:
\fI\fIdelete user script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIdelete user script\fR\fR\fI = \fR\fI/usr/local/samba/bin/del_user %u\fR\fI \fR
.RE

delete veto files (S)
.PP
.RS 4
このオプションは、アクセスが禁止(veto)されたディレクトリ (\fIveto files\fR
オプションを参照のこと)を含むディレクトリを削除しようとする際に影響する。 このオプションが
\fBno\fR
(デフォルト) の場合、 アクセスが禁止されたディレクトリ内にアクセスを禁止されていないファイルやディレクトリが含まれていても、 ディレクトリ内の削除は失敗する。これは通常期待されている動作であろう。
.sp
このオプションを
\fByes\fR
に設定すると、 Samba はアクセスが禁止されたディレクトリ内でも 再帰的にすべてのファイルやディレクトリを削除しようとする。 NetAtalk のようなファイルサーバを併用する際は、 通常 DOS/Windows ユーザからの参照するのを禁止しているディレクトリ内にメタファイル (たとえば
\fI\.AppleDouble\fRなど)を作成するため、このオプションが有用である。
.sp

\fIdelete veto files = yes\fR
を指定することで、 これらのディレクトリは、親ディレクトリが削除された際に、自動的に削除される (ただし、ユーザはディレクトリを削除するパーミッションを持っている必要がある)。
.sp
Default:
\fI\fIdelete veto files\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

dfree cache time (S)
.PP
.RS 4
\fIdfree cache time\fR
パラメータは、 Samba のディスク空き容量の計算で問題が発生するシステムでのみ利用すること。 Ultrix では問題の発生することが知られているが、 他のオペレーティングシステムで発生するかも知れない。 この問題は、各々のディレクトリの一覧表示の終了時に 「終了 再試行 無視 (Abort Retry Ignore)」のエラーが発生する形で顕在化する。
.sp
このパラメータは Samba 3\.0\.21 で新設されたものである。 これは、smbd がディスク空き容量の結果をキャッシュする時間を秒単位で指定する。0 (デフォルト値) の場合、キャッシュは行なわれない。 これにより、高負荷のサーバで
\fIdfree command\fR
のスクリプトが頻繁に呼ばれて負荷が増大することが避けられる。
.sp
このパラメータのデフォルト値は 0 であり、キャッシュは行なわれない。
.sp
\fINo default\fR
.sp
Example:
\fI\fIdfree cache time\fR\fR\fI = \fR\fIdfree cache time = 60\fR\fI \fR
.RE

dfree command (S)
.PP
.RS 4
\fIdfree command\fR
パラメータは、 Samba のディスク空き容量の計算で問題が発生するシステムでのみ利用すること。 Ultrix では問題の発生することが知られているが、 他のオペレーティングシステムで発生するかも知れない。 この問題は、各々のディレクトリの一覧表示の終了時に 「終了 再試行 無視 (Abort Retry Ignore)」のエラーが発生する形で顕在化する。
.sp
このパラメータでは、 総ディスク容量と空き容量を計算する内部ルーチンを置き換える外部スクリプトを指定する。 以下に、この機能を果たすスクリプトの仕様を示す。
.sp
Samba 3\.0\.21 において、このパラメータは共有単位に設定可能なパラメータとなり、 新たに追加された
\fIdfree cache time\fR
パラメータにより、 高負荷のシステムにおいて、このスクリプトの出力結果をキャッシュできるようになった。
.sp
外部スクリプトは、対象となるファイルシステム中のディレクトリを示すパラメータ 1 つを受け取る。 これは通常
\fI\./\fRという文字列からなる。 スクリプトはアスキー文字で 2 つの整数を返さなければならない。 1 つめはブロック単位のディスク総容量で、 2 つめは利用できるブロック数でなければならない。 3 番目の戻り値として、オプションでブロックサイズをバイト単位で返却させることもできる。 デフォルトのブロックサイズは 1024 バイトである。
.sp
注意: スクリプトは、setuid や setgid しては
\fIならず\fR、 (root のみ書き込み可能で)所有者は root である必要がある。
.sp
dfree スクリプト(実行可能にする必要がある)を以下に示す:
.sp
.RS 4
.nf
 
#!/bin/sh
df $1 | tail \-1 | awk \'{print $(NF\-4),$(NF\-2)}\'
.fi
.RE
.sp
.sp
もしくは、以下のようなものも考えられる(Sys V ベースのシステムの場合):
.sp
.RS 4
.nf
 
#!/bin/sh
/usr/bin/df \-k $1 | tail \-1 | awk \'{print $3" "$5}\'
.fi
.RE
.sp
.sp
システムによっては、コマンド名をフルパスで記述する必要がある場合があるので注意。
.sp
デフォルトは内部ルーチンにより、ディスクの総容量と空き容量が計算される。
.sp
\fINo default\fR
.sp
Example:
\fI\fIdfree command\fR\fR\fI = \fR\fI/usr/local/samba/bin/dfree\fR\fI \fR
.RE

directory mode
.PP
.RS 4
This parameter is a synonym for
directory mask\.
.RE

directory mask (S)
.PP
.RS 4
This parameter is the octal modes which are used when converting DOS modes to UNIX modes when creating UNIX directories\.
.sp
When a directory is created, the necessary permissions are calculated according to the mapping from DOS modes to UNIX permissions, and the resulting UNIX mode is then bit\-wise \'AND\'ed with this parameter\. This parameter may be thought of as a bit\-wise MASK for the UNIX modes of a directory\. Any bit
\fInot\fR
set here will be removed from the modes set on a directory when it is created\.
.sp
The default value of this parameter removes the \'group\' and \'other\' write bits from the UNIX mode, allowing only the user who owns the directory to modify it\.
.sp
Following this Samba will bit\-wise \'OR\' the UNIX mode created from this parameter with the value of the
\fIforce directory mode\fR
parameter\. This parameter is set to 000 by default (i\.e\. no extra mode bits are added)\.
.sp
Note that this parameter does not apply to permissions set by Windows NT/2000 ACL editors\. If the administrator wishes to enforce a mask on access control lists also, they need to set the
\fIdirectory security mask\fR\.
.sp
Default:
\fI\fIdirectory mask\fR\fR\fI = \fR\fI0755\fR\fI \fR
.sp
Example:
\fI\fIdirectory mask\fR\fR\fI = \fR\fI0775\fR\fI \fR
.RE

directory security mask (S)
.PP
.RS 4
This parameter controls what UNIX permission bits will be set when a Windows NT client is manipulating the UNIX permission on a directory using the native NT security dialog box\.
.sp
This parameter is applied as a mask (AND\'ed with) to the incoming permission bits, thus resetting any bits not in this mask\. Make sure not to mix up this parameter with
\fIforce directory security mode\fR, which works similar like this one but uses logical OR instead of AND\. Essentially, zero bits in this mask are a set of bits that will always be set to zero\.
.sp
Essentially, all bits set to zero in this mask will result in setting to zero the corresponding bits on the file permissions regardless of the previous status of this bits on the file\.
.sp
If not set explicitly this parameter is set to 0777 meaning a user is allowed to set all the user/group/world permissions on a directory\.
.sp
\fINote\fR
that users who can access the Samba server through other means can easily bypass this restriction, so it is primarily useful for standalone "appliance" systems\. Administrators of most normal systems will probably want to leave it as the default of
\fB0777\fR\.
.sp
Default:
\fI\fIdirectory security mask\fR\fR\fI = \fR\fI0777\fR\fI \fR
.sp
Example:
\fI\fIdirectory security mask\fR\fR\fI = \fR\fI0700\fR\fI \fR
.RE

disable netbios (G)
.PP
.RS 4
このパラメータを有効にすると、 Samba の NetBIOS サポート機能が無効になる。 Windows 2000 および Windows XP を除くすべてのバージョンの Windows では、NetBIOS のみを使用できる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
NetBIOS サポートを無効にすると、 NetBIOS のみをサポートするクライアントからは Samba サーバにアクセスできなくなることに注意。

Default:
\fI\fIdisable netbios\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

disable spoolss (G)
.PP
.RS 4
このパラメータを有効にすることで、 Samba の SPOOLSS MS\-RPC サポートを無効にし、Samba 2\.0\.x と同様の動作をさせることが可能となる。 Windows NT/2000 クライアントは、Lanman 形式の印刷コマンドを利用することも可能である。 Windows 9x/Me は、このパラメータに影響されない。 なお、このパラメータを有効にすると、NT のプリンタプロパティを利用した、 Windows NTのプリンタ追加ウィザードによる Sambaマシンへのプリンタドライバのアップロード機能が無効になる。 また、Windows NT/2000 クライアントが、必要に応じて Samba マシンからプリンタドライバをダウンロードする機能も同時に無効になる。
\fIこのパラメータを有効にする際は、充分注意すること。\fR
.sp
Default:
\fI\fIdisable spoolss\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

display charset (G)
.PP
.RS 4
Samba がメッセージを標準出力や標準エラー出力に出力する際に 用いる文字コードセットを指定する。 既定値は "LOCALE"であり、これは、ロケールに従い、自動的に設定される ことを意味する。 この値は、通常、
\fIunix charset\fR
と同じに 設定すべきである。
.sp
Default:
\fI\fIdisplay charset\fR\fR\fI = \fR\fI"LOCALE" or "ASCII" (システムに依存)\fR\fI \fR
.sp
Example:
\fI\fIdisplay charset\fR\fR\fI = \fR\fIUTF8\fR\fI \fR
.RE

dmapi support (S)
.PP
.RS 4
このパラメータにより、Samba がオフラインのファイルの判定に DMAPI を用いるかどうかが制御される。 これは、通常ファイルを自動的にテープに移動していくような階層型ストレージとの連携の際に用いられる。
.sp
Samba はファイルの状態を DMAPI アプリケーションが登録したイベントを確認することで推測することに注意。 この方法は、多くの階層型ストレージシステムで機能するが、一部機能しないシステムもあるかも知れない。この場合、 Samba はファイルがオフラインであるという誤った報告を行なうことになる。
.sp
このパラメータは、コンパイル時に DMAPI の実装サポートを確認できた場合にのみ有効となる。 また、実行時にシステムで DMAPI が使用可能であることが確認できた場合にのみ使用される。
.sp
Default:
\fI\fIdmapi support\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

dns proxy (G)
.PP
.RS 4
WINS サーバとして機能している
\fBnmbd\fR(8)
が WINS サーバとして機能している場合、ある NetBIOS 名が登録されていなかった時に、その NetBIOS 名を DNS 名として扱い、名前の問い合わせを行ったクライアントに代わってその名前を DNS サーバに対して問い合わせるように設定する。
.sp
NetBIOS 名の最大長は 15 文字であるため、 問い合わせる DNS 名(もしくはDNSの別名)も、最大15文字に制限される。
.sp
nmbd
が DNS への名前解決を行う際には、問い合わせにより他の処理が停止させないために、自分自身を複製したプロセスを生成する。
.sp
Default:
\fI\fIdns proxy\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

domain logons (G)
.PP
.RS 4
このパラメータが
\fByes\fR
に設定されると、 Samba サーバは、自身が所属する
\fIworkgroup\fR
に所属する Windows 95/98 に対するドメインログオン機能を提供するようになる。 さらに、Samba サーバは、 Windows NT 4\.0 形式のドメインコントローラとしても機能するようになる。 この機能の設定に関する詳細な記述は、 Samba\-PDC\-HOWTO の「Domain Control」章を参照のこと。
.sp
Default:
\fI\fIdomain logons\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

domain master (G)
.PP
.RS 4
このオプションにより、
\fBsmbd\fR(8)
が WAN 環境におけるブラウズリストの統合を行なうことが可能になる。 このオプションを設定すると、nmbd
は、指定された
\fIworkgroup\fR
のドメインマスタブラウザであることを表す、ドメイン固有の特別な NetBIOS 名(訳注:NetBIOS 名で末尾が 0x1b のユニーク名を指す) を登録する。 各サブネット上にある、同じ名前の
\fIworkgroup\fR
に属するローカルマスタブラウザは、この
nmbdに対して、 ローカルに収集したブラウズリストを提供するとともに、
\fBsmbd\fR(8)
に対してネットワーク全体のブラウズリストの完全な複製の提供を要求するようになる。 ブラウザのクライアントは、ローカルマスタブラウザと通信することで、 個々のサブネットのブラウズリストではなく、 そのドメイン全体のブラウズリストを取得できるようになる。
.sp
Windows NT のプライマリドメインコントローラは、
\fIworkgroup\fR
のドメインマスタブラウザとして機能するために、
\fIworkgroup\fR
固有の特別な NetBIOS 名を登録することが前提とされていることに注意 (Windows NT PDC のこの動作を抑止することはできない)。 つまり、このパラメータが Yes に設定され、nmbd
が Windows NT PDC より前に、\fIworkgroup\fR
のための特別な NetBIOS 名を登録してしまうと、 サブネット越しのブラウズは正常に動作せず、失敗する。
.sp
\fIdomain logons = yes\fR
の場合、\fIdomain master\fR
パラメータはデフォルトで有効となる。
\fIdomain logons\fR
が有効でない場合(デフォルト)、
\fIdomain master\fR
パラメータもデフォルトでは有効にならない。
.sp

\fIdomain logons = Yes\fR
の場合、このパラメータもデフォルトで Yes となり、Samba は PDC として動作するようになる。
\fIdomain master = No\fR
の場合、Samba は BDC として動作するようになる。通常、このパラメータを「No」に設定する必要があるのは、BDC として機能させる場合のみである。
.sp
Default:
\fI\fIdomain master\fR\fR\fI = \fR\fIauto\fR\fI \fR
.RE

dont descend (S)
.PP
.RS 4
システムに存在するディレクトリには、 クライアントに参照させたくないものや、 無限に深い(再帰的)なものが存在する(たとえば Linux での
\fI/proc\fR)。 このパラメータは常に空のように見せかけるサーバ側のディレクトリをコンマで区切って指定する。
.sp
Samba が要求する「dont descend」の書式は一定ではない。 たとえば
\fI/proc\fR
ではなく
\fI\./proc\fR
でなければならないかもしれない。 実験してみるのが最良の方法である。 :\-)
.sp
Default:
\fI\fIdont descend\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIdont descend\fR\fR\fI = \fR\fI/proc,/dev\fR\fI \fR
.RE

dos charset (G)
.PP
.RS 4
DOS SMB クライアントは、サーバ側でも自身と同じ文字コードセットを使用していると想定する。 このオプションにより、 Samba が DOS クライアントと通信する際に用いられる文字コードセットを指定する。
.sp
デフォルトは Samba にインストールされた文字コードセットによって異なる。 Samba は、文字コードセット 850 の使用を試みるが、使用できない場合は ASCII を使用する。
\fBtestparm\fR(1)
コマンドを実行することで、システム上のデフォルト値を確認することが可能である。
.sp
\fINo default\fR
.RE

dos filemode (S)
.PP
.RS 4
Samba のデフォルトの動作では、 ファイルやディレクトリの所有者のみがアクセス権を変更できるという、UNIX的な仕様になっている。 しかし、この仕様が DOS/Windows のユーザを混乱させてしまうことも多い。 このパラメータを有効にすることによって、 (何らかの手段によって)ファイルに書き込み権のあるユーザは、パーミッション(ACLを含む)の変更もできるようになる。 ファイルの所有グループに所属しているユーザは、 グループに対して読み込み権限しか与えられていない場合は パーミッションの変更を行なうことができないことに注意。 ファイルやディレクトリの所有者を変更することも可能である。
.sp
Default:
\fI\fIdos filemode\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

dos filetime resolution (S)
.PP
.RS 4
DOS や Windows の FAT ファイルシステム下では、 時刻の最小単位は 2 秒である。共有に対してこのパラメータを設定すると、
\fBsmbd\fR(8)
に対して 1 秒精度の要求が 行なわれた際に、 返却される時間をもっとも近い 2 秒の境界値に丸める。
.sp
このオプションはおもに、Samba の共有で Visual C++ を 使用するための互換性オプションとして利用する。 共有で oplock が有効であると、 Visual C++ はファイルが最後の読み込みから変更されていないかを検査するときに、 扱う日付の最小単位が異なる 2 つの時刻取得の呼び出し (call) を利用する。 そのうちのひとつの呼び出しは 1秒単位であり、もうひとつは 2 秒単位になっている。 2 秒単位で扱う呼び出しが奇数秒を切り捨てるため、 ファイルが奇数秒の日付であると 2 つの日付が一致せず、 Visual C++ はファイルが変更されたと報告し続けてしまう。 このオプションを\fByes\fRに設定することで 2 つの日付は一致し、Visual C++ も幸福になれる。
.sp
Default:
\fI\fIdos filetime resolution\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

dos filetimes (S)
.PP
.RS 4
DOS や Windows では、 ファイルに書き込み権のあるユーザが、ファイルのタイムスタンプを変更することが可能である。 POSIX の仕様では、ファイルの所有者か root のみがタイムスタンプを変更できる。 Samba のデフォルトは、POSIX 仕様に準拠しており、
smbd
の実効ユーザがファイルの所有者でないとき、タイムスタンプの変更を禁止する。 このオプションを
\fByes\fR
にセットすると、 DOS の仕様に準じて動作するようになるため、
\fBsmbd\fR(8)
は DOS の要求に従ってタイムスタンプを変更できるようになる。 Microsoft Office 2000 以降で行なわれた変更に対応するため、 Samba 3\.0\.14 以降ではデフォルト値が「no」から「yes」に変更された。 このパラメータが「yes」になっていない場合、ファイルが複数のユーザ間で共用されていると、 Microsoft Excel はファイルが他のユーザによって変更されたという警告のダイアログボックスを表示してしまう。
.sp
Default:
\fI\fIdos filetimes\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

ea support (S)
.PP
.RS 4
この真偽値パラメータにより、
\fBsmbd\fR(8)
は、クライアントが共有内に OS/2 形式の拡張属性を格納することを可能とする。 このパラメータを有効にするためには、下位のファイルシステムが (Linux の場合 XFS や EXT3 に対するパッチとして提供されているような) 拡張属性をサポートしていることが必要である。 Linux の場合、拡張属性を有効にするには、カーネルが拡張属性を有効にしてコンパイルされていることに加え、 ファイルシステムのマウントオプションとして user_xattr を指定してマウントする必要がある。
.sp
Default:
\fI\fIea support\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

enable asu support (G)
.PP
.RS 4
「Advanced Server for Unix (ASU)」というプロダクトを実行しているホストでは、 IPC コネクションのみをサポートするビルトインの [ADMIN$] 共有が作成されるなど、 ASU 特有の動作が幾つか存在する。長年、これは smbd のデフォルトの動作でもあった。 ところが、Print Migrator tool というマイクロソフトのアプリケーションでは、 リモートのサーバで [ADMIN$] というファイル共有がサポートされている必要がある。 このパラメータを無効にすることで、smb\.conf に [ADMIN$] というファイル共有を作成することが可能になる。
.sp
Default:
\fI\fIenable asu support\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

enable privileges (G)
.PP
.RS 4
このパラメータは、smbd が
net rpc rights
もしくは Windows 側のユーザ、グループ管理ツールにより、特定の SID に対して指定のユーザー権利を付与する機能を制御する。 このパラメータはデフォルトで有効となっているが、Domain Admins グループのメンバがユーザーやグループにユーザー権利を割り当てることで、 root 権限で実行される smbd の処理が該当ユーザとして接続した状態で実行されることを防止するために無効にすることも可能である。
.sp
ユーザー権利を使用することで、例えば smbd が動作するサーバの root 権限を与えずに、 Samba ドメインに参加する権利を付与することが可能である。
.sp
より詳細な説明については、Samba HOWTO 中の記載を参照のこと。
.sp
Default:
\fI\fIenable privileges\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

encrypt passwords (G)
.PP
.RS 4
This boolean controls whether encrypted passwords will be negotiated with the client\. Note that Windows NT 4\.0 SP3 and above and also Windows 98 will by default expect encrypted passwords unless a registry entry is changed\. To use encrypted passwords in Samba see the chapter "User Database" in the Samba HOWTO Collection\.
.sp
MS Windows clients that expect Microsoft encrypted passwords and that do not have plain text password support enabled will be able to connect only to a Samba server that has encrypted password support enabled and for which the user accounts have a valid encrypted password\. Refer to the smbpasswd command man page for information regarding the creation of encrypted passwords for user accounts\.
.sp
The use of plain text passwords is NOT advised as support for this feature is no longer maintained in Microsoft Windows products\. If you want to use plain text passwords you must set this parameter to no\.
.sp
In order for encrypted passwords to work correctly
\fBsmbd\fR(8)
must either have access to a local
\fBsmbpasswd\fR(5)
file (see the
\fBsmbpasswd\fR(8)
program for information on how to set up and maintain this file), or set the
\fIsecurity = [server|domain|ads]\fR
parameter which causes
smbd
to authenticate against another server\.
.sp
Default:
\fI\fIencrypt passwords\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

enhanced browsing (G)
.PP
.RS 4
このオプションにより、 Samba に実装されている複数サブネット間でのブラウザのアナウンスメントに関する拡張が有効になる。 ただし、この拡張は、Microsoft の実装の標準とは異なる。
.sp
ブラウザのアナウンスメントに関する一つ目の拡張点は、 Samba のWINSサーバに登録されているすべてのドメインマスタブラウザを問い合わせる定期的なワイルドカードクエリと、 返答に含まれる各DMBと行なわれるブラウズリストの同期処理のサポートである。 二つ目の拡張点は、DMBとして識別されているマシンとの間で 定常的に行なわれるランダムなブラウズリストの同期処理のサポートである。 (訳注: これは 120151 などで記載されている、WINS クライアントとなっている Windows NT 3\.5 以上の DMB が定期的に WINS サーバに接続し、WINSサーバが保有する「ドメイン名<1B>」のリストを自身のブラウズリストに追加していく処理のサポートだと思われる)
.sp
中身が空のワークグループがブラウズリストから消えないというトラブルが発生した場合は、 このオプションを無効にしたい場合もあるだろう。 ブラウザのプロトコルの仕様上、 この拡張により空のワークグループが永久に残ってしまうという悩ましい問題が起こることがある。
.sp
通常は、サブネット越えのブラウザのアナウンスメントの信頼性向上のため、 このオプションは、有効のままにしておくべきである。
.sp
Default:
\fI\fIenhanced browsing\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

enumports command (G)
.PP
.RS 4
ここでいう「ポート(port)」の概念は、 UNIXのものと大きく異なる。Windows NT/2000のプリントサーバにおいて、 ポートはポートモニタと関連付けられ、通常ローカルポート(LPT1:、COM1:、 FILE:)やリモートポート(LPD Port Monitorなど)といった名称をもつ。 Sambaのデフォルトでは、
\fB「Samba Printer Port」\fR
というポートのみが定義されている。 Windows NT/2000においては、すべてのプリンタに適切なポート名がある。 デフォルトの\fB「Samba Printer Port」 \fR以外のポート名をポートの一覧に表示させたい場合 (smbdはポート名を全く使用していない)、 標準出力に対してポート名のリストを1行に一つずつ生成するようなプログラムを
\fIenumports command\fRで定義することができる。 この一覧はレベル1および2のEnumPorts() RPCのレスポンス中で利用される。
.sp
Default:
\fI\fIenumports command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIenumports command\fR\fR\fI = \fR\fI/usr/bin/listports\fR\fI \fR
.RE

eventlog list (G)
.PP
.RS 4
このパラメータは、 Samba がマイクロソフトの「イベントビューア」ユーティリティ経由での表示を可能とするログファイル名の一覧を定義する。 一覧に含まれるログに対しては、ディスク上の
\fI$(lockdir)/eventlog\fR
内に、 対応する TDB ファイルが割り当てられる。
.sp
管理者は、外部のプロセスを用いて
\fI/var/log/messages\fR
のような一般の UNIX ログファイルを解析し、 イベントログの TDB ファイルにエントリを書き込む必要がある。 イベントログのエントリを書き込む方法については、eventlogadm(8) ユーティリティを参照のこと。
.sp
Default:
\fI\fIeventlog list\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIeventlog list\fR\fR\fI = \fR\fISecurity Application Syslog Apache\fR\fI \fR
.RE

fake directory create times (S)
.PP
.RS 4
NTFS や Windows VFAT ファイルシステムでは、 すべてのファイルとディレクトリの作成時刻を保持している。 これは UNIX が保持している ctime (状態変更時刻)とは異なるため、 Samba の既定動作では UNIX が保持している中で最も古い時刻を報告する。 共有でこのパラメータを
\fByes\fR
にした場合、Samba はディレクトリの作成時刻として、 常に 1980/1/1 の午前 0 時を報告する。
.sp
このオプションは、Samba 共有上で Visual C++ を使うときに互換性を保つためのオプションとして用いられることが多い。 Visual C++ は、各オブジェクトファイルに対する依存性チェック用途のオブジェクトディレクトリと、 そのディレクトリを作成するルールを持った makefile を生成する。 NMAKE が日付を比較する際にディレクトリをチェックするときには、ファイル作成時刻を使用する。 これにより、オブジェクトディレクトリが存在しない場合は作成され、作成されたディレクトリは、 ディレクトリ中に存在するオブジェクトファイルよりも古い時刻を保持することになる。
.sp
しかし、UNIX の時刻の扱いに関する仕様のため、 Samba が報告するディレクトリの作成時間はディレクトリにファイルが作成または削除されたときにも更新されてしまう。 その結果 NMAKE は、オブジェクトディレクトリで最後にビルドされたファイルを除く すべてのオブジェクトファイルがオブジェクトディレクトリより古いと判断し、それらを再構築してしまう。 このオプションを有効にすることで、 常にディレクトリは含まれるファイルよりも前の日付になり、 NMAKE によるビルドが意図したように行なわれることが保証される。
.sp
Default:
\fI\fIfake directory create times\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

fake oplocks (S)
.PP
.RS 4
oplock は、SMB クライアントがファイル操作の結果をローカルにキャッシュするための許可をサーバから取得するための機能である。 サーバが oplock (opportunistic lock = 便宜的ロック) を許可すると、 クライアントは自分だけがそのファイルにアクセスしていると認識して、 積極的にファイルの内容をキャッシュする。oplock のタイプによっては、 クライアントがファイルのオープン/クローズの操作をキャッシュすることもありうる。 これにより、多大な性能向上が期待できる。
.sp

fake oplocks = yes
の設定を行なうと、\fBsmbd\fR(8)
は、 実際にそのファイルを利用しているクライアント数に関わらず、 常に oplock を許可する。
.sp
一般的には、このパラメータを利用するよりも、 実際の
\fIoplocks\fR
を利用する方がよい。
.sp
CDROM 等の物理的に読みとり専用のメディアの場合など、 読みとり専用か、同時に 1 台のクライアントからだけしか アクセスされないとわかっている共有でこのオプションを有効にすると、 多くの操作で大きな性能改善が見られるだろう。複数のクライアントから 同時にファイルの読み書きアクセスする可能性がある共有でこのオプションを有効にすると、 ファイルの内容が破壊される場合が起こりうる。 このオプションは慎重に使用して欲しい!
.sp
Default:
\fI\fIfake oplocks\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

fam change notify (G)
.PP
.RS 4
このパラメータにより、Samba がディレクトリ内の変更を FAM デーモンに問い合わせ、SMB クライアントがサーバ上のデータに変更があった際に、 更新を行なうことが可能になるようにするかが制御される。
.sp
このパラメータは、FAM デーモンによるユーザプログラムへの変更通知機能がサポートされている場合のみ使用される。 FAM デーモンが実行されていない場合、このパラメータは自動的に無効となる。
\fIkernel change notify\fR
パラメータが有効な場合、そちらが優先される。
.sp
Default:
\fI\fIfam change notify\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

follow symlinks (S)
.PP
.RS 4
このパラメータにより、Samba の管理者は、
\fBsmbd\fR(8)
がシンボリックリンクを追跡する処理を共有単位で禁止することが可能になる。 このパラメータを
\fBno\fR
に設定した場合、 シンボリックリンクのファイルやディレクトリの追跡する処理が抑制される(ユーザにはエラーが返却される)。 このオプションは、ユーザが自分のホーム・ディレクトリに
\fI/etc/passwd\fR
へのシンボリックリンクを追加するのを防止したりする効果がある。 ただし、わずかながらファイル名の検索が遅くなるだろう。
.sp
このオプションはデフォルトで有効になっている (つまり、smbd
はシンボリックリンクを追跡する)。
.sp
Default:
\fI\fIfollow symlinks\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

force create mode (S)
.PP
.RS 4
This parameter specifies a set of UNIX mode bit permissions that will
\fIalways\fR
be set on a file created by Samba\. This is done by bitwise \'OR\'ing these bits onto the mode bits of a file that is being created\. The default for this parameter is (in octal) 000\. The modes in this parameter are bitwise \'OR\'ed onto the file mode after the mask set in the
\fIcreate mask\fR
parameter is applied\.
.sp
The example below would force all newly created files to have read and execute permissions set for \'group\' and \'other\' as well as the read/write/execute bits set for the \'user\'\.
.sp
Default:
\fI\fIforce create mode\fR\fR\fI = \fR\fI000\fR\fI \fR
.sp
Example:
\fI\fIforce create mode\fR\fR\fI = \fR\fI0755\fR\fI \fR
.RE

force directory mode (S)
.PP
.RS 4
This parameter specifies a set of UNIX mode bit permissions that will
\fIalways\fR
be set on a directory created by Samba\. This is done by bitwise \'OR\'ing these bits onto the mode bits of a directory that is being created\. The default for this parameter is (in octal) 0000 which will not add any extra permission bits to a created directory\. This operation is done after the mode mask in the parameter
\fIdirectory mask\fR
is applied\.
.sp
The example below would force all created directories to have read and execute permissions set for \'group\' and \'other\' as well as the read/write/execute bits set for the \'user\'\.
.sp
Default:
\fI\fIforce directory mode\fR\fR\fI = \fR\fI000\fR\fI \fR
.sp
Example:
\fI\fIforce directory mode\fR\fR\fI = \fR\fI0755\fR\fI \fR
.RE

force directory security mode (S)
.PP
.RS 4
This parameter controls what UNIX permission bits can be modified when a Windows NT client is manipulating the UNIX permission on a directory using the native NT security dialog box\.
.sp
This parameter is applied as a mask (OR\'ed with) to the changed permission bits, thus forcing any bits in this mask that the user may have modified to be on\. Make sure not to mix up this parameter with
\fIdirectory security mask\fR, which works in a similar manner to this one, but uses a logical AND instead of an OR\.
.sp
Essentially, this mask may be treated as a set of bits that, when modifying security on a directory, to will enable (1) any flags that are off (0) but which the mask has set to on (1)\.
.sp
If not set explicitly this parameter is 0000, which allows a user to modify all the user/group/world permissions on a directory without restrictions\.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
Users who can access the Samba server through other means can easily bypass this restriction, so it is primarily useful for standalone "appliance" systems\. Administrators of most normal systems will probably want to leave it set as 0000\.

Default:
\fI\fIforce directory security mode\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIforce directory security mode\fR\fR\fI = \fR\fI700\fR\fI \fR
.RE

group
.PP
.RS 4
This parameter is a synonym for
force group\.
.RE

force group (S)
.PP
.RS 4
This specifies a UNIX group name that will be assigned as the default primary group for all users connecting to this service\. This is useful for sharing files by ensuring that all access to files on service will use the named group for their permissions checking\. Thus, by assigning permissions for this group to the files and directories within this service the Samba administrator can restrict or allow sharing of these files\.
.sp
In Samba 2\.0\.5 and above this parameter has extended functionality in the following way\. If the group name listed here has a \'+\' character prepended to it then the current user accessing the share only has the primary group default assigned to this group if they are already assigned as a member of that group\. This allows an administrator to decide that only users who are already in a particular group will create files with group ownership set to that group\. This gives a finer granularity of ownership assignment\. For example, the setting
\fIforce group = +sys\fR
means that only users who are already in group sys will have their default primary group assigned to sys when accessing this Samba share\. All other users will retain their ordinary primary group\.
.sp
If the
\fIforce user\fR
parameter is also set the group specified in
\fIforce group\fR
will override the primary group set in
\fIforce user\fR\.
.sp
Default:
\fI\fIforce group\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIforce group\fR\fR\fI = \fR\fIagroup\fR\fI \fR
.RE

force printername (S)
.PP
.RS 4
Windows NT （以降）の OS から印刷を行なう場合、
\fIsmb\.conf\fR
中の各プリンタには、 クライアントから使用可能な名前が 2 つある。 最初のものは smb\.conf で定義された共有名(短い名前)である。 Windows 9x クライアントからは、このプリンタ名しか使用できない。 プリンタに割り当てられたもう一つの名前は、Samba サーバの「プリンタ」 (プリンタとFAX)フォルダ」を参照すると表示されるものである。 これは、(\fIprinter name\fR
オプションと混同しないように) 単にプリンタ名と記載する。
.sp
Samba を含む Windows 互換のリモートのプリンタサーバ上で、 プリンタに対して新しいドライバが割り当てられた際、 Windows クライアントは、そのドライバの名前に合致するように、プリンタ名を変更する。 これは、複数のプリンタに同じドライバを割り当てているユーザを混乱させる結果となる。 Samba において、プリンタのプリンタ名を smb\.conf で定義された共有名と異なる名称にすることを禁止したい場合は、
\fIforce printername = yes\fR
と設定すること。
.sp
Windows では、プリンタ名と共有名を強制的に一致させることができないため、 このパラメータを有効にすると、Windows サーバから Samba サーバへプリンタの移行を行なう際に問題が発生するので注意。
.sp
プリンタがクライアントにより使用を開始された後にこのパラメータの値を変更することは、 ユーザが自身の「プリンタ」フォルダからプリンタを削除することができなくなるため、推奨しない。
.sp
Default:
\fI\fIforce printername\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

force security mode (S)
.PP
.RS 4
This parameter controls what UNIX permission bits can be modified when a Windows NT client is manipulating the UNIX permission on a file using the native NT security dialog box\.
.sp
This parameter is applied as a mask (OR\'ed with) to the changed permission bits, thus forcing any bits in this mask that the user may have modified to be on\. Make sure not to mix up this parameter with
\fIsecurity mask\fR, which works similar like this one but uses logical AND instead of OR\.
.sp
Essentially, one bits in this mask may be treated as a set of bits that, when modifying security on a file, the user has always set to be on\.
.sp
If not set explicitly this parameter is set to 0, and allows a user to modify all the user/group/world permissions on a file, with no restrictions\.
.sp
\fI Note\fR
that users who can access the Samba server through other means can easily bypass this restriction, so it is primarily useful for standalone "appliance" systems\. Administrators of most normal systems will probably want to leave this set to 0000\.
.sp
Default:
\fI\fIforce security mode\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIforce security mode\fR\fR\fI = \fR\fI700\fR\fI \fR
.RE

force unknown acl user (S)
.PP
.RS 4
If this parameter is set, a Windows NT ACL that contains an unknown SID (security descriptor, or representation of a user or group id) as the owner or group owner of the file will be silently mapped into the current UNIX uid or gid of the currently connected user\.
.sp
This is designed to allow Windows NT clients to copy files and folders containing ACLs that were created locally on the client machine and contain users local to that machine only (no domain users) to be copied to a Samba server (usually with XCOPY /O) and have the unknown userid and groupid of the file owner map to the current connected user\. This can only be fixed correctly when winbindd allows arbitrary mapping from any Windows NT SID to a UNIX uid or gid\.
.sp
Try using this parameter when XCOPY /O gives an ACCESS_DENIED error\.
.sp
Default:
\fI\fIforce unknown acl user\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

force user (S)
.PP
.RS 4
This specifies a UNIX user name that will be assigned as the default user for all users connecting to this service\. This is useful for sharing files\. You should also use it carefully as using it incorrectly can cause security problems\.
.sp
This user name only gets used once a connection is established\. Thus clients still need to connect as a valid user and supply a valid password\. Once connected, all file operations will be performed as the "forced user", no matter what username the client connected as\. This can be very useful\.
.sp
In Samba 2\.0\.5 and above this parameter also causes the primary group of the forced user to be used as the primary group for all file activity\. Prior to 2\.0\.5 the primary group was left as the primary group of the connecting user (this was a bug)\.
.sp
Default:
\fI\fIforce user\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIforce user\fR\fR\fI = \fR\fIauser\fR\fI \fR
.RE

fstype (S)
.PP
.RS 4
このパラメータは、 クライアントが共有のファイルシステムを問い合わせた際に、
\fBsmbd\fR(8)
が返却する共有のファイルシステム名を指定する。 デフォルトは Windows NT 互換の
\fBNTFS\fR
だが、 必要に応じて
\fBSamba\fR
や
\fB FAT \fR
といった別の文字列に、変更することができる。
.sp
Default:
\fI\fIfstype\fR\fR\fI = \fR\fINTFS\fR\fI \fR
.sp
Example:
\fI\fIfstype\fR\fR\fI = \fR\fISamba\fR\fI \fR
.RE

get quota command (G)
.PP
.RS 4
The
get quota command
should only be used whenever there is no operating system API available from the OS that samba can use\.
.sp
This option is only available you have compiled Samba with the
\-\-with\-sys\-quotas
option or on Linux with
\-\-with\-quotas
and a working quota api was found in the system\.
.sp
This parameter should specify the path to a script that queries the quota information for the specified user/group for the partition that the specified directory is on\.
.sp
Such a script should take 3 arguments:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
directory
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
type of query
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
uid of user or gid of group
.sp
.RE
The type of query can be one of :
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
1 \- user quotas
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
2 \- user default quotas (uid = \-1)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
3 \- group quotas
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
4 \- group default quotas (gid = \-1)
.sp
.RE
This script should print one line as output with spaces between the arguments\. The arguments are:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 1 \- quota flags (0 = no quotas, 1 = quotas enabled, 2 = quotas enabled and enforced)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 2 \- number of currently used blocks
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 3 \- the softlimit number of blocks
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 4 \- the hardlimit number of blocks
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 5 \- currently used number of inodes
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 6 \- the softlimit number of inodes
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 7 \- the hardlimit number of inodes
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Arg 8(optional) \- the number of bytes in a block(default is 1024)
.sp
.RE
Default:
\fI\fIget quota command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIget quota command\fR\fR\fI = \fR\fI/usr/local/sbin/query_quota\fR\fI \fR
.RE

getwd cache (G)
.PP
.RS 4
This is a tuning option\. When this is enabled a caching algorithm will be used to reduce the time taken for getwd() calls\. This can have a significant impact on performance, especially when the
\fIwide smbconfoptions\fR
parameter is set to
\fBno\fR\.
.sp
Default:
\fI\fIgetwd cache\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

guest account (G)
.PP
.RS 4
This is a username which will be used for access to services which are specified as
\fIguest ok\fR
(see below)\. Whatever privileges this user has will be available to any client connecting to the guest service\. This user must exist in the password file, but does not require a valid login\. The user account "ftp" is often a good choice for this parameter\.
.sp
On some systems the default guest account "nobody" may not be able to print\. Use another account in this case\. You should test this by trying to log in as your guest user (perhaps by using the
su \-
command) and trying to print using the system print command such as
lpr(1)
or
lp(1)\.
.sp
This parameter does not accept % macros, because many parts of the system require this value to be constant for correct operation\.
.sp
Default:
\fI\fIguest account\fR\fR\fI = \fR\fInobody # default can be changed at compile\-time\fR\fI \fR
.sp
Example:
\fI\fIguest account\fR\fR\fI = \fR\fIftp\fR\fI \fR
.RE

public
.PP
.RS 4
This parameter is a synonym for
guest ok\.
.RE

guest ok (S)
.PP
.RS 4
If this parameter is
\fByes\fR
for a service, then no password is required to connect to the service\. Privileges will be those of the
\fIguest account\fR\.
.sp
This paramater nullifies the benifits of setting
\fIrestrict anonymous = 2\fR
.sp
See the section below on
\fIsecurity\fR
for more information about this option\.
.sp
Default:
\fI\fIguest ok\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

only guest
.PP
.RS 4
This parameter is a synonym for
guest only\.
.RE

guest only (S)
.PP
.RS 4
If this parameter is
\fByes\fR
for a service, then only guest connections to the service are permitted\. This parameter will have no effect if
\fIguest ok\fR
is not set for the service\.
.sp
See the section below on
\fIsecurity\fR
for more information about this option\.
.sp
Default:
\fI\fIguest only\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

hide dot files (S)
.PP
.RS 4
この真偽値パラメータにより、 ドットで始まるファイル名のファイルを隠しファイルとして扱うかどうかが制御される。
.sp
Default:
\fI\fIhide dot files\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

hide files (S)
.PP
.RS 4
これは、見せたくないがアクセスは許可したいファイルやディレクトリのリストを指定する。 DOSの「隠し」属性が該当するファイルやディレクトリに付加される。
.sp
リストの各エントリは、 スペースをエントリ中に含められるようにするため、「/」で区切る必要がある。 「*」と「?」は、DOSのワイルドカードと同様にして、 複数のファイルやディレクトリを指定するために利用することができる。
.sp
各エントリはUNIXのパス形式で指定すること。DOSのパス形式で指定したり、 UNIXでディレクトリを意味する「/」を含んだりはできない。
.sp
この設定には、 case sensitive オプションの設定が影響することに注意。
.sp
このパラメータを設定すると、 全てのファイルやディレクトリに対して該当するかどうかの確認を行う必要が発生するため、 Samba のパフォーマンスに影響がでる。
.sp
以下の設定例は、Thursby
から入手可能な Macintosh 上の SMB クライアント (DAVE) が内部的な用途に作成するファイルの指定に加え、 ドットで始まるファイルを隠しファイルとして指定したものである。
.sp
このパラメータの設定例を以下に示す。
.sp
.RS 4
.nf
hide files = /\.*/DesktopFolderDB/TrashFor%m/resource\.frk/
.fi
.RE
.sp
.sp
Default:
\fI\fIhide files\fR\fR\fI = \fR\fI # どのファイルも隠されない\fR\fI \fR
.RE

hide special files (S)
.PP
.RS 4
このパラメータにより、クライアントからソケット、デバイス、FIFOなどのファイルがディレクトリ一覧で表示されることを抑止できる。
.sp
Default:
\fI\fIhide special files\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

hide unreadable (S)
.PP
.RS 4
このパラメータにより、読みとりができないファイルの存在をクライアントから隠蔽できる。 このパラメータのデフォルトは off になっている。
.sp
Default:
\fI\fIhide unreadable\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

hide unwriteable files (S)
.PP
.RS 4
このパラメータにより、書き込みができないファイルの存在をクライアントから隠蔽できる。 このパラメータのデフォルトは off になっている。 書き込みができないディレクトリについては通常通り表示されることに注意。
.sp
Default:
\fI\fIhide unwriteable files\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

homedir map (G)
.PP
.RS 4
このパラメータは、
\fInis homedir\fR
が
\fByes\fR
で
\fBsmbd\fR(8)
が Windows 95/98 の
\fIlogon server\fR
として機能している場合に、 ユーザのホームディレクトリがあるサーバがどこかの情報をもつ NIS (YP)のマップを指定する。 現在のところ、Sun の auto\.home マップ形式のみが認識される。 マップの形式は以下のとおり:
.sp
.RS 4
.nf
username server:/some/file/system
.fi
.RE
.sp
プログラムは、最初の「:」の前までをサーバ名として解釈する。 これ以外のマップの形式や、Amd (別の automounter)のマップにも対応した優れた解析ロジックもおそらく存在するはずである。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
このオプションを利用する場合は、 システムがNISクライアントとして稼働している必要がある。

Default:
\fI\fIhomedir map\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIhomedir map\fR\fR\fI = \fR\fIamd\.homedir\fR\fI \fR
.RE

host msdfs (G)
.PP
.RS 4
If set to
\fByes\fR, Samba will act as a Dfs server, and allow Dfs\-aware clients to browse Dfs trees hosted on the server\.
.sp
See also the
\fImsdfs root\fR
share level parameter\. For more information on setting up a Dfs tree on Samba, refer to the MSFDS chapter in the book Samba3\-HOWTO\.
.sp
Default:
\fI\fIhost msdfs\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

hostname lookups (G)
.PP
.RS 4
Specifies whether samba should use (expensive) hostname lookups or use the ip addresses instead\. An example place where hostname lookups are currently used is when checking the
hosts deny
and
hosts allow\.
.sp
Default:
\fI\fIhostname lookups\fR\fR\fI = \fR\fIno\fR\fI \fR
.sp
Example:
\fI\fIhostname lookups\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

allow hosts
.PP
.RS 4
This parameter is a synonym for
hosts allow\.
.RE

hosts allow (S)
.PP
.RS 4
A synonym for this parameter is
\fIallow hosts\fR\.
.sp
This parameter is a comma, space, or tab delimited set of hosts which are permitted to access a service\.
.sp
If specified in the [global] section then it will apply to all services, regardless of whether the individual service has a different setting\.
.sp
You can specify the hosts by name or IP number\. For example, you could restrict access to only the hosts on a Class C subnet with something like
allow hosts = 150\.203\.5\.\. The full syntax of the list is described in the man page
\fIhosts_access(5)\fR\. Note that this man page may not be present on your system, so a brief description will be given here also\.
.sp
Note that the localhost address 127\.0\.0\.1 will always be allowed access unless specifically denied by a
\fIhosts deny\fR
option\.
.sp
You can also specify hosts by network/netmask pairs and by netgroup names if your system supports netgroups\. The
\fIEXCEPT\fR
keyword can also be used to limit a wildcard list\. The following examples may provide some help:
.sp
Example 1: allow all IPs in 150\.203\.*\.*; except one
.sp
hosts allow = 150\.203\. EXCEPT 150\.203\.6\.66
.sp
Example 2: allow hosts that match the given network/netmask
.sp
hosts allow = 150\.203\.15\.0/255\.255\.255\.0
.sp
Example 3: allow a couple of hosts
.sp
hosts allow = lapland, arvidsjaur
.sp
Example 4: allow only hosts in NIS netgroup "foonet", but deny access from one particular host
.sp
hosts allow = @foonet
.sp
hosts deny = pirate
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
Note that access still requires suitable user\-level passwords\.

See
\fBtestparm\fR(1)
for a way of testing your host access to see if it does what you expect\.
.sp
Default:
\fI\fIhosts allow\fR\fR\fI = \fR\fI # none (i\.e\., all hosts permitted access)\fR\fI \fR
.sp
Example:
\fI\fIhosts allow\fR\fR\fI = \fR\fI150\.203\.5\. myhost\.mynet\.edu\.au\fR\fI \fR
.RE

deny hosts
.PP
.RS 4
This parameter is a synonym for
hosts deny\.
.RE

hosts deny (S)
.PP
.RS 4
The opposite of
\fIhosts allow\fR
\- hosts listed here are
\fINOT\fR
permitted access to services unless the specific services have their own lists to override this one\. Where the lists conflict, the
\fIallow\fR
list takes precedence\.
.sp
In the event that it is necessary to deny all by default, use the keyword ALL (or the netmask
0\.0\.0\.0/0) and then explicitly specify to the
\fIhosts allow = hosts allow\fR
parameter those hosts that should be permitted access\.
.sp
Default:
\fI\fIhosts deny\fR\fR\fI = \fR\fI # none (i\.e\., no hosts specifically excluded)\fR\fI \fR
.sp
Example:
\fI\fIhosts deny\fR\fR\fI = \fR\fI150\.203\.4\. badhost\.mynet\.edu\.au\fR\fI \fR
.RE

idmap alloc backend (G)
.PP
.RS 4
idmap alloc backend は Winbindが WindowsのSIDに対してUnixのuid/gidを 割り当てるためのプラグインインターフェースを提供する。 このオプションは
\fIidmap domains\fR
パラメーターと ID割り当て機能を提供する idmap モジュールの名前を結びつけるために 利用される。 それぞれのidmapプラグインが実装しているID割り当て機能の特徴については それぞれのmanページを参照すること。最も共通のプラグインは、 tdb (\fBidmap_tdb\fR(8)) と ldap (\fBidmap_ldap\fR(8)) である。
.sp
\fIidmap alloc config\fR
オプションも参照すること。
.sp
\fINo default\fR
.sp
Example:
\fI\fIidmap alloc backend\fR\fR\fI = \fR\fItdb\fR\fI \fR
.RE

idmap alloc config (G)
.PP
.RS 4
idmap alloc config のプレフィックスは、
\fIidmap alloc backend\fR
パラメーターで設定された バックエンドに対するパラメーターの設定方法を提供する。 それぞれの idmap プラグインに対する個別の設定方法の詳細については man ページを参照すること。
.sp
\fINo default\fR
.RE

idmap backend (G)
.PP
.RS 4
idmap backend は Winbindが SID/uid/gid のマッピングテーブルを 格納するための様々なバックエンドを利用するためのプラグイン インターフェースを提供する。 このオプションは、より新しくて柔軟な
\fIidmap domains\fR
パラメーターと同時に 利用することはできない。 "idmap backend" と "idmap domains" の主な違いは 前者が全てのドメインに対して単一のバックエンドのみ利用可能であるのに 対して、後者はドメインごとに個別にバックエンドを設定可能であると いうことである。
.sp
SID/uid/gid のバックエンドの実装として tdb (\fBidmap_tdb\fR(8))、 ldap (\fBidmap_ldap\fR(8))、 rid (\fBidmap_rid\fR(8))、 ad (\fBidmap_tdb\fR(8))が提供されている。
.sp
Default:
\fI\fIidmap backend\fR\fR\fI = \fR\fItdb\fR\fI \fR
.RE

idmap cache time (G)
.PP
.RS 4
このパラメーターにはWinbindのidmapインターフェースが SID/uid/gidの問い合わせに成功した結果をキャッシュする秒数を設定する。
.sp
Default:
\fI\fIidmap cache time\fR\fR\fI = \fR\fI900\fR\fI \fR
.RE

idmap config (G)
.PP
.RS 4
idmap config のプレフィックスは、Sambaのパラメーターのオプション設定 機能を利用して、\fIidmap domains\fR
オプションで定義されたそれぞれのドメインを管理する方法を提供する。 idmap config プレフィックスに続けて、ドメイン名、コロン、そして 選択したバックエンド用の設定を指定しなければならない。 全てのドメインで指定可能な3つのオプションがある。
.PP
backend = backend_name
.RS 4
このドメインでSID/uid/gidのバックエンドとして利用する idmapプラグインの名前を指定する。
.RE
.PP
default = [yes|no]
.RS 4
ユーザー、グループの探索で、(アカウント SIDや、 ドメインSIDの比較で一致した)指定されたドメインに 該当者が存在しない場合のデフォルトの ドメイン/バックエンドとして利用される。
.RE
.PP
readonly = [yes|no]
.RS 4
ドメイン内のあらゆるユーザーやグループに対して 試みられる(\fIidmap alloc backend\fR
による)uidやgidの割り当てを試みない read onlyのドメインとして扱う。
.RE
.sp
次の例はCORPドメインが\fBidmap_ad\fR(8)
バックエンド で、他の全てのドメインが\fBidmap_tdb\fR(8)
バックエンドとしてどのように 設定されるかを示している。 TRUSTEDDOMAINSの文字列は、"idmap config" の設定として 参照するための任意のキーであり、実際のドメイン名を表しているわけでは ない。この設定は、明示的に指定されていない他の全てのドメインを包括する ドメインを意味している。
.sp
.RS 4
.nf
	idmap domains = CORP TRUSTEDDOMAINS

	idmap config CORP:backend  = ad
	idmap config CORP:readonly = yes

	idmap config TRUSTEDDOMAINS:backend = tdb
	idmap config TRUSTEDDOMAINS:default = yes
	idmap config TRUSTEDDOMAINS:range   = 1000 \- 9999
	
.fi
.RE
\fINo default\fR
.RE

idmap domains (G)
.PP
.RS 4
idmap domains オプションは、WinbindのSID/uid/gidのテーブルを 管理するためにそれぞれ別々の設定がなされたバックエンドを持つ Windowsドメインのリストを定義する。 このパラメーターは、以前の
\fIidmap backend\fR
オプションと同時に利用することはできない。
.sp
値は、Winbindのプライマリドメイン、および信頼関係にあるドメインの ショートドメイン名から構成される。リストに指定されていない ドメインのための包括的なドメイン名として、任意の文字列のドメインを 指定することも可能である。
.sp
それぞれのドメインの SID/uid/gid バックエンドを管理するための 詳細については\fIidmap config\fRを参照のこと。
.sp
\fINo default\fR
.sp
Example:
\fI\fIidmap domains\fR\fR\fI = \fR\fIdefault AD CORP\fR\fI \fR
.RE

winbind gid
.PP
.RS 4
This parameter is a synonym for
idmap gid\.
.RE

idmap gid (G)
.PP
.RS 4
idmap gid パラメータは UNIX グループを NT グループの SID に マッピングする際に使用するグループ id の範囲を指定する。 予期しない競合が発生しないようにするため、この GID の範囲に ローカルな グループや NIS グループが存在しないようにすること
.sp
\fIidmap backend\fR、\fIidmap domains\fR、\fIidmap config\fRも参照のこと。
.sp
Default:
\fI\fIidmap gid\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIidmap gid\fR\fR\fI = \fR\fI10000\-20000\fR\fI \fR
.RE

idmap negative cache time (G)
.PP
.RS 4
このパラメーターは Winbindのidmapインターフェースが SID/uid/gidの問い合わせに失敗した結果をキャッシュしておく秒数を 指定する。
.sp
Default:
\fI\fIidmap negative cache time\fR\fR\fI = \fR\fI120\fR\fI \fR
.RE

winbind uid
.PP
.RS 4
This parameter is a synonym for
idmap uid\.
.RE

idmap uid (G)
.PP
.RS 4
idmap uid パラメータは UNIX ユーザを NT ユーザの SID に マッピングする際に割り当てられるユーザ id の範囲を指定する。 予期しない競合が発生しないようにするため、この GID の範囲に ローカルな ユーザや NIS ユーザが存在しないようにすること
.sp
\fIidmap backend\fR、\fIidmap domains\fR、\fIidmap config\fRオプションも参照のこと。
.sp
Default:
\fI\fIidmap uid\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIidmap uid\fR\fR\fI = \fR\fI10000\-20000\fR\fI \fR
.RE

include (G)
.PP
.RS 4
このパラメータを使うと、ある設定ファイル中に別の設定ファイルを挿入できる。 挿入されるファイルは、挿入された場所に記述されたかのように、 そのままの形で挿入される。
.sp
このパラメータには、\fI%u\fR、
\fI%P\fR、\fI%S\fRパラメータを除き、標準の変数置換が適用される。
.sp

\fIinclude = registry\fR
というパラメータには特殊な意味が ある。これはカレントディレクトリから
\fIregistry\fR
という 名前のファイルをインクルードする\fIのではなく\fR、 レジストリーからグローバル設定を読み込む。詳細はレジストリーベースの設定 に関する章を参照されたい。注意：このオプションはレジストリー共有を自動的に 有効にする。
.sp
Default:
\fI\fIinclude\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIinclude\fR\fR\fI = \fR\fI/usr/local/samba/lib/admin_smb\.conf\fR\fI \fR
.RE

inherit acls (S)
.PP
.RS 4
This parameter can be used to ensure that if default acls exist on parent directories, they are always honored when creating a new file or subdirectory in these parent directories\. The default behavior is to use the unix mode specified when creating the directory\. Enabling this option sets the unix mode to 0777, thus guaranteeing that default directory acls are propagated\.
.sp
Default:
\fI\fIinherit acls\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

inherit owner (S)
.PP
.RS 4
The ownership of new files and directories is normally governed by effective uid of the connected user\. This option allows the Samba administrator to specify that the ownership for new files and directories should be controlled by the ownership of the parent directory\.
.sp
Common scenarios where this behavior is useful is in implementing drop\-boxes where users can create and edit files but not delete them and to ensure that newly create files in a user\'s roaming profile directory are actually owner by the user\.
.sp
Default:
\fI\fIinherit owner\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

inherit permissions (S)
.PP
.RS 4
The permissions on new files and directories are normally governed by
\fIcreate mask\fR,
\fIdirectory mask\fR,
\fIforce create mode\fR
and
\fIforce directory mode\fR
but the boolean inherit permissions parameter overrides this\.
.sp
New directories inherit the mode of the parent directory, including bits such as setgid\.
.sp
New files inherit their read/write bits from the parent directory\. Their execute bits continue to be determined by
\fImap archive\fR,
\fImap hidden\fR
and
\fImap system\fR
as usual\.
.sp
Note that the setuid bit is
\fInever\fR
set via inheritance (the code explicitly prohibits this)\.
.sp
This can be particularly useful on large systems with many users, perhaps several thousand, to allow a single [homes] share to be used flexibly by each user\.
.sp
Default:
\fI\fIinherit permissions\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

interfaces (G)
.PP
.RS 4
このオプションにより、Sambaがブラウジング、名前の登録その他のNBTの通信に利用するネットワークインタフェースのリストを設定することが可能となる。 デフォルトの場合、Sambaはカーネルに対して有効なインタフェースのリストを問い合わせ、 127\.0\.0\.1以外のブロードキャスト可能なインタフェースをすべて利用する。
.sp
このオプションはインタフェースを示す文字列のリストとなる。 各文字列は以下の形式のいずれで指定してもよい。
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
ネットワークインタフェース名(eth0など)。 シェルのようなワイルドカード指定も可能である。 例えばeth*は「eth」から始まるすべてのインタフェースを指定したことになる。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
IPアドレス。 この場合、ネットマスクの値は、カーネルから取得されたインタフェースのリストにより設定される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
IP/mask のペア。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
ブロードキャスト/mask のペア。
.sp
.RE
「mask」パラメータはビット長(例えば24はクラスCネットワーク)で指定しても、 ドット区切り10進数表記で指定してもよい。
.sp
上記の「IP」パラメータは、ドット区切り10進法で指定しても、 OSの標準的なホスト名解決機構で解決可能なホスト名で指定してもよい。
.sp
デフォルトで、Samba はループバックインタフェース (IPアドレス 127\.0\.0\.1) を除くブロードキャスト可能なすべての有効なインタフェースを使用する。
.sp
以下の設定では、eth0 デバイスと 192\.168\.2\.10 および 192\.168\.3\.10 の IP アドレスに対応する 3 つのネットワークインタフェースが指定されている。 後者のインタフェース 2 つに対するネットマスクは 255\.255\.255\.0 に設定されている。
.sp
Default:
\fI\fIinterfaces\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIinterfaces\fR\fR\fI = \fR\fIeth0 192\.168\.2\.10/24 192\.168\.3\.10/255\.255\.255\.0\fR\fI \fR
.RE

invalid users (S)
.PP
.RS 4
This is a list of users that should not be allowed to login to this service\. This is really a
\fIparanoid\fR
check to absolutely ensure an improper setting does not breach your security\.
.sp
A name starting with a \'@\' is interpreted as an NIS netgroup first (if your system supports NIS), and then as a UNIX group if the name was not found in the NIS netgroup database\.
.sp
A name starting with \'+\' is interpreted only by looking in the UNIX group database via the NSS getgrnam() interface\. A name starting with \'&\' is interpreted only by looking in the NIS netgroup database (this requires NIS to be working on your system)\. The characters \'+\' and \'&\' may be used at the start of the name in either order so the value
\fI+&group\fR
means check the UNIX group database, followed by the NIS netgroup database, and the value
\fI&+group\fR
means check the NIS netgroup database, followed by the UNIX group database (the same as the \'@\' prefix)\.
.sp
The current servicename is substituted for
\fI%S\fR\. This is useful in the [homes] section\.
.sp
Default:
\fI\fIinvalid users\fR\fR\fI = \fR\fI # no invalid users\fR\fI \fR
.sp
Example:
\fI\fIinvalid users\fR\fR\fI = \fR\fIroot fred admin @wheel\fR\fI \fR
.RE

iprint server (G)
.PP
.RS 4
このパラメータは、\fIprinting\fR
が
\fBiprint\fR
に設定されている場合のみ有効である。
.sp
設定されている場合、CUPS の
\fIclient\.conf\fR
で指定された ServerName オプションの値がこのパラメータによって上書きされる。 複数の仮想 Samba サーバが起動している環境で各々が異なる CUPS デーモンに接続している環境では、このパラメータが必要となる。
.sp
Default:
\fI\fIiprint server\fR\fR\fI = \fR\fI""\fR\fI \fR
.sp
Example:
\fI\fIiprint server\fR\fR\fI = \fR\fIMYCUPSSERVER\fR\fI \fR
.RE

keepalive (G)
.PP
.RS 4
The value of the parameter (an integer) represents the number of seconds between
\fIkeepalive\fR
packets\. If this parameter is zero, no keepalive packets will be sent\. Keepalive packets, if sent, allow the server to tell whether a client is still present and responding\.
.sp
Keepalives should, in general, not be needed if the socket has the SO_KEEPALIVE attribute set on it by default\. (see
\fIsocket options\fR)\. Basically you should only use this option if you strike difficulties\.
.sp
Default:
\fI\fIkeepalive\fR\fR\fI = \fR\fI300\fR\fI \fR
.sp
Example:
\fI\fIkeepalive\fR\fR\fI = \fR\fI600\fR\fI \fR
.RE

kernel change notify (S)
.PP
.RS 4
このパラメータは、Samba がカーネルに対してディレクトリの変更 通知を要求するか指定でき、この機能を使用すれば、サーバ上にある データに変更があった場合に SMB クライアントがその結果を 反映できるようになる。
.sp
このパラメータは使用しているカーネルが inotify インターフェース を使用してユーザプログラムに対しての変更の通知をサポートしている 場合にのみ使用される。
.sp
Default:
\fI\fIkernel change notify\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

kernel oplocks (G)
.PP
.RS 4
カーネルベースの
\fIoplocks\fR
をサポートしているUNIX(現在はIRIXとLinux 2\.4カーネルのみ)の場合、 このパラメータにより oplock の利用を制御できる。
.sp
カーネル oplocks のサポートにより、
\fBsmbd\fR(8)
が oplock を行ったファイルに対して、 ローカルな UNIX プロセスや NFS 経由でのアクセスがあった際に、 Sambaが
\fIoplocks\fR
を破棄することが可能となる。 これにより、 SMB/CIFS と NFS やローカルファイルアクセスとの間の完全な一貫性が確保される (これは\fI非常に\fR素晴らしいことである :\-)。
.sp
このパラメータのデフォルト値は、
\fBon\fR
であるが、 カーネルがこの機能をサポートしていないシステムでは、自動的に無効にされる。 このパラメータを変更する必要はないであろう。
.sp
Default:
\fI\fIkernel oplocks\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

lanman auth (G)
.PP
.RS 4
This parameter determines whether or not
\fBsmbd\fR(8)
will attempt to authenticate users or permit password changes using the LANMAN password hash\. If disabled, only clients which support NT password hashes (e\.g\. Windows NT/2000 clients, smbclient, but not Windows 95/98 or the MS DOS network client) will be able to connect to the Samba host\.
.sp
The LANMAN encrypted response is easily broken, due to it\'s case\-insensitive nature, and the choice of algorithm\. Servers without Windows 95/98/ME or MS DOS clients are advised to disable this option\.
.sp
Unlike the
encrypt passwords
option, this parameter cannot alter client behaviour, and the LANMAN response will still be sent over the network\. See the
client lanman auth
to disable this for Samba\'s clients (such as smbclient)
.sp
If this option, and
ntlm auth
are both disabled, then only NTLMv2 logins will be permited\. Not all clients support NTLMv2, and most will require special configuration to use it\.
.sp
Default:
\fI\fIlanman auth\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

large readwrite (G)
.PP
.RS 4
このパラメータは、Windows 2000で導入された、 さまざまなSMBリクエストにおける新しい64Kのストリーム読みとりおよび書き込みを
\fBsmbd\fR(8)
がサポートするかどうかを制御する。 Windows 2000クライアントのリダイレクタにはバグがあるため、 このパラメータを利用するには、SambaがIRIX、Solaris、Linux 2\.4カーネルのような64ビットのOSで動作している必要がある。 Windows 2000クライアントにおいては、10% のパフォーマンス向上が見込まれる。 デフォルト値は on であるが、他の Samba コードほどにはテストが充分には行われていない。
.sp
Default:
\fI\fIlarge readwrite\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

ldap admin dn (G)
.PP
.RS 4

\fIldap admin dn\fR
は、 Samba がユーザのアカウント情報を取得するために ldap サーバに接続する際に 用いられる、Distinguished Name (DN) を指定する。
\fIldap admin dn\fR
は、
\fIprivate/secrets\.tdb\fR
ファイルに 格納された admin dn のパスワードとともに用いられる。 これがどのように連携するかについての詳細な情報は、
\fBsmbpasswd\fR(8)
のマニュアルページを参照のこと。
.sp

\fIldap admin dn\fR
には完全な DN 名を指定する必要がある。
\fIldap suffix\fR
の値が
\fIldap admin dn\fR
に付加されることはない。
.sp
\fINo default\fR
.RE

ldap connection timeout (G)
.PP
.RS 4
This parameter tells the LDAP library calls which timeout in seconds they should honor during initial connection establishments to LDAP servers\. It is very useful in failover scenarios in particular\. If one or more LDAP servers are not reachable at all, we do not have to wait until TCP timeouts are over\. This feature must be supported by your LDAP library\.
.sp
This parameter is different from
\fIldap timeout\fR
which affects operations on LDAP servers using an existing connection and not establishing an initial connection\.
.sp
Default:
\fI\fIldap connection timeout\fR\fR\fI = \fR\fI2\fR\fI \fR
.RE

ldap debug level (G)
.PP
.RS 4
This parameter controls the debug level of the LDAP library calls\. In the case of OpenLDAP, it is the same bit\-field as understood by the server and documented in the
\fBslapd.conf\fR(5)
manpage\. A typical useful value will be
\fI1\fR
for tracing function calls\.
.sp
The debug ouput from the LDAP libraries appears with the prefix [LDAP] in Samba\'s logging output\. The level at which LDAP logging is printed is controlled by the parameter
\fIldap debug threshold\fR\.
.sp
Default:
\fI\fIldap debug level\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIldap debug level\fR\fR\fI = \fR\fI1\fR\fI \fR
.RE

ldap debug threshold (G)
.PP
.RS 4
This parameter controls the Samba debug level at which the ldap library debug output is printed in the Samba logs\. See the description of
\fIldap debug level\fR
for details\.
.sp
Default:
\fI\fIldap debug threshold\fR\fR\fI = \fR\fI10\fR\fI \fR
.sp
Example:
\fI\fIldap debug threshold\fR\fR\fI = \fR\fI5\fR\fI \fR
.RE

ldap delete dn (G)
.PP
.RS 4
このパラメータは ldapsam の削除の操作時に、エントリを完全に 削除するか、Samba でしか使用されない属性だけを消すかの制御を行なう。
.sp
Default:
\fI\fIldap delete dn\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

ldap group suffix (G)
.PP
.RS 4
このパラメータは、グループが LDAP ディレクトリに加えられるときの サフィックスを指定する。もしこのパラメータが設定されていない場合、
\fIldap suffix\fR
の値が代わりに使用される。 サフィックスの文字列には、\fIldap suffix\fR
の文字列が付加されるため、相対 DN で指定を行なうこと。
.sp
Default:
\fI\fIldap group suffix\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIldap group suffix\fR\fR\fI = \fR\fIou=Groups\fR\fI \fR
.RE

ldap idmap suffix (G)
.PP
.RS 4
このパラメータは idmap mapping の情報の保存先のサフィックスを 指定する。このパラメータが設定されていない場合、
\fIldap suffix\fR
の値が代わりに使用される。 サフィックスの文字列には、\fIldap suffix\fR
の文字列が付加されるため、相対 DN で指定を行なうこと。
.sp
Default:
\fI\fIldap idmap suffix\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIldap idmap suffix\fR\fR\fI = \fR\fIou=Idmap\fR\fI \fR
.RE

ldap machine suffix (G)
.PP
.RS 4
このパラメータはマシンアカウントが LDAP ツリーのどこに 追加されるかを指定する。もしこのパラメータが設定されていない場合、
\fIldap suffix\fR
の値が代わりに使用される。 サフィックスの文字列には、\fIldap suffix\fR
の文字列が付加されるため、相対 DN で指定を行なうこと。
.sp
Default:
\fI\fIldap machine suffix\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIldap machine suffix\fR\fR\fI = \fR\fIou=Computers\fR\fI \fR
.RE

ldap passwd sync (G)
.PP
.RS 4
このオプションは、Samba によるパスワード変更時に、Samba が通常のアカウント (ワークステーション、サーバやドメインの信頼関係は含まない) の NT ハッシュや LM ハッシュと、LDAP のパスワード の同期をおこなうかを定義する。
.sp
\fIldap passwd sync\fR
には、 以下の 3 つのうちの 1 つを設定することができる:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIYes\fR
= LDAP、NT、LM パスワードの更新を試み、pwdLastSet time を変更する。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fINo\fR
= NT、LM パスワードと pwdLastSet time を更新する。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIOnly\fR
= LDAP パスワードのみを変更し、あとの処理は LDAP サーバに 委任する。
.sp
.RE
Default:
\fI\fIldap passwd sync\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

ldap replication sleep (G)
.PP
.RS 4
Samba が読みとり専用の LDAP レプリカに対して、書き込みの要求を行なった際には、読み書き可能なマスタサーバと通信するようにリダイレクトを行なう。 その後マスタサーバは、変更を最初に通信した「ローカル」サーバに対して複製を行なうが、特に遅い回線越しの場合、これには数秒の時間を要する。 特にドメインへの参加といったクライアント側の処理については、「成功」した処理が LDAP のデータに即座に反映されないことで、 混乱する可能性がある。
.sp
このオプションにより、LDAP サーバに変更が反映されるのを待つために Samba が短い時間待機するようになる。 遅延の大きいネットワークの場合、LDAP の複製に要する時間をネットワークモニタで取得の上、それに応じて値を増減すればよいだろう。 データの複製が完了したかどうかについてのチェックが行なわれるわけではない点に注意すること。
.sp
この値はミリ秒単位で指定する。最大値は 5000 (5秒)である。
.sp
Default:
\fI\fIldap replication sleep\fR\fR\fI = \fR\fI1000\fR\fI \fR
.RE

ldapsam:editposix (G)
.PP
.RS 4
Editposix is an option that leverages ldapsam:trusted to make it simpler to manage a domain controller eliminating the need to set up custom scripts to add and manage the posix users and groups\. This option will instead directly manipulate the ldap tree to create, remove and modify user and group entries\. This option also requires a running winbindd as it is used to allocate new uids/gids on user/group creation\. The allocation range must be therefore configured\.
.sp
To use this option, a basic ldap tree must be provided and the ldap suffix parameters must be properly configured\. On virgin servers the default users and groups (Administrator, Guest, Domain Users, Domain Admins, Domain Guests) can be precreated with the command
net sam provision\. To run this command the ldap server must be running, Winindd must be running and the smb\.conf ldap options must be properly configured\. The typical ldap setup used with the
\fIldapsam:trusted = yes\fR
option is usually sufficient to use
\fIldapsam:editposix = yes\fR
as well\.
.sp
An example configuration can be the following:
.sp
.RS 4
.nf
	encrypt passwords = true
	passdb backend = ldapsam

	ldapsam:trusted=yes
	ldapsam:editposix=yes

	ldap admin dn = cn=admin,dc=samba,dc=org
	ldap delete dn = yes
	ldap group suffix = ou=groups
	ldap idmap suffix = ou=idmap
	ldap machine suffix = ou=computers
	ldap user suffix = ou=users
	ldap suffix = dc=samba,dc=org

	idmap backend = ldap:"ldap://localhost"

	idmap uid = 5000\-50000
	idmap gid = 5000\-50000
	
.fi
.RE
.sp
This configuration assumes a directory layout like described in the following ldif:
.sp
.RS 4
.nf
	dn: dc=samba,dc=org
	objectClass: top
	objectClass: dcObject
	objectClass: organization
	o: samba\.org
	dc: samba

	dn: cn=admin,dc=samba,dc=org
	objectClass: simpleSecurityObject
	objectClass: organizationalRole
	cn: admin
	description: LDAP administrator
	userPassword: secret

	dn: ou=users,dc=samba,dc=org
	objectClass: top
	objectClass: organizationalUnit
	ou: users

	dn: ou=groups,dc=samba,dc=org
	objectClass: top
	objectClass: organizationalUnit
	ou: groups

	dn: ou=idmap,dc=samba,dc=org
	objectClass: top
	objectClass: organizationalUnit
	ou: idmap

	dn: ou=computers,dc=samba,dc=org
	objectClass: top
	objectClass: organizationalUnit
	ou: computers
	
.fi
.RE
.sp
.sp
Default:
\fI\fIldapsam:editposix\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

ldapsam:trusted (G)
.PP
.RS 4
デフォルトで、ドメインコントローラとして動作し、認証に LDAP を用いている Samba は、ユーザやグループの情報を取得するために、UNIX の NSS サブシステムを必要とする。 UNIX がユーザ情報を /etc/passwd や /etc/group に格納する機構からすると、これは明らかに非効率である。 ユーザが把握する必要がある重要な項目の一つに、所属グループの一覧がある。 通常の UNIX のユーザ管理機構であれば、/etc/group ファイルの全体を参照するか、LDAP 環境においては NSS 機構を用いて同様のことを行なう。 UNIX には group のメンバを参照するのに最適化された関数が存在している。 しかし、残念なことに、ユーザやグループを扱うその他の関数については、こうした最適化は行なわれていない。
.sp
o Samba を大規模環境に適用させるため、\fIldapsam:trusted = yes\fR
オプションにより、Samba に関係するユーザおよびグループのデータベースは LDAP 標準の posixAccount/posixGroup 属性に格納されているとみなす。 さらに、Samba の AUXILIARY(補助) オブジェクトクラスについても、同じ LDAP オブジェクト中に POSIX データとして格納されているものとみなす。 これらの前提条件に適合する場合、
\fIldapsam:trusted = yes\fR
を設定することが可能となる。 この場合、Samba はユーザ情報の NSS に対する問い合わせを完全にバイパスする。 最適化された LDAP クエリにより、ログオンや管理作業が劇的に高速化される。 LDAP データベースのサイズにもよるが、共通的なクエリについては、100 倍以上の高速化が容易に達成される。
.sp
Default:
\fI\fIldapsam:trusted\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

ldap ssl (G)
.PP
.RS 4
このオプションは、Samba が ldap server に接続する際に、SSL を用いるかどうかを制御するために用いられる。これは、
\fIconfigure\fR
スクリプトの
\-\-with\-ssl
オプションで有効化される、 Samba の古い SSL サポートとは
\fI無関係\fR
.sp
である。
		
	\fIldap ssl\fR
の値には、以下の 3 つのうちいずれかを設定すること:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIOff\fR
= ディレクトリのクエリ時には決して SSL を用いない。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIStart_tls\fR
= ディレクトリサーバと通信する際に、LDAPv3 StartTLS 拡張オプション (RFC2830) を利用する。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIOn\fR
=
\fIldap server\fR
に対して、常に ldaps ポートで SSL を用いて接続する。 下位互換である
\-\-with\-ldapsam
オプションが configure 時に指定された場合に のみ有効である。
\fIpassdb backend\fR
も参照のこと。
.sp
.RE
Default:
\fI\fIldap ssl\fR\fR\fI = \fR\fIstart_tls\fR\fI \fR
.RE

ldap suffix (G)
.PP
.RS 4
全体に適用される LDAP サフィックスを指定すると共に、sambaDomain オブジェクトの格納先を指定する。
.sp
ldap suffix は、\fIldap user suffix\fR、
\fIldap group suffix\fR、\fIldap machine suffix\fR、
\fIldap idmap suffix\fR
で指定された値に付加される。 これらのパラメータでは
\fIldap suffix\fR
からの相対 DN で指定が行なわれる。
.sp
Default:
\fI\fIldap suffix\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIldap suffix\fR\fR\fI = \fR\fIdc=samba,dc=org\fR\fI \fR
.RE

ldap timeout (G)
.PP
.RS 4
Samba が LDAP サーバに接続しようとした際に、該当サーバがダウンしていたり、該当サーバに到達することができなかったりした場合に Samba が接続待ちでフリーズしてしまわないように、このパラメータでは Samba が接続の確立を待機する時間を秒単位で指定する。 デフォルトは 15 秒であり、この時間内に LDAP サーバは接続要求に対して応答する必要がある。
.sp
Default:
\fI\fIldap timeout\fR\fR\fI = \fR\fI15\fR\fI \fR
.RE

ldap user suffix (G)
.PP
.RS 4
このパラメータは、ユーザが LDAP ディレクトリに加えられるときの サフィックスを指定する。もしこのパラメータが設定されていない場合、
\fIldap suffix\fR
の値が代わりに使用される。 サフィックスの文字列には、\fIldap suffix\fR
の文字列が付加されるため、相対 DN で指定を行なうこと。
.sp
Default:
\fI\fIldap user suffix\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIldap user suffix\fR\fR\fI = \fR\fIou=people\fR\fI \fR
.RE

level2 oplocks (S)
.PP
.RS 4
このパラメータにより、 Samba が共有上で level2(読みとり専用) oplock をサポートするかどうかが制御される。
.sp
level2 の読みとり専用 oplock を利用することで、 Windows NT クライアントは、既に oplock が行われているファイルを別のクライアントがオープンしようとした際に (今までの排他的な oplock の場合に行われていた関連するすべての oplock を廃棄する処理の代わりに)、 読み書き可能な oplock から読みとり専用の oplock へのダウングレードを行うような oplock をファイルに対して行うことが可能になる。 これにより、ファイルをオープンしているクライアントのうち、level2 oplock をサポートしているものは、 ファイルの先読みのみを行うキャッシュ(このキャッシュは書き込みキャッシュやロックを行わない)を引続き行うため、 書き込みが行われないようなファイル(例えばアプリケーションのexeファイルなど)に対して多くのアクセスが行われる際のパフォーマンスが改善される。
.sp
read only の oplock を行っていたクライアントのいずれかがファイルに書き込みを行った時点で、 すべてのクライアントに対して、 oplock を「なし(none)」の状態に解除し、先読みキャッシュを破棄するように通知が行なわれる(応答待ちは行なわれない)。
.sp
このパラメータを有効にして、 共有されている実行ファイルのアクセスを高速化することを推奨する。
.sp
level2 oplock に関する詳細な議論については、CIFS の仕様を参照のこと。
.sp
現在、\fIkernel oplocks\fR
がサポートされていると、 level2 oplock は(このパラメータが\fByes\fRになっていても)、利用されない。 このパラメータを機能させるためには、
\fIoplocks\fR
パラメータが、共有上で
\fByes\fR
である必要があることに注意。
.sp
Default:
\fI\fIlevel2 oplocks\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

lm announce (G)
.PP
.RS 4
このパラメータにより、
\fBnmbd\fR(8)
が、 OS/2 クライアントのブラウズリスト上に Samba サーバを格納するために必要な lanman announce のブロードキャストを送出するかどうかが制御される。 このパラメータは3つの値、\fByes\fR、
\fBno\fR、\fBauto\fRをとる。 デフォルトは
\fBauto\fR
である。
\fBno\fR
の場合、Sambaは決してこのブロードキャストを送出しない。
\fByes\fR
の場合、Sambaは lanman announce のブロードキャストを
\fIlm interval\fR
によって設定された間隔で定期的に送出する。
\fBauto\fR
の場合、 Sambaはデフォルトでは lanman announce を送出しないが、受信を待機する。 そして、このブロードキャストを受信すると、
\fIlm interval\fR
によって設定された間隔で定期的なブロードキャストの送出を開始する。
.sp
Default:
\fI\fIlm announce\fR\fR\fI = \fR\fIauto\fR\fI \fR
.sp
Example:
\fI\fIlm announce\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

lm interval (G)
.PP
.RS 4
Samba が OS/2 クライアントが必要とする lanman announce のブロードキャストを送出するように設定されている場合 (\fIlm announce\fR
パラメータを参照のこと)、 このパラメータにより送出間隔が秒単位で指定される。 これが 0 の場合、
\fIlm announce\fR
パラメータの設定に関わらず、 lanman announce は送出されない。
.sp
Default:
\fI\fIlm interval\fR\fR\fI = \fR\fI60\fR\fI \fR
.sp
Example:
\fI\fIlm interval\fR\fR\fI = \fR\fI120\fR\fI \fR
.RE

load printers (G)
.PP
.RS 4
このパラメータは、printcapファイル中で定義されたすべてのプリンタをデフォルトでブラウジング可能とするかどうかを制御する真偽値パラメータである。 詳細は、
\fIprinters\fR
セクションを参照のこと。
.sp
Default:
\fI\fIload printers\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

local master (G)
.PP
.RS 4
このオプションにより、
\fBnmbd\fR(8)
がサブネットのローカルマスタブラウザになるかどうかが制御される。
\fBno\fR
の場合、
nmbd
はサブネットのローカルマスタブラウザになろうとせず、 すべてのブラウザ選定において、常に敗退することになる。 デフォルトで、このパラメータは
\fByes\fR
に設定されている。 このパラメータを
\fByes\fR
にすることは、 Samba がサブネットのローカルマスタブラウザと\fIなる\fRことを意味するものではなく、
nmbd
がローカルマスタブラウザの選定に\fI 参加する\fR
ということを意味するものに過ぎない。
.sp
このパラメータの値を
\fBno\fR
にすると、nmbd
は
\fI決して\fR
ローカルマスタブラウザにならなくなる。
.sp
Default:
\fI\fIlocal master\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

lock dir
.PP
.RS 4
This parameter is a synonym for
lock directory\.
.RE

lock directory (G)
.PP
.RS 4
このオプションでは、ロックファイルを置くためのディレクトリを 指定する。ロックファイルは
\fImax connections\fR
オプションにより利用される。
.sp
注意：レジストリ設定の中では、このオプションは指定できない。
.sp
Default:
\fI\fIlock directory\fR\fR\fI = \fR\fI${prefix}/var/locks\fR\fI \fR
.sp
Example:
\fI\fIlock directory\fR\fR\fI = \fR\fI/var/run/samba/locks\fR\fI \fR
.RE

locking (S)
.PP
.RS 4
このパラメータは、 クライアントからのロック要求により、 サーバがロック処理を行うかどうかを制御する。
.sp
locking = noの場合、 すべてのロックおよびアンロック要求は成功したものとして扱われ、 すべてのロック状態の問い合わせは、ファイルがロック可能であると応答する。
.sp
locking = yesの場合、 サーバにより実際のロック処理が実行される。
.sp
このオプションを\fBno\fRにすることは、 いかなる場合でも推奨されないが、 ロックを必要としない\fIと思われる\fR
read only のファイルシステム(例えばCDROMドライブ)では、有用
\fIかも知れない\fR。
.sp
ロックが機能しない場合、 データが破壊される可能性もあるため、全体に対しても、 個々の共有に対しても、ロックを無効にする際には注意すること。このパラメータの設定は通常必要ない。
.sp
\fINo default\fR
.RE

lock spin count (G)
.PP
.RS 4
Samba 3\.0\.24 において、このパラメータは無効となった。 このパラメータで実現されていた機能は、現在
\fIlock spin time\fR
パラメータで制御されている。
.sp
Default:
\fI\fIlock spin count\fR\fR\fI = \fR\fI0\fR\fI \fR
.RE

lock spin time (G)
.PP
.RS 4
smbd が一度失敗したロックを再度獲得しようとする際の待ち時間を、 マイクロ秒単位で指定する。 このパラメータのデフォルト値は、 Samba 3\.0\.23 において 10 から 200 に変更された。 関連する
\fIlock spin count\fR
パラメータは Samba 3\.0\.24 以降では使用されない。 このパラメータの値を変更する必要はないであろう。
.sp
Default:
\fI\fIlock spin time\fR\fR\fI = \fR\fI200\fR\fI \fR
.RE

log file (G)
.PP
.RS 4
このオプションにより、 Sambaのログファイル(デバッグファイル)の名称を変更することが可能である。
.sp
このオプションには、標準の変数置換が適用されるため、 個々のユーザやマシン毎にログを分割することが可能である。
.sp
\fINo default\fR
.sp
Example:
\fI\fIlog file\fR\fR\fI = \fR\fI/usr/local/samba/var/log\.%m\fR\fI \fR
.RE

debuglevel
.PP
.RS 4
This parameter is a synonym for
log level\.
.RE

log level (G)
.PP
.RS 4
このパラメータの値(整数値)により、
\fIsmb\.conf\fR
ファイル中でデバッグレベル(ログレベル)を設定することが可能になる。 このパラメータは Samba 2\.2\.x 系列と比べ強化されており、デバッグクラス毎にデバッグレベルを指定することが可能となっている。 これにより、システムの設定が非常に柔軟に行なえるようになる。以下の デバッグクラスが現在実装されている。
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIall\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fItdb\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIprintdrivers\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIlanman\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIsmb\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIrpc_parse\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIrpc_srv\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIrpc_cli\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIpassdb\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIsam\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIauth\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIwinbind\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIvfs\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIidmap\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIquota\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIacls\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIlocking\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fImsdfs\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIdmapi\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIregistry\fR
.sp
.RE
Default:
\fI\fIlog level\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIlog level\fR\fR\fI = \fR\fI3 passdb:5 auth:10 winbind:2\fR\fI \fR
.RE

logon drive (G)
.PP
.RS 4
このパラメータは、 ホームディレクトリとして接続されるパスを指定する (\fIlogon home\fR
も参照のこと)。 このパラメータは NT Workstation によってのみ利用される。
.sp
このパラメータは、Sambaがログオンサーバとして構成された場合のみ、 意味をもつことに注意。
.sp
訳注: Samba 3\.0 系列で LDAP や TDB を認証データベースとして用いている場合、これらの値はユーザ毎に保持され、本パラメータは指定がなかった際のデフォルト値を設定するものとなる。
.sp
Default:
\fI\fIlogon drive\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIlogon drive\fR\fR\fI = \fR\fIh:\fR\fI \fR
.RE

logon home (G)
.PP
.RS 4
このパラメータは、Windows 95/98/NT Workstation がSambaのPDCに対してログオンする際に用いられるホームディレクトリの位置を指定する。 これにより、例えば
.sp
C:\e>\fBNET USE H: /HOME\fR
.sp
のような形式でコマンドプロンプトから接続を行うことが可能となる。
.sp
このオプションには、通常の変数置換が適用されるため、 個々のユーザやマシン毎にログオンスクリプトを分けることが可能になっている。
.sp
このパラメータは、Windows 9x ワークステーションにおいて、 移動プロファイルをユーザのホームディレクトリのサブディレクトリに格納するために利用することが可能である。 この場合、以下のような設定を行う:
.sp
logon home = \e\e%N\e%U\eprofile
.sp
これにより、Samba はクライアントから NetUserGetInfo リクエストなどで情報を要求された場合に上記文字列を返却するが、その際変数置換が行なわれる。 Windows 9x のクライアントは、ユーザが
net use /home
コマンドを発行した際には、この情報の \e\eserver\eshare 部分だけを用いるが、 プロファイルを扱う場合は文字列全体を利用する。
.sp
Sambaの以前のバージョンでは、
\fIlogon home\fRではなく、\fIlogon path\fR
が用いられていた。 このため、net use /home
がうまく動作しなかったが、 プロファイルをホームディレクトリの外に置くことが可能であった。 現在の実装は正しい実装である。上記のような技を用いることで、 このパラメータをプロファイルの位置の設定にも利用することが可能になっている。
.sp
この機能を無効とするには、\fIlogon home = ""\fR
のように空の文字列を設定する。
.sp
このパラメータは、Sambaがログオンサーバとして構成された場合のみ、 意味をもつ。
.sp
訳注: Samba 3\.0 系列で LDAP や TDB を認証データベースとして用いている場合、これらの値はユーザ毎に保持され、本パラメータは指定がなかった際のデフォルト値を設定するものとなる。
.sp
Default:
\fI\fIlogon home\fR\fR\fI = \fR\fI\e\e%N\e%U\fR\fI \fR
.sp
Example:
\fI\fIlogon home\fR\fR\fI = \fR\fI\e\eremote_smb_server\e%U\fR\fI \fR
.RE

logon path (G)
.PP
.RS 4
このパラメータにより、移動プロファイル(Desktop、NTuser\.datなど)が格納されるディレクトリが指定される。 以前のマニュアルページとは矛盾するが、このパラメータはWindows 9xの移動プロファイルとは無関係である。 Windows 9x システムで移動プロファイルを利用する方法については、
\fIlogon home\fR
パラメータを参照のこと。
.sp
このオプションは、標準の変数置換が適用されるため、 個々のユーザやマシン毎にログオンスクリプトを分けることが可能である。 このパラメータにより、Windows NT クライアントによって読み出される「Application Data」(
\fIデスクトップ\fR、\fIスタート メニュー\fR、
\fIネットワークコンピュータ\fR、
\fIプログラム\fRやその他のフォルダとそのコンテンツ)のディレクトリも設定される。
.sp
設定やディレクトリを Windows NT クライアント上にロードするため、共有やパスはユーザが読み込み可能にしなければならない。 また、Windows NT クライアントが NTuser\.dat やその他のディレクトリを作成できるように、 ユーザが最初にログインする時には共有を書き込み可能にしなければならない。 必要があれば、ディレクトリと中身は読み出し専用にすることができる。 ただし、NTuser\.dat ファイルを読み出し専用にすることは推奨できない。 NTuser\.dat を NTuser\.man に名前を変更することで期待される動作(\fI固定\fRプロファイル(MANdatory profile))を実現できる。
.sp
Windows クライアントは、ユーザがログインしていなくても [homes] 共有への接続を保持することがある。 そのため、logon path に [homes] 共有への参照を含めないようにしなくてはならない (たとえば、このパラメータを\e\e%N\ehomes\eprofile_path のように設定すると問題が発生することがある)。
.sp
このオプションには、標準の変数置換が適用されるため、 個々のユーザやマシン毎にログオンスクリプトを分けることが可能になる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
この値をクォーテーションで囲まないこと。これを
\(lq\e\e%N\eprofile\e%U\(rq
のようにすると、 プロファイル機構に問題が発生する。 tdbsam もしくは ldapsam が passdb backend として用いられている環境では、 ユーザアカウントが作成された時点で、このパラメータで設定されている内容が passdb backend に書き込まれるが、 その後 smb\.conf ファイルにあるパラメータの値は、上書きされることがある。 passdb backend への書き込みに際して発生したエラーについては、 適切なツール(コマンドラインツールの pdbedit などのツール)を用いて編集する必要がある。

このパラメータは、Sambaがログオンサーバとして構成された場合のみ、 意味をもつことに注意。
.sp
このパラメータの値を空文字列に設定することで、移動プロファイルを無効にすることができる。
\fIlogon path = ""\fR
のようにすれば良い。 smb\.conf ファイルのデフォルトの値を空文字列にしても、 passdb backend 中のユーザアカウントの設定で何らかの値を指定した場合は、 空文字列の設定を上書きすることになるので注意すること。 移動プロファイルを完全に無効とするには、各ユーザアカウントの設定が空文字列になっている必要がある。
.sp
設定例:
.sp
.RS 4
.nf
logon path = \e\ePROFILESERVER\ePROFILE\e%U
.fi
.RE
.sp
.sp
Default:
\fI\fIlogon path\fR\fR\fI = \fR\fI\e\e%N\e%U\eprofile\fR\fI \fR
.RE

logon script (G)
.PP
.RS 4
このパラメータは、 ユーザのログインが成功した際にダウンロードして実行される、 バッチファイル (\.bat) や Windows NT のコマンドファイル (\.cmd) を指定する。 ファイルは DOS 形式の行末(改行コード) CR/LF でなければならない。 ファイルの作成には DOS 形式のエディタを使うことが推奨される。
.sp
スクリプトは
\fI[netlogon]\fR
サービスからの相対パスで記述する必要がある。 [netlogon] サービスの
\fIpath\fR
が
\fI/usr/local/samba/netlogon\fR
で、\fIlogon script = STARTUP\.BAT\fR
の場合、 実際にファイルがダウンロードされるパスは以下のものになる:
.sp
.RS 4
.nf
	/usr/local/samba/netlogon/STARTUP\.BAT
.fi
.RE
.sp
.sp
バッチファイルの中身は自由に記述することが可能である。 推奨されるコマンドとしては、 各マシンを同じタイムサーバの時刻と同期するようにさせる
NET TIME \e\eSERVER /SET /YES
がある。 ほかには、共通に利用されるユーティリティ用に、例えば
NET USE U: \e\eSERVER\eUTILS
という設定を行なったり、サンプルとして
.sp
.RS 4
.nf
\fBNET USE Q: \e\eSERVER\eISO9001_QA\fR
.fi
.RE
.sp
といった設定を行ったりすることが挙げられる。
.sp
[netlogon] 共有に対しては、 バッチファイルが改変されてセキュリティが侵害されてしまわないように、 書き込みアクセスを許可しないか、 安全な環境下でのみバッチファイルへの書き込み権限をユーザに与えるようにすること。
.sp
このオプションには、標準の変数置換が適用されるため、 個々のユーザやマシン毎にログオンスクリプトを分けることが可能になる。
.sp
このパラメータは、Sambaがログオンサーバとして構成された場合のみ、 意味をもつ。
.sp
Default:
\fI\fIlogon script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIlogon script\fR\fR\fI = \fR\fIscripts\e%U\.bat\fR\fI \fR
.RE

lppause command (S)
.PP
.RS 4
このパラメータには、 指定した印刷ジョブの印刷やスプーリングを停止させるためにサーバホスト上で実行されるコマンドを指定する。
.sp
このコマンドは、プリンタ名と停止させる印刷ジョブの番号を引数にとり、印刷ジョブを一時停止させるプログラムやスクリプトでなければならない。 これを実装する方法の一つは、非常に低い優先権を持つジョブはプリンタに送られないというジョブの優先権の仕様を利用するものである。
.sp
\fI%p\fR
変数は、 プリンタ名に置換される。
\fI%j\fR
はジョブ番号(整数)に置換される。 HPUX の場合(\fIprinting=hpux\fRを参照のこと)、
\fI\-p%p\fR
オプションを lpq コマンドに付加することで、正しいステータスが表示される。 たとえば、ジョブの優先権が設定されたフェンス優先権より低いならジョブは停止状態であるが、 優先権が等しいかより高いならスプール状態または印刷中の状態となる。
.sp
サーバの PATH 環境変数が利用できないかもしれないことを考慮して、 lppause command を絶対パスで記述する癖をつけておくと良い。
.sp
Default:
\fI\fIlppause command\fR\fR\fI = \fR\fI # 現在のところデフォルト値は設定されていない。 ただし、\fIprinting\fR パラメータの値が ただし、\fIprinting\fR パラメータの値が \fBSYSV\fR の場合は lp \-i %p\-%j \-H hold、 \fBSOFTQ\fR の場合は qstat \-s \-j%j \-h がデフォルト値となる。\fR\fI \fR
.sp
Example:
\fI\fIlppause command\fR\fR\fI = \fR\fI/usr/bin/lpalt %p\-%j \-p0\fR\fI \fR
.RE

lpq cache time (G)
.PP
.RS 4
このパラメータは、
lpq
コマンドが頻繁に呼び出されるのを防ぐため、lpr の情報(出力)をキャッシュする期間を制御する。 システムが使用する
lpq
コマンドの種別毎にキャッシュが行なわれる。そのため、ユーザ毎に異なった
lpq
コマンドを使用する場合、 キャッシュ情報は共有されない。
.sp
キャッシュファイルは
\fI/tmp/lpq\.xxxx\fR
に保存される。 xxxx は使用している
lpq
コマンドのハッシュ値となる。
.sp
デフォルトは 10 秒であるため、キャッシュされたデータが10秒以内の場合は、 前回行なわれた同一のlpqの実行結果のキャッシュが用いられる。
lpq
コマンドのレスポンスが非常に遅い場合は、この値を大きくすることを推奨する。
.sp
値を 0 にした場合、キャッシュは完全に無効となる。
.sp
Default:
\fI\fIlpq cache time\fR\fR\fI = \fR\fI10\fR\fI \fR
.sp
Example:
\fI\fIlpq cache time\fR\fR\fI = \fR\fI30\fR\fI \fR
.RE

lpq command (S)
.PP
.RS 4
このパラメータには、
lpq形式のプリンタ状態情報を得るため、 サーバ上で実行するコマンドを指定する。
.sp
このコマンドは、プリンタ名のみを引数としてとり 、 プリンタ状態情報を出力するプログラムやスクリプトでなければならない。
.sp
現在、BSD、AIX、LPRNG、PLP、SYSV、HPUX、QNX、CUPS、SOFTQ という9つの印刷形式がサポートされており、 これにより大部分の UNIX システムがサポートされる。
\fIprinting =\fR
オプションにより、利用する形式を指定することも可能である。
.sp
クライアントによっては(特にWindows for Workgroups)、 状態情報を要求しているプリンタの接続番号(connection number)を正しく送らないことがある。 この場合、サーバはクライアントが接続している最初の印刷サービスの状況を報告する。この動作は、 与えられた接続番号が不正な場合にのみ行なわれる。
.sp
\fI%p\fR
変数は、 プリンタ名に置換される。この変数が指定されなかった場合、プリンタ名はコマンドの最後に付加される。
.sp
サーバの
\fB$PATH\fR
環境変数が利用できないかもしれないことを考慮して、
\fIlpq command\fR
を絶対パスで記述する癖をつけておくと良い。 CUPS ライブラリを付加してコンパイルした場合は、 smbd が印刷キューのリストを取得するためのライブラリコールを行なうため、
\fIlpq command\fR
は必要ない。
.sp
Default:
\fI\fIlpq command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIlpq command\fR\fR\fI = \fR\fI/usr/bin/lpq \-P%p\fR\fI \fR
.RE

lpresume command (S)
.PP
.RS 4
このパラメータには、 特定の印刷ジョブの印刷やスプールを再開したり続行するためにサーバ上で実行するコマンドを指定する。
.sp
このコマンドは、 プリンタ名とジョブ番号を受け取るとその印刷ジョブを再開するプログラムやスクリプトでなければならない。
\fIlppause command\fR
パラメータも参照のこと。
.sp
\fI%p\fR
変数は、 プリンタ名に置換される。
\fI%j\fR
はジョブ番号(整数)に置換される。
.sp
サーバの PATH 環境変数が利用できないかもしれないことを考慮して、
\fIlpresume command\fR
を絶対パスで記述することを推奨する。
.sp
\fIprinting\fR
パラメータも参照のこと。
.sp
デフォルト: 現在のところ、この設定のデフォルト値は設定されていない。 ただし、\fIprinting\fR
パラメータの値が
\fBSYSV\fR
の場合、 デフォルト値は以下の通り:
.sp
lp \-i %p\-%j \-H resume
.sp
また、\fIprinting\fR
パラメータの値が
\fBSOFTQ\fR
の場合、デフォルト値は以下の通り:
.sp
qstat \-s \-j%j \-r
.sp
Default:
\fI\fIlpresume command\fR\fR\fI = \fR\fIlpresume command = /usr/bin/lpalt %p\-%j \-p2\fR\fI \fR
.RE

lprm command (S)
.PP
.RS 4
このパラメータには、 印刷ジョブを削除するためにサーバ上で実行するコマンドを指定する。
.sp
このコマンドは、 プリンタ名とジョブ番号を受け取るとその印刷ジョブを削除するプログラムやスクリプトでなければならない。
.sp
\fI%p\fR
変数は、 プリンタ名に置換される。
\fI%j\fR
はジョブ番号(整数)に置換される。
.sp
サーバの PATH 環境変数が利用できないかもしれないことを考慮して、
\fIlprm command\fR
を絶対パスで記述することを推奨する。
.sp
以下に設定例を示す。
.sp
.RS 4
.nf
lprm command = /usr/bin/lprm \-P%p %j

あるいは

lprm command = /usr/bin/cancel %p\-%j
.fi
.RE
.sp
.sp
Default:
\fI\fIlprm command\fR\fR\fI = \fR\fI printing パラメータの設定に依存する \fR\fI \fR
.RE

machine password timeout (G)
.PP
.RS 4
Sambaサーバが NT ドメインのメンバである場合 (\fIsecurity = domain\fRパラメータを参照のこと) 、 実行中の smbd プロセスは、\fIprivate/secrets\.tdb\fR
という TDB ファイルに格納されたコンピュータアカウントのパスワードを定期的に変更しようとする。 このパラメータは、パスワードの変更を行なう間隔を秒単位で設定する。デフォルトは、NT ドメインのメンバサーバと同じく 1 週間 (秒単位で表される) である。
.sp

\fBsmbpasswd\fR(8)
および
\fIsecurity = domain\fR
パラメータも参照のこと。
.sp
Default:
\fI\fImachine password timeout\fR\fR\fI = \fR\fI604800\fR\fI \fR
.RE

magic output (S)
.PP
.RS 4
このパラメータは、Magic スクリプト(下記の
\fImagic script\fR
パラメータを参照) によって生成される出力結果が書き込まれるファイルの名前を指定する。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
複数のクライアントが同じ
\fIMagic スクリプト\fR
を同じディレクトリで利用する場合、 出力ファイルの内容は不定になる。

Default:
\fI\fImagic output\fR\fR\fI = \fR\fI<magic script name>\.out\fR\fI \fR
.sp
Example:
\fI\fImagic output\fR\fR\fI = \fR\fImyfile\.txt\fR\fI \fR
.RE

magic script (S)
.PP
.RS 4
このパラメータで指定したファイルは、 ファイルをオープン後クローズした時点でサーバにより実行される。 このパラメータにより、UNIX のスクリプトを Samba ホストに送って、 接続しているユーザの権限で実行する機能が提供される。
.sp
このようにして実行されたスクリプトは、 ユーザに削除する権限があり、ファイルが削除可能であれば、 実行完了と同時に削除される。
.sp
スクリプトが生成した出力は、
\fImagic output\fR
パラメータ(前述)で指定されたファイルに書き込まれる。
.sp
シェルによっては、改行コードとして CR ではなく CR/LF を利用しているスクリプトをうまく実行できないことに注意。 Magic スクリプトはホスト上で\fIそのまま\fR実行されるため、ホストやシェルによっては、 DOS の改行コードを修正しておく必要があるかも知れない。
.sp
Magic スクリプトは
\fI 実験用 \fR
のパラメータであり、このパラメータを安全だと考えるべきでは
\fIない\fR。
.sp
Default:
\fI\fImagic script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fImagic script\fR\fR\fI = \fR\fIuser\.csh\fR\fI \fR
.RE

mangled map (S)
.PP
.RS 4
このパラメータは、 Windows や DOS で表示できない UNIX ファイル名の対応づけを直接指定するためのものである。 名前の短縮のみがこの機能に必要とされるすべてではない。 実際、DOS と UNIX とでファイル名の拡張子の異なるドキュメントが存在することがある。 一例を挙げると、UNIX では通常 HTML ファイルを示す拡張子として
\fI\.html\fR
が使用されるが、DOS では
\fI\.htm\fR
の方が一般的である。
.sp
このため、\fIhtml\fR
と
\fIhtm\fR
の対応づけを行なう場合は、以下のようにする:
.sp

\fImangled map = (*\.html *\.htm)\fR\.
.sp
とても便利な利用方法の一つに、CDROMによってファイル名の末尾に付加されている
\fI;1\fR(幾つかのUNIX上でのみ表示される) の削除が挙げられる。これを行なうためには、 (*;1 *;) のように指定すればよい。
.sp
Default:
\fI\fImangled map\fR\fR\fI = \fR\fI # mangled map なし\fR\fI \fR
.sp
Example:
\fI\fImangled map\fR\fR\fI = \fR\fI(*;1 *;)\fR\fI \fR
.RE

mangled names (S)
.PP
.RS 4
このパラメータは、 UNIX 上の DOS非互換のファイル名をDOS互換の名前(「短縮名」)に短縮してアクセス可能にするか、 単純に無視するかどうかを制御する。
.sp
短縮処理がどのように行なわれているかについての詳細は、
\fIname mangling\fR
セクションを参照のこと。
.sp
短縮が行なわれる場合のアルゴリズムは以下の通りである(訳注:以下は hash アルゴリズムの場合):
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
ファイル名の先頭から一番右にあるドットの前までの英数5文字は、 大文字に変換された上で、 短縮名の先頭5文字となる。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
チルダ「~」が短縮名に付加される。 更に元々のファイル名のベース部分(ファイル名から拡張子部分を除いたもの)から生成された一意な2文字が付加される。 拡張子にあたる部分は、大文字を含んでいるか、 3文字以上の場合のみ、ハッシュの計算に含まれる。
.sp
「~」の利用を避けたい場合は、
\fImangling char\fR
オプションにより、別の文字を指定することも可能である。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
UNIX 上のファイル名がドットから始まる場合、 そのファイルは DOS の隠しファイルとして扱われる。 この場合の短縮名は、ファイル名の先頭のドットを取り除き、 実際の拡張子に関わらず、拡張子「___(「_」3文字」を付加したものから、一般のファイル名と同様にして生成する。
.sp
.RE
2桁のハッシュ値は、大文字の英数文字になる。
.sp
このアルゴリズムは、 ディレクトリ内のファイルに先頭の英数 5 文字が同一のファイル名が存在する時のみ名前の衝突が発生するが、 実際に衝突する確率は、1/1300 である。
.sp
名前の短縮処理により、(この処理が有効な限り) Windows や DOS から、UNIX 側の長いファイル名を保持したまま UNIX ディレクトリ間のファイルのコピーができる。 Windows や DOS 側から UNIX 側のファイル名の拡張子を変更しても、ベース名は保持される。 なお、セッションが異なっても短縮名は変化しない。
.sp
Default:
\fI\fImangled names\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

mangle prefix (G)
.PP
.RS 4
短縮名を生成する際に、元々の名前に付加するプレフィックスの長さを指定する。 大きな値を指定すると、 ハッシュアルゴリズムの効果が低下し、 名前の衝突の可能性が高まる。 最小値は 1 であり、最大は 6 である。
.sp
mangle prefix は mangling method が hash2 の時のみ有効である。
.sp
Default:
\fI\fImangle prefix\fR\fR\fI = \fR\fI1\fR\fI \fR
.sp
Example:
\fI\fImangle prefix\fR\fR\fI = \fR\fI4\fR\fI \fR
.RE

mangling char (S)
.PP
.RS 4
このパラメータは
\fIname mangling\fR
において、
\fImagic\fR
キャラクタとして利用される文字を指定する。デフォルトは「~」であるが、 ソフトウェアによっては問題が発生してしまうかも知れない。 このオプションにより、任意の文字を指定することが可能になる。 このパラメータは mangling method が hash の時のみ有効である。
.sp
Default:
\fI\fImangling char\fR\fR\fI = \fR\fI~\fR\fI \fR
.sp
Example:
\fI\fImangling char\fR\fR\fI = \fR\fI^\fR\fI \fR
.RE

mangling method (G)
.PP
.RS 4
短縮名を生成する際に利用するアルゴリズムを指定する。 「hash」と「hash2」という2つの値を指定することが可能である。 「hash」は Samba 2\.2\.x でのデフォルト値であり、長年 Samba で利用されてきた方式である。 「hash2」は新しい方式であり、現在のデフォルト値である。これは、 (名前の重複の発生が低減される点で)より優れたアルゴリズムといえる。 Win32 アプリケーションの多くが短縮名を記憶しているため、 新しいアルゴリズムへの変更は、 こうしたアプリケーションの再インストールが必要になる可能性があるという点で、安易に行なうべきではない。
.sp
Default:
\fI\fImangling method\fR\fR\fI = \fR\fIhash2\fR\fI \fR
.sp
Example:
\fI\fImangling method\fR\fR\fI = \fR\fIhash\fR\fI \fR
.RE

map acl inherit (S)
.PP
.RS 4
この真偽値パラメータにより、
\fBsmbd\fR(8)
は Windows の ACL に格納される「inherit」および「protected」の ACE フラグを user\.SAMBA_PAI (訳注: Samba_Posix_Acl_Inheritance) と呼ばれる拡張属性にマッピングすることが可能となる。 このパラメータは Samba が拡張属性をサポートしているプラットフォーム(Linux および IRIX など)で実行されており、Windows 2000 の ACL エディタから Samba 側の POSIX ACL とのマッピングを実現するコードで継承を適切に設定できる場合のみ、有効となる。
.sp
Default:
\fI\fImap acl inherit\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

map archive (S)
.PP
.RS 4
このパラメータは、DOSのアーカイブ属性を UNIXの所有者(owner)実行権ビットに割り当てるかどうかを決定する。 DOSのアーカイブ属性は、バックアップを行なった後でファイルが修正されると設定される。 このオプションを変更する契機の一つは、Samba マシン上のファイルを修正した際に、UNIX 上で実行可能になってしまわないようにしたい場合であろう。 これは、共有のソースコードやドキュメントなどに関して、非常に悩ましい事象である。
.sp
このパラメータを利用する場合は、 所有者の実行権ビットがマスクされないように(100というアクセス権が含まれるように)、
\fIcreate mask\fR
パラメータを設定することが必要となることに注意。 詳細は、\fIcreate mask\fR
パラメータを参照のこと。
.sp
Default:
\fI\fImap archive\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

map hidden (S)
.PP
.RS 4
このパラメータは、DOSの隠しファイル属性を UNIXの全員(world)の実行権ビットに割り当てるかどうかを決定する。
.sp
このパラメータを利用する場合は、 全体の実行権ビットがマスクされないように(001というアクセス権を含むように)、
\fIcreate mask\fR
パラメータを設定することが必要となることに注意。 詳細は、\fIcreate mask\fR
パラメータを参照のこと。
.sp
\fINo default\fR
.RE

map read only (S)
.PP
.RS 4
このパラメータは、DOS の読みとり専用属性を UNIX のファイルシステムに対応付ける方法を制御する。
.sp
このパラメータには 3 とおりの値を指定することが可能である。これにより、
\fIstore dos attributes\fR
が
\fBNo\fR、もしくは拡張属性が存在しない環境において、
\fBsmbd\fR(8)
がファイルの読みとり専用属性を表示する方法を制御することが可能である。
\fIstore dos attributes\fR
が
\fByes\fR
の場合、このパラメータは\fI無視される\fR。 これは Samba 3\.0\.21 で新設されたパラメータである。
.sp
3 とおりの値を以下に示す:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBYes\fR
\- 読みとり専用の DOS 属性は、UNIX のパーミッションビットにおけるユーザ、すなわち所有者の書き込み権ビットに反転した形で対応付けられる。 所有者の書き込み権ビットが設定されていない場合、ファイルには読みとり専用属性が付加されているものとみなされる。もしも、読み取り専用のDOS属性が設定されてた場合、 グループとその他の書き込み権ビットはゼロに設定される。ACL中の書き込みビットはSambaによって無視される。もしも、読み取り専用のDOS属性が設定されていなかった場合、Sambaは単にそれの所有者の書き込みビットを設定する。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBPermissions\fR
\- 読みとり専用の DOS 属性は、接続しているユーザに対する有効なパーミッションに対応付けられる。 これは、\fBsmbd\fR(8)
が UNIX のパーミッションおよび (存在していれば) POSIX の ACL を読みとることにより確認される。 接続しているユーザにファイルを編集するパーミッションがない場合、ファイルには読みとり専用属性が付加されているものとみなされる。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}

\fBNo\fR
\- 読みとり専用 DOS 属性は、パーミッションに対応付けられず、
\fIstore dos attributes\fR
パラメータによってのみ付与される。 これは、マウント中の CD を共有する場合にも便利かも知れない。
.sp
.RE
Default:
\fI\fImap read only\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

map system (S)
.PP
.RS 4
このパラメータは、DOSのシステムファイル属性を UNIXのグループ実行権ビットに割り当てるかどうかを決定する。
.sp
このパラメータを利用する場合は、 グループ実行権ビットがマスクされないように(010というアクセス権を含むように)、
\fIcreate mask\fR
パラメータを設定することが必要となることに注意。 詳細は、\fIcreate mask\fR
パラメータを参照のこと。
.sp
Default:
\fI\fImap system\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

map to guest (G)
.PP
.RS 4
This parameter is only useful in
\fISECURITY = security\fR
modes other than
\fIsecurity = share\fR
and
\fIsecurity = server\fR
\- i\.e\.
\fBuser\fR, and
\fBdomain\fR\.
.sp
This parameter can take four different values, which tell
\fBsmbd\fR(8)
what to do with user login requests that don\'t match a valid UNIX user in some way\.
.sp
The four settings are :
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBNever\fR
\- Means user login requests with an invalid password are rejected\. This is the default\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBBad User\fR
\- Means user logins with an invalid password are rejected, unless the username does not exist, in which case it is treated as a guest login and mapped into the
\fIguest account\fR\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBBad Password\fR
\- Means user logins with an invalid password are treated as a guest login and mapped into the
\fIguest account\fR\. Note that this can cause problems as it means that any user incorrectly typing their password will be silently logged on as "guest" \- and will not know the reason they cannot access files they think they should \- there will have been no message given to them that they got their password wrong\. Helpdesk services will
\fIhate\fR
you if you set the
\fImap to guest\fR
parameter this way :\-)\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBBad Uid\fR
\- Is only applicable when Samba is configured in some type of domain mode security (security = {domain|ads}) and means that user logins which are successfully authenticated but which have no valid Unix user account (and smbd is unable to create one) should be mapped to the defined guest account\. This was the default behavior of Samba 2\.x releases\. Note that if a member server is running winbindd, this option should never be required because the nss_winbind library will export the Windows domain users and groups to the underlying OS via the Name Service Switch interface\.
.sp
.RE
Note that this parameter is needed to set up "Guest" share services when using
\fIsecurity\fR
modes other than share and server\. This is because in these modes the name of the resource being requested is
\fInot\fR
sent to the server until after the server has successfully authenticated the client so the server cannot make authentication decisions at the correct time (connection to the share) for "Guest" shares\. This parameter is not useful with
\fIsecurity = server\fR
as in this security mode no information is returned about whether a user logon failed due to a bad username or bad password, the same error is returned from a modern server in both cases\.
.sp
For people familiar with the older Samba releases, this parameter maps to the old compile\-time setting of the
\fB GUEST_SESSSETUP\fR
value in local\.h\.
.sp
Default:
\fI\fImap to guest\fR\fR\fI = \fR\fINever\fR\fI \fR
.sp
Example:
\fI\fImap to guest\fR\fR\fI = \fR\fIBad User\fR\fI \fR
.RE

max connections (S)
.PP
.RS 4
This option allows the number of simultaneous connections to a service to be limited\. If
\fImax connections\fR
is greater than 0 then connections will be refused if this number of connections to the service are already open\. A value of zero mean an unlimited number of connections may be made\.
.sp
Record lock files are used to implement this feature\. The lock files will be stored in the directory specified by the
\fIlock directory\fR
option\.
.sp
Default:
\fI\fImax connections\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fImax connections\fR\fR\fI = \fR\fI10\fR\fI \fR
.RE

max disk size (G)
.PP
.RS 4
This option allows you to put an upper limit on the apparent size of disks\. If you set this option to 100 then all shares will appear to be not larger than 100 MB in size\.
.sp
Note that this option does not limit the amount of data you can put on the disk\. In the above case you could still store much more than 100 MB on the disk, but if a client ever asks for the amount of free disk space or the total disk size then the result will be bounded by the amount specified in
\fImax disk size\fR\.
.sp
This option is primarily useful to work around bugs in some pieces of software that can\'t handle very large disks, particularly disks over 1GB in size\.
.sp
A
\fImax disk size\fR
of 0 means no limit\.
.sp
Default:
\fI\fImax disk size\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fImax disk size\fR\fR\fI = \fR\fI1000\fR\fI \fR
.RE

max log size (G)
.PP
.RS 4
このオプション(キロバイト単位の数値)は、 ログファイルの最大サイズを指定する。 Samba は定期的にログファイルのサイズを調べ、 最大値を超過した場合は、ファイルの拡張子に
\fI\.old\fR
を付加した名前にファイル名を変更する。
.sp
サイズ 0 は無制限を意味する。
.sp
Default:
\fI\fImax log size\fR\fR\fI = \fR\fI5000\fR\fI \fR
.sp
Example:
\fI\fImax log size\fR\fR\fI = \fR\fI1000\fR\fI \fR
.RE

max mux (G)
.PP
.RS 4
このオプションは、 Samba がクライアントに通知する同時に実行可能な SMB オペレーションの最大数を制御する。 このパラメータを設定する必要はないであろう。
.sp
Default:
\fI\fImax mux\fR\fR\fI = \fR\fI50\fR\fI \fR
.RE

max open files (G)
.PP
.RS 4
This parameter limits the maximum number of open files that one
\fBsmbd\fR(8)
file serving process may have open for a client at any one time\. The default for this parameter is set very high (10,000) as Samba uses only one bit per unopened file\.
.sp
The limit of the number of open files is usually set by the UNIX per\-process file descriptor limit rather than this parameter so you should never need to touch this parameter\.
.sp
Default:
\fI\fImax open files\fR\fR\fI = \fR\fI10000\fR\fI \fR
.RE

max print jobs (S)
.PP
.RS 4
このパラメータにより、 ある時点で Samba の印刷キューに蓄積可能なジョブの最大数が設定される。 設定数を超過すると、
\fBsmbd\fR(8)
は、 クライアントに「空き領域がない」というエラーを返却する。
.sp
Default:
\fI\fImax print jobs\fR\fR\fI = \fR\fI1000\fR\fI \fR
.sp
Example:
\fI\fImax print jobs\fR\fR\fI = \fR\fI5000\fR\fI \fR
.RE

protocol
.PP
.RS 4
This parameter is a synonym for
max protocol\.
.RE

max protocol (G)
.PP
.RS 4
このパラメータ(文字列)の値は、 サーバがサポートする最上位のプロトコルである。
.sp
設定可能な値は以下の通りである:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBCORE\fR: 最初期のもので、ユーザの概念がない
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBCOREPLUS\fR: ほんの少し CORE に手を加えたものである
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBLANMAN1\fR: 最初の
\fI 近代的な\fR
バージョンであり、 長いファイル名をサポートしている
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBLANMAN2\fR: LANMAN1 プロトコルを改良したものである
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBNT1\fR: 最も新しいプロトコルであり、 Windows NT が利用する。CIFSと呼ばれることもある。
.sp
.RE
通常、SMB プロトコルによりネゴシエーションを経て適切なプロトコルが選択されるため、 このオプションを設定すべきではない。
.sp
Default:
\fI\fImax protocol\fR\fR\fI = \fR\fINT1\fR\fI \fR
.sp
Example:
\fI\fImax protocol\fR\fR\fI = \fR\fILANMAN1\fR\fI \fR
.RE

max reported print jobs (S)
.PP
.RS 4
このパラメータにより、ある時点で Samba の印刷キューのポートモニタが表示する印刷ジョブの最大数が設定される。 この数値を超過した場合、超過したジョブは表示されない。 0 が設定された場合は、表示される印刷ジョブの制限はなくなる。
.sp
Default:
\fI\fImax reported print jobs\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fImax reported print jobs\fR\fR\fI = \fR\fI1000\fR\fI \fR
.RE

max smbd processes (G)
.PP
.RS 4
This parameter limits the maximum number of
\fBsmbd\fR(8)
processes concurrently running on a system and is intended as a stopgap to prevent degrading service to clients in the event that the server has insufficient resources to handle more than this number of connections\. Remember that under normal operating conditions, each user will have an
\fBsmbd\fR(8)
associated with him or her to handle connections to all shares from a given host\.
.sp
Default:
\fI\fImax smbd processes\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fImax smbd processes\fR\fR\fI = \fR\fI1000\fR\fI \fR
.RE

max stat cache size (G)
.PP
.RS 4
このパラメータにより、大文字小文字を区別しない名前の対応づけの高速化に用いられる
\fIstat cache\fR
に用いられるメモリの上限値が指定される。 このパラメータには、使用する stat cache のサイズをキロバイト (1024) 単位で指定する。 値 0 は無制限を意味する。このパラメータを変更する必要はないであろう。
.sp
Default:
\fI\fImax stat cache size\fR\fR\fI = \fR\fI256\fR\fI \fR
.sp
Example:
\fI\fImax stat cache size\fR\fR\fI = \fR\fI100\fR\fI \fR
.RE

max ttl (G)
.PP
.RS 4
このオプションは、
\fBnmbd\fR(8)
がブロードキャストを利用したりWINSサーバを利用したりして NetBIOS 名を要求する際の NetBIOS 名のデフォルトのTTL(time to live)を(秒単位で)設定する。 このパラメータを変更する必要はないであろう。 デフォルトは3日である。
.sp
Default:
\fI\fImax ttl\fR\fR\fI = \fR\fI259200\fR\fI \fR
.RE

max wins ttl (G)
.PP
.RS 4
このオプションは、
\fBsmbd\fR(8)
が WINS サーバとして動作している (\fIwins support = yes\fR)
nmbdに登録される NetBIOS 名の最大のTTL(time to live)を秒単位で指定する。 このパラメータを変更する必要はないであろう。 デフォルトは6日(518400秒)である。
.sp
Default:
\fI\fImax wins ttl\fR\fR\fI = \fR\fI518400\fR\fI \fR
.RE

max xmit (G)
.PP
.RS 4
このオプションにより、 Samba がネゴシエーション時に用いるパケットサイズの最大値が設定される。 デフォルトは 16644 であり、これは Windows 2000 の挙動に合わせた値である。 2048 以下ではおそらく問題が出るだろう。 このパラメータの値をデフォルトから変更する必要はないだろう。
.sp
Default:
\fI\fImax xmit\fR\fR\fI = \fR\fI16644\fR\fI \fR
.sp
Example:
\fI\fImax xmit\fR\fR\fI = \fR\fI8192\fR\fI \fR
.RE

message command (G)
.PP
.RS 4
このパラメータは、サーバが WinPopup 形式のメッセージを受信した際に、どのようなコマンドを実行するかを指定する。
.sp
一般的には、 何らかの形でメッセージを配送するコマンドを指定する。 これをどのようにして行なうかは、発想次第である。
.sp
以下に一例を示す:
.sp
.RS 4
.nf
message command = csh \-c \'xedit %s;rm %s\' &
.fi
.RE
.sp
.sp
これは、
xeditを利用してメッセージを配送し、 その後メッセージを削除する。\fI コマンドは、 すぐに制御を戻すようにすることが必須であることに注意すること\fR。 最後に \'&\' をつけたのは、そのためである。 コマンドを実行後すぐに制御が戻らないと、PC はメッセージ送信後フリーズしてしまう(うまくいけば、30 秒後に回復することになるだろう)。
.sp
全てのメッセージは、グローバルなゲストユーザの権限で配送される。 コマンド中では、標準の変数を利用できるが、
\fI%u\fR
は機能しない(\fI%U\fR
を利用するのが適切であろう)。
.sp
標準の変数以外に、 以下に示す変数を利用することが可能である:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%s\fR
= メッセージを含むファイル名
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%t\fR
= メッセージの送信先(通常はサーバ名)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%f\fR
= メッセージの送り元のユーザ
.sp
.RE
このコマンドにより、 メールを送るなど、さまざまな動作が考えられる。 おもしろいアイデアを思いついたら教えて欲しい。
.sp
以下はメッセージをrootへのメールとして送信する方法である:
.sp
.RS 4
.nf
message command = /bin/mail \-s \'message from %f on %m\' root < %s; rm %s
.fi
.RE
.sp
.sp
message command が指定されていない場合、 メッセージは配送されず、Sambaは送信者にエラーの発生を通知する。 ただし、WfWg はエラーコードを無視して配送を行ない、 メッセージの配送を報告する。
.sp
メッセージを単に削除したい場合は、以下のように設定すること:
.sp
.RS 4
.nf
message command = rm %s
.fi
.RE
.sp
.sp
Default:
\fI\fImessage command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fImessage command\fR\fR\fI = \fR\fIcsh \-c \'xedit %s; rm %s\' &\fR\fI \fR
.RE

min print space (S)
.PP
.RS 4
This sets the minimum amount of free disk space that must be available before a user will be able to spool a print job\. It is specified in kilobytes\. The default is 0, which means a user can always spool a print job\.
.sp
Default:
\fI\fImin print space\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fImin print space\fR\fR\fI = \fR\fI2000\fR\fI \fR
.RE

min protocol (G)
.PP
.RS 4
このパラメータの値(文字列)は、 Sambaがサポートする最低限のSMBプロトコルの dialect(レベル) を指定する。 有効なプロトコル名の一覧と、その簡単な説明については、
\fImax protocol\fR
パラメータを参照のこと。クライアントがサポートするプロトコルの dialect 一覧については、
\fIsource/smbd/negprot\.c\fR
の Cソースを参照するとよいであろう。
.sp
セキュリティ的な観点では、
\fIlanman auth\fR
パラメータも参照のこと。 それ以外の観点からこのパラメータを変更する必要はないであろう。
.sp
Default:
\fI\fImin protocol\fR\fR\fI = \fR\fICORE\fR\fI \fR
.sp
Example:
\fI\fImin protocol\fR\fR\fI = \fR\fINT1\fR\fI \fR
.RE

min receivefile size (G)
.PP
.RS 4
This option changes the behavior of
\fBsmbd\fR(8)
when processing SMBwriteX calls\. Any incoming SMBwriteX call on a non\-signed SMB/CIFS connection greater than this value will not be processed in the normal way but will be passed to any underlying kernel recvfile or splice system call (if there is no such call Samba will emulate in user space)\. This allows zero\-copy writes directly from network socket buffers into the filesystem buffer cache, if available\. It may improve performance but user testing is recommended\. If set to zero Samba processes SMBwriteX calls in the normal way\. To enable POSIX large write support (SMB/CIFS writes up to 16Mb) this option must be nonzero\. The maximum value is 128k\. Values greater than 128k will be silently set to 128k\.
.sp
Note this option will have NO EFFECT if set on a SMB signed connection\.
.sp
The default is zero, which diables this option\.
.sp
Default:
\fI\fImin receivefile size\fR\fR\fI = \fR\fI0\fR\fI \fR
.RE

min wins ttl (G)
.PP
.RS 4
このオプションは、
\fBnmbd\fR(8)
がWINSサーバとして動作している時に (\fIwins support = yes\fR)、
nmbd
に登録された NetBIOS 名の最小の TTL (time to live)を秒単位で指定する。 このパラメータを変更する必要はないであろう。 デフォルトは6時間(21600秒)である。
.sp
Default:
\fI\fImin wins ttl\fR\fR\fI = \fR\fI21600\fR\fI \fR
.RE

msdfs proxy (S)
.PP
.RS 4
This parameter indicates that the share is a stand\-in for another CIFS share whose location is specified by the value of the parameter\. When clients attempt to connect to this share, they are redirected to the proxied share using the SMB\-Dfs protocol\.
.sp
Only Dfs roots can act as proxy shares\. Take a look at the
\fImsdfs root\fR
and
\fIhost msdfs\fR
options to find out how to set up a Dfs root share\.
.sp
\fINo default\fR
.sp
Example:
\fI\fImsdfs proxy\fR\fR\fI = \fR\fI\eotherserver\esomeshare\fR\fI \fR
.RE

msdfs root (S)
.PP
.RS 4
If set to
\fByes\fR, Samba treats the share as a Dfs root and allows clients to browse the distributed file system tree rooted at the share directory\. Dfs links are specified in the share directory by symbolic links of the form
\fImsdfs:serverA\e\eshareA,serverB\e\eshareB\fR
and so on\. For more information on setting up a Dfs tree on Samba, refer to the MSDFS chapter in the Samba3\-HOWTO book\.
.sp
Default:
\fI\fImsdfs root\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

name cache timeout (G)
.PP
.RS 4
Specifies the number of seconds it takes before entries in samba\'s hostname resolve cache time out\. If the timeout is set to 0\. the caching is disabled\.
.sp
Default:
\fI\fIname cache timeout\fR\fR\fI = \fR\fI660\fR\fI \fR
.sp
Example:
\fI\fIname cache timeout\fR\fR\fI = \fR\fI0\fR\fI \fR
.RE

name resolve order (G)
.PP
.RS 4
このオプションは、どの名前サービスを用いて、またどのような順番で、 ホスト名から IP アドレスを解決するかを決定するため、 Samba の各プログラムで利用される。 このオプションの主な目的は、NetBIOS 名前解決をどのように行なうかを指定することである。 オプションは、名前解決オプションをスペースで区切った文字列で指定する。
.sp
オプションは、「lmhosts」、「host」、「wins」、「bcast」である。 これらは以下に示すように名前解決を実行する:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBlmhosts\fR
: Samba の lmhosts ファイルから IP アドレスを検索する。 NetBIOS 名サフィックスの指定されていない行が lmhosts ファイル中にあった場合、 (詳細は、lmhosts ファイルのマニュアルページを参照のこと)、 その行はすべてのサフィックスの検索にマッチする。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBhost\fR
: システム標準の方法で、\fI/etc/hosts \fR、 NIS 、 DNS への問い合わせを行ない、 ホスト名から IP アドレスへの名前解決を行なう。 名前解決の方法は、OSに依存する。 IRIX や Solaris の場合、
\fI/etc/nsswitch\.conf\fR
ファイルにより制御される。この方法は、問い合わせされた NetBIOS のサフィックスが 0x20(サーバ) か 0x1c(ドメインコントローラ) の時のみ利用され、それ以外は無効であることに注意。 後者は、アクティブディレクトリドメインでのみ有効である。 この場合、_ldap\._tcp\.domain に対応する　SRV RR エントリを検索するための DNS クエリが行われる。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBwins\fR
:
\fIWINSSERVER\fR
パラメータで指定された IP アドレスに対して名前の問い合わせが行なわれる。 WINS サーバが指定されていない場合、この方法は無視される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fBbcast\fR
:
\fIinterfaces\fR
パラメータで設定された各インタフェースに対してブロードキャストが実行される。 これは解決したいホストがローカルサブネットに接続されていることを前提とするため、 もっとも信頼性の低い名前解決の方法である。
.sp
.RE
以下の例では、最初にローカルの lmhosts ファイルを調査し、 次にブロードキャストを行ない、 最後にシステム標準のホスト名検索を試行する。
.sp
Samba が ADS セキュリティモード (security = ads) で動作する場合、
\fIname resolve order\fR
の設定は次のようにすべきである:
.sp
name resolve order = wins bcast
.sp
この 場合でも、DC は DNS への問い合わせを行なう。 失敗した場合に NetBIOS 名の問い合わせを行なうが、その際無意味な DNS への「DOMAIN<0x1c>」の問い合わせが抑止される。
.sp
Default:
\fI\fIname resolve order\fR\fR\fI = \fR\fIlmhosts host wins bcast\fR\fI \fR
.sp
Example:
\fI\fIname resolve order\fR\fR\fI = \fR\fIlmhosts bcast host\fR\fI \fR
.RE

netbios aliases (G)
.PP
.RS 4
これは、nmbdが Samba サーバの別名としてアナウンスする NetBIOS 名のリストである。これにより、ブラウズリスト中で単一のマシンを複数の名前で表示させることが可能になる。 マシンがブラウズサーバやログオンサーバとして動作している場合、別名はブラウズサーバやログオンサーバとしてはアナウンスされない。マシン本来の名前だけがそれらの機能をもつ名前としてアナウンスされる。
.sp
Default:
\fI\fInetbios aliases\fR\fR\fI = \fR\fI # 空文字列 (別名なし)\fR\fI \fR
.sp
Example:
\fI\fInetbios aliases\fR\fR\fI = \fR\fITEST TEST1 TEST2\fR\fI \fR
.RE

netbios name (G)
.PP
.RS 4
このパラメータにより、 Samba サーバの NetBIOS 名が設定される。デフォルトでは、ホストの DNS 名の最初の部分と同一である。マシンがブラウズサーバや、ログオンサーバの場合、ここで設定された名前 (またはホストのDNS名の最初の部分)がサービスをアナウンスする際に用いられる。
.sp
Samba 3\.0 には、NetBIOS が
PIPE
に設定されるとブラウジングや共有へのアクセスに問題が発生するというバグがある。 この問題を避けるためには、Samba 3\.0 マシンの名前を
PIPE
にしないこと。
.sp
Default:
\fI\fInetbios name\fR\fR\fI = \fR\fI # マシンの DNS 名\fR\fI \fR
.sp
Example:
\fI\fInetbios name\fR\fR\fI = \fR\fIMYNAME\fR\fI \fR
.RE

netbios scope (G)
.PP
.RS 4
このパラメータにより、 Samba が使用する NetBIOS スコープを設定される。LAN上のすべてのマシンに同じ値を設定しない限り、このパラメータを設定すべきではない。
.sp
Default:
\fI\fInetbios scope\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

nis homedir (G)
.PP
.RS 4
NIS マップから、[home] 共有を提供するサーバを取得する。 automounter を使用する UNIX システムでは、 ユーザのホームディレクトリが、必要に応じてリモートサーバから ワークステーションにマウントされるようになっていることが多い。
.sp
Samba のログオンサーバが実際のホームディレクトリを提供するサーバではなく、 NFS経由でホームディレクトリをマウントしている場合、 クライアントに自分自身がホームディレクトリを提供する SMB サーバであるように見せると、 ユーザがホームディレクトリにアクセスするためには、 二段階のネットワークアクセスが必要になる(1つは SMB で、もう 1 つは NFS)。 これはとても遅くなることがある。
.sp
このオプションにより、 Samba は home 共有がログオンサーバとは異なるサーバにあるものとして扱うことが可能になり、 Samba デーモンがホームディレクトリを提供するサーバで動作している限り、 Samba クライアントは、ホームディレクトリを提供しているサーバ上の共有を直接マウントする。 Samba が home 共有の情報をクライアントに返すとき、
\fIhomedir map\fR
パラメータ で指定された NIS マップに問い合わせて、そこにあるサーバの情報を利用する。
.sp
このオプションが機能するためには、NIS システムが動いていなければならず、 このオプションを指定した Samba サーバは、 ログオンサーバでなければならないことに注意すること。
.sp
Default:
\fI\fInis homedir\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

nt acl support (S)
.PP
.RS 4
この真偽値パラメータにより、
\fBsmbd\fR(8)
が UNIX のパーミッションを Windows NT のアクセスコントロールリストにマップするかどうかが決定される。 対象となる UNIX のパーミッションは、 ファイルやディレクトリに設定された伝統的な UNIX の所有者とグループのパーミッションと POSIX ACL である。 このパラメータは、Samba 2\.2\.2 より前のリリースでは、グローバルパラメータであった。
.sp
Default:
\fI\fInt acl support\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

ntlm auth (G)
.PP
.RS 4
This parameter determines whether or not
\fBsmbd\fR(8)
will attempt to authenticate users using the NTLM encrypted password response\. If disabled, either the lanman password hash or an NTLMv2 response will need to be sent by the client\.
.sp
If this option, and
lanman auth
are both disabled, then only NTLMv2 logins will be permited\. Not all clients support NTLMv2, and most will require special configuration to use it\.
.sp
Default:
\fI\fIntlm auth\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

nt pipe support (G)
.PP
.RS 4
この真偽値パラメータにより、
\fBsmbd\fR(8)
が Windows NT のクライアントに対して、 Windows NT の SMB 固有の
\fBIPC$\fR
パイプへの接続を許可するかどうかが制御される。 これは開発者のデバッグオプションであり、意識する必要はない。
.sp
Default:
\fI\fInt pipe support\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

nt status support (G)
.PP
.RS 4
この真偽値パラメータは、
\fBsmbd\fR(8)
が、 Windows NT/2000/XP クライアントに対して、 NT 固有のステータスのサポートのネゴシエーションを行なうかどうかを制御する。 これは、開発者のデバッグ用オプションであり、設定を変更すべきではない。 このオプションが
\fBno\fR
の場合、 Samba は Samba 2\.2\.3 以前と全く同様に、DOS エラーコードを返却する。
.sp
このオプションを無効にしてはならない。
.sp
Default:
\fI\fInt status support\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

null passwords (G)
.PP
.RS 4
Allow or disallow client access to accounts that have null passwords\.
.sp
See also
\fBsmbpasswd\fR(5)\.
.sp
Default:
\fI\fInull passwords\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

obey pam restrictions (G)
.PP
.RS 4
When Samba 3\.0 is configured to enable PAM support (i\.e\. \-\-with\-pam), this parameter will control whether or not Samba should obey PAM\'s account and session management directives\. The default behavior is to use PAM for clear text authentication only and to ignore any account or session management\. Note that Samba always ignores PAM for authentication in the case of
\fIencrypt passwords = yes\fR\. The reason is that PAM modules cannot support the challenge/response authentication mechanism needed in the presence of SMB password encryption\.
.sp
Default:
\fI\fIobey pam restrictions\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

only user (S)
.PP
.RS 4
This is a boolean option that controls whether connections with usernames not in the
\fIuser\fR
list will be allowed\. By default this option is disabled so that a client can supply a username to be used by the server\. Enabling this parameter will force the server to only use the login names from the
\fIuser\fR
list and is only really useful in
\fIsecurity = share\fR
level security\.
.sp
Note that this also means Samba won\'t try to deduce usernames from the service name\. This can be annoying for the [homes] section\. To get around this you could use
user = %S
which means your
\fIuser\fR
list will be just the service name, which for home directories is the name of the user\.
.sp
Default:
\fI\fIonly user\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

oplock break wait time (G)
.PP
.RS 4
これは Windows 9x と Windows NT 双方のバグに対応するために追加されたチューニングオプションである。 クライアントが oplock を解除させるような SMB を発行した時に、 Samba のクライアントに対する応答が早過ぎると、 クライアントは誤動作してしまい、解除要求に応答しない。 このチューニングパラメータ(ミリ秒単位で指定する)は、 こうした(異常動作を行なう)クライアントに対して oplock 解除要求を送付する前に、Samba がとる待ち時間になる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
Samba の oplock コードを読んで理解していない限り、このパラメータを変更してはいけない。

Default:
\fI\fIoplock break wait time\fR\fR\fI = \fR\fI0\fR\fI \fR
.RE

oplock contention limit (S)
.PP
.RS 4
これは
\fI非常に\fR
高度な
\fBsmbd\fR(8)
のチューニングオプションで、 複数のクライアントから同じファイルへの oplock 要求が行なわれた際の効率を改善するものである。
.sp
このパラメータには数値を指定する。 同じファイルに対して oplock を行なおうとするクライアントの大体の数がこのパラメータで指定した限界を越えると、
\fBsmbd\fR(8)
は、 たとえ要求されても oplock を許可しないようになる。これにより、
smbdは Windows NT と同様の動作を行うようになる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
Samba の oplock コードを読んで理解していない限り、このパラメータを変更してはいけない。

Default:
\fI\fIoplock contention limit\fR\fR\fI = \fR\fI2\fR\fI \fR
.RE

oplocks (S)
.PP
.RS 4
この真偽値オプションは、 共有内のファイルオープンが要求された際に oplock (opportunistic lock = 便宜的ロック) を行なうかどうかを
smbd
に指示する。 oplock により、Samba サーバ上のファイルアクセス速度を劇的に改善(およそ 30% 以上)することができる。 oplock により、クライアントは、積極的にファイルをローカルにキャッシュするようになるが、 信頼性の低いネットワーク環境の場合などに、これを無効にしたいと考えることもあるだろう (Windows NT サーバにおけるデフォルト値は有効である)。 これ以上の情報については、 Samba の
\fIdocs/\fR
ディレクトリにある
\fISpeed\.txt\fR
を参照のこと(訳注:現在は存在していないファイルである)。
.sp
oplock は共有内のファイル単位で無効にすることも可能である。
\fIveto oplock files\fR
パラメータを参照のこと。 システムによっては、oplock が OS 自身によって認識される。 この場合、Samba、NFS、ローカルなUNIXのいずれを経由してアクセスが行なわれた場合でも、 oplock が行なわれたファイルとのデータの同期が実現する。 詳細は、\fIkernel oplocks\fR
パラメータを参照のこと。
.sp
Default:
\fI\fIoplocks\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

os2 driver map (G)
.PP
.RS 4
このパラメータでは、 OS/2 のプリンタドライバ名と Windows NT のプリンタドライバ名とのマッピングが記述されたファイルへの絶対パスを指定する。 ファイル形式は以下のようになっている:
.sp
<nt driver name> = <os2 driver name>\.<device name>
.sp
HP LaserJet 5 のプリンタドライバを例にとった場合、 正しいエントリはHP LaserJet 5L = LASERJET\.HP LaserJet 5Lのようになる。
.sp
このファイルは、 Samba3\-HOWTO 本の Classical Printing 章で記述されているプリンタドライバの名前空間の問題に対応するために用いられる。 OS/2 クライアントに関する詳細については、Samba3\-HOWTO 本の other clients 章を参照のこと。
.sp
Default:
\fI\fIos2 driver map\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

os level (G)
.PP
.RS 4
この数値は、 Samba がブラウザ選定時に宣言する優先度を設定する。 このパラメータの値は、
\fBnmbd\fR(8)
が、ブロードキャスト範囲内における
\fIworkgroup\fR
のローカルマスタブラウザになるかどうかに影響する。
.sp
\fI注意 :\fR
ローカルマスタブラウザの選定に際して、既定値では、 Samba が Windows NT 4\.0/2000 のドメインコントローラ以外のすべての Microsoft 社のOSに優先する。 このため、Samba ホストの設定が不正の場合、 ブラウジング的にそのサブネットが孤立してしまう可能性がある。 Samba 3\.0 系列では、このパラメータは通常自動設定されるため、デフォルト値を手動で設定する必要は通常発生しない。(訳注: 実際には自動設定は行なわれない。この説明は誤りだと思われる) このパラメータに関する詳細は、Samba\-3 HOWTO ドキュメントの「Network Browsing」を参照のこと。
\fI注意:\fRこのパラメータの最大値は255である。 それより大きな値を使った場合、もしも、カウントは0から始まる!
.sp
Default:
\fI\fIos level\fR\fR\fI = \fR\fI20\fR\fI \fR
.sp
Example:
\fI\fIos level\fR\fR\fI = \fR\fI65\fR\fI \fR
.RE

pam password change (G)
.PP
.RS 4
With the addition of better PAM support in Samba 2\.2, this parameter, it is possible to use PAM\'s password change control flag for Samba\. If enabled, then PAM will be used for password changes when requested by an SMB client instead of the program listed in
\fIpasswd program\fR\. It should be possible to enable this without changing your
\fIpasswd chat\fR
parameter for most setups\.
.sp
Default:
\fI\fIpam password change\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

panic action (G)
.PP
.RS 4
これは Samba 開発者のためのオプションで、
\fBsmbd\fR(8)
か
\fBsmbd\fR(8)
がクラッシュした際に呼び出されるシステム上のコマンドを指定する。 これは通常問題が発生した事実を警告するのに使われる。
.sp
Default:
\fI\fIpanic action\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpanic action\fR\fR\fI = \fR\fI"/bin/sleep 90000"\fR\fI \fR
.RE

paranoid server security (G)
.PP
.RS 4
Some version of NT 4\.x allow non\-guest users with a bad passowrd\. When this option is enabled, samba will not use a broken NT 4\.x server as password server, but instead complain to the logs and exit\.
.sp
Disabling this option prevents Samba from making this check, which involves deliberatly attempting a bad logon to the remote server\.
.sp
Default:
\fI\fIparanoid server security\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

passdb backend (G)
.PP
.RS 4
This option allows the administrator to chose which backend will be used for storing user and possibly group information\. This allows you to swap between different storage mechanisms without recompile\.
.sp
The parameter value is divided into two parts, the backend\'s name, and a \'location\' string that has meaning only to that particular backed\. These are separated by a : character\.
.sp
Available backends can include:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
smbpasswd
\- The default smbpasswd backend\. Takes a path to the smbpasswd file as an optional argument\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
tdbsam
\- The TDB based password storage backend\. Takes a path to the TDB as an optional argument (defaults to passdb\.tdb in the
\fIprivate dir\fR
directory\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
ldapsam
\- The LDAP based passdb backend\. Takes an LDAP URL as an optional argument (defaults to
ldap://localhost)
.sp
LDAP connections should be secured where possible\. This may be done using either Start\-TLS (see
\fIldap ssl\fR) or by specifying
\fIldaps://\fR
in the URL argument\.
.sp
Multiple servers may also be specified in double\-quotes\. Whether multiple servers are supported or not and the exact syntax depends on the LDAP library you use\.
.sp
.RE

	Examples of use are:
.sp
.RS 4
.nf
passdb backend = tdbsam:/etc/samba/private/passdb\.tdb 

or multi server LDAP URL with OpenLDAP library:

passdb backend = ldapsam:"ldap://ldap\-1\.example\.com ldap://ldap\-2\.example\.com"

or multi server LDAP URL with Netscape based LDAP library:

passdb backend = ldapsam:"ldap://ldap\-1\.example\.com ldap\-2\.example\.com"
.fi
.RE
Default:
\fI\fIpassdb backend\fR\fR\fI = \fR\fIsmbpasswd\fR\fI \fR
.RE

passdb expand explicit (G)
.PP
.RS 4
This parameter controls whether Samba substitutes %\-macros in the passdb fields if they are explicitly set\. We used to expand macros here, but this turned out to be a bug because the Windows client can expand a variable %G_osver% in which %G would have been substituted by the user\'s primary group\.
.sp
Default:
\fI\fIpassdb expand explicit\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

passwd chat (G)
.PP
.RS 4
This string controls the
\fI"chat"\fR
conversation that takes places between
\fBsmbd\fR(8)
and the local password changing program to change the user\'s password\. The string describes a sequence of response\-receive pairs that
\fBsmbd\fR(8)
uses to determine what to send to the
\fIpasswd program\fR
and what to expect back\. If the expected output is not received then the password is not changed\.
.sp
This chat sequence is often quite site specific, depending on what local methods are used for password control (such as NIS etc)\.
.sp
Note that this parameter only is used if the
\fIunix password sync\fR
parameter is set to
\fByes\fR\. This sequence is then called
\fIAS ROOT\fR
when the SMB password in the smbpasswd file is being changed, without access to the old password cleartext\. This means that root must be able to reset the user\'s password without knowing the text of the previous password\. In the presence of NIS/YP, this means that the
\fIpasswd program\fR
must be executed on the NIS master\.
.sp
The string can contain the macro
\fI%n\fR
which is substituted for the new password\. The old passsword (\fI%o\fR) is only available when
\fIencrypt passwords\fR
has been disabled\. The chat sequence can also contain the standard macros \en, \er, \et and \es to give line\-feed, carriage\-return, tab and space\. The chat sequence string can also contain a \'*\' which matches any sequence of characters\. Double quotes can be used to collect strings with spaces in them into a single string\.
.sp
If the send string in any part of the chat sequence is a full stop "\.", then no string is sent\. Similarly, if the expect string is a full stop then no string is expected\.
.sp
If the
\fIpam password change\fR
parameter is set to
\fByes\fR, the chat pairs may be matched in any order, and success is determined by the PAM result, not any particular output\. The \en macro is ignored for PAM conversions\.
.sp
Default:
\fI\fIpasswd chat\fR\fR\fI = \fR\fI*new*password* %n\en*new*password* %n\en *changed*\fR\fI \fR
.sp
Example:
\fI\fIpasswd chat\fR\fR\fI = \fR\fI"*Enter NEW password*" %n\en "*Reenter NEW password*" %n\en "*Password changed*"\fR\fI \fR
.RE

passwd chat debug (G)
.PP
.RS 4
This boolean specifies if the passwd chat script parameter is run in
\fIdebug\fR
mode\. In this mode the strings passed to and received from the passwd chat are printed in the
\fBsmbd\fR(8)
log with a
\fIdebug level\fR
of 100\. This is a dangerous option as it will allow plaintext passwords to be seen in the
smbd
log\. It is available to help Samba admins debug their
\fIpasswd chat\fR
scripts when calling the
\fIpasswd program\fR
and should be turned off after this has been done\. This option has no effect if the
\fIpam password change\fR
parameter is set\. This parameter is off by default\.
.sp
Default:
\fI\fIpasswd chat debug\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

passwd chat timeout (G)
.PP
.RS 4
This integer specifies the number of seconds smbd will wait for an initial answer from a passwd chat script being run\. Once the initial answer is received the subsequent answers must be received in one tenth of this time\. The default it two seconds\.
.sp
Default:
\fI\fIpasswd chat timeout\fR\fR\fI = \fR\fI2\fR\fI \fR
.RE

passwd program (G)
.PP
.RS 4
The name of a program that can be used to set UNIX user passwords\. Any occurrences of
\fI%u\fR
will be replaced with the user name\. The user name is checked for existence before calling the password changing program\.
.sp
Also note that many passwd programs insist in
\fIreasonable \fR
passwords, such as a minimum length, or the inclusion of mixed case chars and digits\. This can pose a problem as some clients (such as Windows for Workgroups) uppercase the password before sending it\.
.sp
\fINote\fR
that if the
\fIunix password sync\fR
parameter is set to
\fByes \fR
then this program is called
\fIAS ROOT\fR
before the SMB password in the smbpasswd file is changed\. If this UNIX password change fails, then
smbd
will fail to change the SMB password also (this is by design)\.
.sp
If the
\fIunix password sync\fR
parameter is set this parameter
\fIMUST USE ABSOLUTE PATHS\fR
for
\fIALL\fR
programs called, and must be examined for security implications\. Note that by default
\fIunix password sync\fR
is set to
\fBno\fR\.
.sp
Default:
\fI\fIpasswd program\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpasswd program\fR\fR\fI = \fR\fI/bin/passwd %u\fR\fI \fR
.RE

password level (G)
.PP
.RS 4
Some client/server combinations have difficulty with mixed\-case passwords\. One offending client is Windows for Workgroups, which for some reason forces passwords to upper case when using the LANMAN1 protocol, but leaves them alone when using COREPLUS! Another problem child is the Windows 95/98 family of operating systems\. These clients upper case clear text passwords even when NT LM 0\.12 selected by the protocol negotiation request/response\.
.sp
This parameter defines the maximum number of characters that may be upper case in passwords\.
.sp
For example, say the password given was "FRED"\. If
\fI password level\fR
is set to 1, the following combinations would be tried if "FRED" failed:
.sp
"Fred", "fred", "fRed", "frEd","freD"
.sp
If
\fIpassword level\fR
was set to 2, the following combinations would also be tried:
.sp
"FRed", "FrEd", "FreD", "fREd", "fReD", "frED", \.\.
.sp
And so on\.
.sp
The higher value this parameter is set to the more likely it is that a mixed case password will be matched against a single case password\. However, you should be aware that use of this parameter reduces security and increases the time taken to process a new connection\.
.sp
A value of zero will cause only two attempts to be made \- the password as is and the password in all\-lower case\.
.sp
This parameter is used only when using plain\-text passwords\. It is not at all used when encrypted passwords as in use (that is the default since samba\-3\.0\.0)\. Use this only when
\fIencrypt passwords = No\fR\.
.sp
Default:
\fI\fIpassword level\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIpassword level\fR\fR\fI = \fR\fI4\fR\fI \fR
.RE

password server (G)
.PP
.RS 4
By specifying the name of another SMB server or Active Directory domain controller with this option, and using
security = [ads|domain|server]
it is possible to get Samba to to do all its username/password validation using a specific remote server\.
.sp
This option sets the name or IP address of the password server to use\. New syntax has been added to support defining the port to use when connecting to the server the case of an ADS realm\. To define a port other than the default LDAP port of 389, add the port number using a colon after the name or IP address (e\.g\. 192\.168\.1\.100:389)\. If you do not specify a port, Samba will use the standard LDAP port of tcp/389\. Note that port numbers have no effect on password servers for Windows NT 4\.0 domains or netbios connections\.
.sp
If parameter is a name, it is looked up using the parameter
\fIname resolve order\fR
and so may resolved by any method and order described in that parameter\.
.sp
The password server must be a machine capable of using the "LM1\.2X002" or the "NT LM 0\.12" protocol, and it must be in user level security mode\.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
Using a password server means your UNIX box (running Samba) is only as secure as your password server\.
\fIDO NOT CHOOSE A PASSWORD SERVER THAT YOU DON\'T COMPLETELY TRUST\fR\.

Never point a Samba server at itself for password serving\. This will cause a loop and could lock up your Samba server!
.sp
The name of the password server takes the standard substitutions, but probably the only useful one is
\fI%m \fR, which means the Samba server will use the incoming client as the password server\. If you use this then you better trust your clients, and you had better restrict them with hosts allow!
.sp
If the
\fIsecurity\fR
parameter is set to
\fBdomain\fR
or
\fBads\fR, then the list of machines in this option must be a list of Primary or Backup Domain controllers for the Domain or the character \'*\', as the Samba server is effectively in that domain, and will use cryptographically authenticated RPC calls to authenticate the user logging on\. The advantage of using
security = domain
is that if you list several hosts in the
\fIpassword server\fR
option then
smbd
will try each in turn till it finds one that responds\. This is useful in case your primary server goes down\.
.sp
If the
\fIpassword server\fR
option is set to the character \'*\', then Samba will attempt to auto\-locate the Primary or Backup Domain controllers to authenticate against by doing a query for the name
\fBWORKGROUP<1C>\fR
and then contacting each server returned in the list of IP addresses from the name resolution source\.
.sp
If the list of servers contains both names/IP\'s and the \'*\' character, the list is treated as a list of preferred domain controllers, but an auto lookup of all remaining DC\'s will be added to the list as well\. Samba will not attempt to optimize this list by locating the closest DC\.
.sp
If the
\fIsecurity\fR
parameter is set to
\fBserver\fR, then there are different restrictions that
security = domain
doesn\'t suffer from:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
You may list several password servers in the
\fIpassword server\fR
parameter, however if an
smbd
makes a connection to a password server, and then the password server fails, no more users will be able to be authenticated from this
smbd\. This is a restriction of the SMB/CIFS protocol when in
security = server
mode and cannot be fixed in Samba\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
If you are using a Windows NT server as your password server then you will have to ensure that your users are able to login from the Samba server, as when in
security = server
mode the network logon will appear to come from there rather than from the users workstation\.
.sp
.RE
Default:
\fI\fIpassword server\fR\fR\fI = \fR\fI*\fR\fI \fR
.sp
Example:
\fI\fIpassword server\fR\fR\fI = \fR\fINT\-PDC, NT\-BDC1, NT\-BDC2, *\fR\fI \fR
.sp
Example:
\fI\fIpassword server\fR\fR\fI = \fR\fIwindc\.mydomain\.com:389 192\.168\.1\.101 *\fR\fI \fR
.RE

directory
.PP
.RS 4
This parameter is a synonym for
path\.
.RE

path (S)
.PP
.RS 4
このパラメータは、サービスに接続したユーザがアクセスするディレクトリを指定する。印刷サービスの場合、これは印刷データがホストの印刷機構に送られる前にスプールされる場所になる。
.sp
ゲストアクセスを許可している印刷サービスの場合、サービスは読みとりのみにした上で、パスは全ユーザ書き込み可能として sticky ビットをセットすべきである。これはもちろん必須ではないが、このようにしない限りは、おそらく意図した設定を行なうことができないだろう。
.sp
\fI%u\fR
は、クライアントが接続する際に使用した UNIX のユーザ名に置換される。\fI%m\fR
は、接続してきたマシンの NetBIOS 名に置換される。これらの置換機能は、ユーザに仮想的なホームディレクトリを設定する際非常に有用である。
.sp
\fIroot dir\fR
が指定されていた場合、このパラメータもその影響を受けることに注意。
.sp
Default:
\fI\fIpath\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpath\fR\fR\fI = \fR\fI/home/fred\fR\fI \fR
.RE

pid directory (G)
.PP
.RS 4
このオプションにより、 pid ファイルがおかれるディレクトリが指定される。
.sp
Default:
\fI\fIpid directory\fR\fR\fI = \fR\fI${prefix}/var/locks\fR\fI \fR
.sp
Example:
\fI\fIpid directory\fR\fR\fI = \fR\fIpid directory = /var/run/\fR\fI \fR
.RE

posix locking (S)
.PP
.RS 4
\fBsmbd\fR(8)
デーモンでは、 SMB クライアントによって行なわれたファイルロックの情報を記録するデータベースを管理している。 デフォルトでは、データベースの内部処理として POSIX ロックへの置換えが行なわれている。 これにより、SMB クライアントによって行なわれたファイルロックは、 POSIX 互換のアプリケーションが SMB 以外の方式(NFS やローカルなファイルアクセス) を用いて、ファイルにアクセスする際にも認識されることになる。 このパラメータを無効にする必要はまずないであろう。
.sp
Default:
\fI\fIposix locking\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

postexec (S)
.PP
.RS 4
このオプションは、 サービスから切断した際に常に起動されるコマンドを指定する。 このパラメータでは通常の Samba の変数も利用できる。 システムによってはコマンドが root で実行される場合もあるかも知れない。
.sp
面白い例としては、サーバのリソースを umount するような用途が考えられる:
.sp
postexec = /etc/umount /cdrom
.sp
Default:
\fI\fIpostexec\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpostexec\fR\fR\fI = \fR\fIecho \e"%u disconnected from %S from %m (%I)\e" >> /tmp/log\fR\fI \fR
.RE

exec
.PP
.RS 4
This parameter is a synonym for
preexec\.
.RE

preexec (S)
.PP
.RS 4
このオプションは、サービスへ接続した際に必ず実行されるコマンドを指定する。 このパラメータでは通常のSambaの変数も利用できる。
.sp
面白い例としては、接続する度に、 ユーザに歓迎(welcome)メッセージを送るような用途が考えられる。 その日の一言 (message of the day) も面白いかも知れない。以下に例を示す:
.sp

preexec = csh \-c \'echo \e"Welcome to %S!\e" | /usr/local/samba/bin/smbclient \-M %m \-I %I\' &
.sp
無論、しばらく経つとこれはイライラのもとになるだけだろう :\-)。
.sp

\fIpreexec close\fR
や
\fIpostexec\fR
も参照のこと。
.sp
Default:
\fI\fIpreexec\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpreexec\fR\fR\fI = \fR\fIecho \e"%u connected to %S from %m (%I)\e" >> /tmp/log\fR\fI \fR
.RE

preexec close (S)
.PP
.RS 4
この真偽値オプションは、\fIpreexec\fR
で指定したコマンドから 0 以外の戻り値が返却された際に、 サービスへの接続をクローズするかどうかを制御する。
.sp
Default:
\fI\fIpreexec close\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

prefered master
.PP
.RS 4
This parameter is a synonym for
preferred master\.
.RE

preferred master (G)
.PP
.RS 4
この真偽値パラメータは、
\fBnmbd\fR(8)
が ワークグループのマスタブラウザとして優先されるかどうかに影響する。
.sp
これが
\fByes\fR
に設定されていると、
nmbd
は起動時にブラウザの選定を強要する。 また、選定時の優先度でも、わずかではあるが有利になる。 このパラメータは、nmbd
がドメインマスタブラウザになることを保証するために、
\fIdomain master = yes\fR
の設定と連携して使用することが推奨されている。 (訳注: Samba 3\.0 系列では、\fIdomain logons = Yes\fRの場合
\fIpreferred master\fR
パラメータもデフォルトでは有効となる。\fIdomain logons\fR
が有効でない場合(デフォルト)、\fIdomain master\fR
もデフォルトでは有効にならない。
.sp
同じサブネット上に優先マスタブラウザに指定されたホスト(Samba サーバ、Windows 95/NT のいずれの場合も)が複数台存在すると、 それらのホストは定期的にローカルマスタブラウザになろうとする 試みを永続的に繰り返すことになる。 これは不要なブロードキャストトラフィックを発生させるだけでなく、 ブラウジング機能自体にも支障を発生させてしまうため、このオプションは注意して扱うこと。
.sp
Default:
\fI\fIpreferred master\fR\fR\fI = \fR\fIauto\fR\fI \fR
.RE

auto services
.PP
.RS 4
This parameter is a synonym for
preload\.
.RE

preload (G)
.PP
.RS 4
このパラメータは、 自動的にブラウズリスト上に追加したいサービスのリストを設定する。 このパラメータを利用しないと不可視になる homes や printers サービスにとって有用である。
.sp
printcap ファイルにあるすべてのプリンタを指定したい場合は、
\fIload printers\fR
オプションを利用する方が簡単である。
.sp
Default:
\fI\fIpreload\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpreload\fR\fR\fI = \fR\fIfred lp colorlp\fR\fI \fR
.RE

preload modules (G)
.PP
.RS 4
This is a list of paths to modules that should be loaded into smbd before a client connects\. This improves the speed of smbd when reacting to new connections somewhat\.
.sp
Default:
\fI\fIpreload modules\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIpreload modules\fR\fR\fI = \fR\fI/usr/lib/samba/passdb/mysql\.so\fR\fI \fR
.RE

preserve case (S)
.PP
.RS 4
クライアントから送信されてきた新しいファイル名中の大文字小文字をそのまま利用するか、
\fIdefault case\fR
パラメータの設定を強制するかどうかを設定する。
.sp
この設定に関する詳細については、
名前の短縮
セクションを参照のこと。
.sp
Default:
\fI\fIpreserve case\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

print ok
.PP
.RS 4
This parameter is a synonym for
printable\.
.RE

printable (S)
.PP
.RS 4
このパラメータが
\fByes\fR
の場合に、 クライアントから指定されたディレクトリにスプールファイルを書き込むことが可能になる。
.sp
印刷可能(printable)なサービスでは、 (ユーザがUNIX上に権限をもっている限り)印刷データをスプールファイルに書き込むことが常に可能となることに注意。
\fIread only\fR
パラメータは、 リソースに対する印刷以外のアクセスにのみ影響する。
.sp
Default:
\fI\fIprintable\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

printcap cache time (G)
.PP
.RS 4
このオプションにより、印刷サブシステムがプリンタの一覧情報を再確認するまでの時間を秒単位で制御することが可能となる。 この値が 60 より大きい場合、 初回の再確認時間は 60 秒に設定される。 これは、印刷サブシステムが初回の再確認を早期に実行するためである。
.sp
このパラメータを 0 (デフォルト値) にすると、 起動後に新しいプリンタや削除されたプリンタを再確認する機能が無効化される。
.sp
Default:
\fI\fIprintcap cache time\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIprintcap cache time\fR\fR\fI = \fR\fI600\fR\fI \fR
.RE

printcap
.PP
.RS 4
This parameter is a synonym for
printcap name\.
.RE

printcap name (S)
.PP
.RS 4
このパラメータは、 コンパイル時に設定されるデフォルトでサーバが用いる printcap ファイル名 (通常
\fI/etc/printcap\fR) を上書きにするために使われる。 このパラメータを設定すべき状況については、前述した
[printers]
セクションに関する説明を参照のこと。
.sp
CUPS 印刷インタフェースを利用する際は、printcap name = cups
という設定を行なうこと。これにより [global] セクションの
\fIprinting = cups\fR
パラメータにより補完される。
printcap name = cups
により、 CUPS の設定ファイルによって指定された、 CUPS によって作成される「ダミー」の printcap が用いられるようになる。
.sp

lpstat
を利用することで 利用可能なプリンタの一覧を取得できる System V のシステムでは、
printcap name = lpstat
と設定することで、利用可能なプリンタの一覧を自動的に取得できる。 (ほとんどの System V ベースのシステムが該当する)では、これがデフォルトである。 これらのシステムで
\fIprintcap name\fR
に
lpstat
が設定されると、 Samba は
lpstat \-v
を実行し、その出力からプリンタ一覧を取得する。
.sp
最低限の printcap ファイルは下記のようなものである:
.sp
.RS 4
.nf
print1|My Printer 1
print2|My Printer 2
print3|My Printer 3
print4|My Printer 4
print5|My Printer 5
.fi
.RE
.sp
\'|\' によって、プリンタの別名が区切られる。 ただし、2 番目の別名中に空白があると、 Samba はそれをプリンタのコメントであると判断する。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
AIXにおけるデフォルトの printcap ファイルの名前は、
\fI/etc/qconfig\fRである。printcap ファイルの名前が
\fIqconfig\fR
の場合、Samba はファイルが AIXの
\fIqconfig\fR形式であると仮定する。

Default:
\fI\fIprintcap name\fR\fR\fI = \fR\fI/etc/printcap\fR\fI \fR
.sp
Example:
\fI\fIprintcap name\fR\fR\fI = \fR\fI/etc/myprintcap\fR\fI \fR
.RE

print command (S)
.PP
.RS 4
印刷ジョブが、スプールファイルの書き込みを完了した後で、 ここで指定したコマンドが
system()
関数経由でスプールファイルを処理するために、利用される。 通常、指定したコマンドはスプールファイルをホストの印刷サブシステムに送信するが、 そうしなければならないということはない。 サーバはスプールファイルを削除しないので、 指定したコマンドが処理完了後にスプールファイルを削除しなければならない。 さもなければ、古いスプールファイルを手動で削除する必要がある。
.sp
print command は、単純なテキスト文字列である。 これは、以下のマクロが置換される他はそのまま利用される。
.sp
%s, %f \- スプールファイル名へのパス
.sp
%p \- プリンタ名
.sp
%J \- the job クライアントから送信されたジョブ名
.sp
%c \- スプールされたジョブのうち、 すでに印刷されたページ数(検知可能な場合)
.sp
%z \- スプールされた印刷ジョブのサイズ (バイト)
.sp
print command には、\fI最低限\fR
\fI%s\fR
もしくは
\fI%f\fR
の記述が必要である。
\fI%p\fR
については必須ではない。 ジョブの実行時にプリンタ名が指定されていない場合、
\fI%p\fR
は単に print command から無視される。
.sp
[global] セクション中で指定された print command は、 独自の print command が設定されていない各印刷サービスに適用される。
.sp
印刷サービスに print command の定義がなく、 グローバルな print command の定義もない場合、 スプールファイルは作成されるが処理されず、(これが最も重要だが)削除されない。
.sp
UNIX プラットフォームによっては
\fBnobody\fR
アカウントを用いた印刷が失敗する場合があるので注意して欲しい。 この場合、印刷の実行が可能な別のゲストアカウントを作成し、 [global] セクション中の
\fIguest account\fR
に設定すること。
.sp
シェルで解析できる限りの非常に複雑な print command を記述することが可能である。 以下の例では印刷ジョブを記録し、ファイルを印刷してからそれを削除している。 \';\' はシェルスクリプトにおいて、 通常コマンド間のセパレータとして用いられることに注意。
.sp
print command = echo Printing %s >> /tmp/print\.log; lpr \-P %p %s; rm %s
.sp
システムでファイルを印刷する一般的な方法によっては、 このコマンドを適宜変更する必要があるかもしれない。 パラメータのデフォルト値は、\fIprinting\fR
パラメータの設定に応じて変化する。
.sp
デフォルト:
printing = BSD, AIX, QNX, LPRNG, PLPの場合:
.sp
print command = lpr \-r \-P%p %s
.sp
printing = SYSV, HPUXの場合:
.sp
print command = lp \-c \-d%p %s; rm %s
.sp
printing = SOFTQの場合:
.sp
print command = lp \-d%p \-s %s; rm %s
.sp
printing = CUPS の場合: Samba が libcups を利用してコンパイルされた場合、
\fIprintcap = cups\fR
は、ジョブの送信などに CUPS API を利用する。 それ以外の場合は、lp \-c \-d%p \-oraw; rm %s
のように、 System V 系の印刷用コマンドに \-oraw オプションをつけたものに対応づけられる。 Samba が libcups を利用してコンパイルされ、
printing = cups
の設定が行なわれた場合、 手動で設定された print コマンドは無視される。
.sp
\fINo default\fR
.sp
Example:
\fI\fIprint command\fR\fR\fI = \fR\fI/usr/local/samba/bin/myprintscript %p %s\fR\fI \fR
.RE

printer admin (S)
.PP
.RS 4
This lists users who can do anything to printers via the remote administration interfaces offered by MS\-RPC (usually using a NT workstation)\. This parameter can be set per\-share or globally\. Note: The root user always has admin rights\. Use caution with use in the global stanza as this can cause side effects\.
.sp
This parameter has been marked deprecated in favor of using the SePrintOperatorPrivilege and individual print security descriptors\. It will be removed in a future release\.
.sp
Default:
\fI\fIprinter admin\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIprinter admin\fR\fR\fI = \fR\fIadmin, @staff\fR\fI \fR
.RE

printer
.PP
.RS 4
This parameter is a synonym for
printer name\.
.RE

printer name (S)
.PP
.RS 4
このパラメータは、印刷サービスに対して印刷ジョブが送られた際に、 それをスプールするプリンタ名を設定する。
.sp
[global] セクションで設定された場合、 そのプリンタ名は、独自のプリンタ名が指定されていないすべての 印刷サービスで利用される。
.sp

\fIprinter name\fR
のデフォルト値は 、 大半のシステムで
lp
である。
.sp
Default:
\fI\fIprinter name\fR\fR\fI = \fR\fIなし\fR\fI \fR
.sp
Example:
\fI\fIprinter name\fR\fR\fI = \fR\fIlaserwriter\fR\fI \fR
.RE

printing (S)
.PP
.RS 4
このパラメータは、プリンタの状態に関する情報をどのように解釈するかを設定する。 更に、[global] セクションで指定された場合は、
\fIprint command\fR、
\fIlpq command\fR、\fIlppause command \fR、\fIlpresume command\fR、
\fIlprm command\fR
のデフォルト値にも影響する。
.sp
現在、
\fBBSD\fR、\fBAIX\fR、
\fBLPRNG\fR、\fBPLP\fR、
\fBSYSV\fR、\fBHPUX\fR、
\fBQNX\fR、\fBSOFTQ\fR、
\fBCUPS\fR
の9つの印刷形式がサポートされている。
.sp
このオプションを設定した際に、 関連する印刷コマンドのデフォルトがどのように設定されるかを確認する際は、
\fBtestparm\fR(1)
プログラムを使用すること。
.sp
このオプションはプリンタ毎に設定することが可能である。 各種の印刷に関するコマンド (print command や lpq command など) で デフォルトの設定を上書きさせる場合は、
\fIprinting\fR
パラメータの設定後に指定する必要があることに注意。
.sp
[printers]
セクションでの説明も参照のこと。
.sp
\fINo default\fR
.RE

printjob username (S)
.PP
.RS 4
This parameter specifies which user information will be passed to the printing system\. Usually, the username is sent, but in some cases, e\.g\. the domain prefix is useful, too\.
.sp
Default:
\fI\fIprintjob username\fR\fR\fI = \fR\fI%U\fR\fI \fR
.sp
Example:
\fI\fIprintjob username\fR\fR\fI = \fR\fI%D\e%U\fR\fI \fR
.RE

private dir (G)
.PP
.RS 4
This parameters defines the directory smbd will use for storing such files as
\fIsmbpasswd\fR
and
\fIsecrets\.tdb\fR\.
.sp
Default:
\fI\fIprivate dir\fR\fR\fI = \fR\fI${prefix}/private\fR\fI \fR
.RE

profile acls (S)
.PP
.RS 4
この真偽値パラメータは、Windows 2000 もしくは Windows XP 用のユーザプロファイルを Samba サーバ上の共有に格納する際に発生する問題に対処するため作成された。 Windows 2000 や Windows XP の新しいサービスパック(訳注: 各々 SP4 と SP1) では、セキュリティの ACL チェックが行なわれるようになり、ローカルのワークステーション上に格納されているプロファイルのコピーを Samba 上の共有にコピーする際に、プロファイルのディレクトリの所有者と書き込み権をチェックするようになった。
.sp
winbindd を用いたドメインモードで運用していない場合、ローカルワークステーション上に複製された、ワークステーションにログオン中ユーザのセキュリティ情報 (SID) は無意味なため、結果としてプロファイルの格納に失敗する。 このパラメータをプロファイルの格納に使用する共有で有効にすることにより、クライアントに返却される Windows の ACL について、以下の 2 点が変更となる。 まず、すべてのファイルおよびディレクトリの所有者とグループの所有者が、各々 BUILTIN\eAdministrators および BUILTIN\eUsers となる (SID は各々 S\-1\-5\-32\-544 と S\-1\-5\-32\-545)。 次に、返却されるすべての ACL に対して BUILTIN\eUsers にフルコントロールの ACE が付加される。 これにより、Windows 2000 および Windows XP のワークステーションのユーザがプロファイルにアクセスできるようになる。
.sp
ワークステーションに複数のユーザがログオンする環境の場合、別ユーザのプロファイルへのアクセスを禁止するためには、「捜査チェックのバイパス」権利を削除する必要がある。 プロファイルディレクトリのトップ(ユーザ名を含む名称となっている)がワークステーション上で作成される際、所有するユーザ以外のアクセスを禁止するような ACL が設定されるため、この設定により、別のユーザのプロファイルディレクトリへのアクセスを禁止することができる。
.sp
Default:
\fI\fIprofile acls\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

queuepause command (S)
.PP
.RS 4
このパラメータは、印刷キューを一時停止させるために、 サーバ上で実行するコマンドを指定する。
.sp
このコマンドは、引数としてプリンタ名をとり、 印刷キューにある印刷ジョブの送信を停止させるために印刷キューを停止させる機能を持つ プログラムまたはスクリプトである必要がある。
.sp
Windows 95 や Windows NTでは、 「プリンタ」ウインドウからこのコマンドを発行することができるが、 Windows for Workgroups ではこのコマンドがサポートされていない。
.sp
コマンド中に
\fI%p\fR
が指定された場合は、プリンタ名がそこに引数として置かれる。 それ以外の場合、プリンタ名はコマンド文字列の最後におかれる。
.sp
サーバ上で PATH 環境変数が設定されていない場合を想定して、 コマンドをフルパスで記述することが推奨される。
.sp
\fINo default\fR
.sp
Example:
\fI\fIqueuepause command\fR\fR\fI = \fR\fIdisable %p\fR\fI \fR
.RE

queueresume command (S)
.PP
.RS 4
このパラメータは、印刷キューを再開させるために、 サーバ上で実行するコマンドを指定する。 これは、前述したパラメータ (\fIqueuepause command\fR) によって一時停止された動作を再開させるコマンドになる。
.sp
このコマンドは、引数としてプリンタ名をとり、 印刷キューにある印刷ジョブを再度プリンタへ送信させるために印刷キューを再開する機能を持つ プログラムまたはスクリプトである必要がある。
.sp
Windows 95 や Windows NTでは、 「プリンタ」ウインドウからこのコマンドを発行することができるが、 Windows for Workgroups ではこのコマンドがサポートされていない。
.sp
コマンド中に
\fI%p\fR
が指定された場合は、プリンタ名がそこに引数として置かれる。 それ以外の場合、プリンタ名はコマンド文字列の最後におかれる。
.sp
サーバ上で PATH 環境変数が設定されていない場合を想定して、 コマンドをフルパスで記述することが推奨される。
.sp
Default:
\fI\fIqueueresume command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIqueueresume command\fR\fR\fI = \fR\fIenable %p\fR\fI \fR
.RE

read bmpx (G)
.PP
.RS 4
この真偽値パラメータは、
\fBsmbd \fR(8)
に 「Read Block Multiplex」 SMB をサポートさせるかどうかを制御する。 これは、まず使われることがないため、デフォルトは
\fBno\fR
になっている。 このパラメータを設定する必要はまずないであろう。
.sp
Default:
\fI\fIread bmpx\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

read list (S)
.PP
.RS 4
This is a list of users that are given read\-only access to a service\. If the connecting user is in this list then they will not be given write access, no matter what the
\fIread only\fR
option is set to\. The list can include group names using the syntax described in the
\fIinvalid users\fR
parameter\.
.sp
This parameter will not work with the
\fIsecurity = share\fR
in Samba 3\.0\. This is by design\.
.sp
Default:
\fI\fIread list\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIread list\fR\fR\fI = \fR\fImary, @students\fR\fI \fR
.RE

read only (S)
.PP
.RS 4
An inverted synonym is
\fIwriteable\fR\.
.sp
If this parameter is
\fByes\fR, then users of a service may not create or modify files in the service\'s directory\.
.sp
Note that a printable service (printable = yes) will
\fIALWAYS\fR
allow writing to the directory (user privileges permitting), but only via spooling operations\.
.sp
Default:
\fI\fIread only\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

read raw (G)
.PP
.RS 4
このパラメータは、データをクライアントに転送する際に、 サーバ側で raw read SMB リクエストをサポートするかどうかを設定する。
.sp
有効な場合、 raw read SMB により、1パケットあたり 65535 バイトの読み込みが可能となる。 これは性能の向上に大きく貢献する。
.sp
ただし、クライアントによっては、ブロックサイズを誤認識したり、 大きなブロックサイズを利用できなかったりするので、その場合は、 raw read を無効にする必要があるだろう。
.sp
このパラメータは、システムのチューニングパラメータであり、 通常は設定を変更すべきものではない。
.sp
Default:
\fI\fIread raw\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

realm (G)
.PP
.RS 4
このオプションは、使用する Kerberos レルムを指定する。 レルムは Windows NT 4\.0 におけるドメインに相当する Active Directory の概念である。 レルムには、通常 Kerberos サーバの DNS 名が設定される。
.sp
Default:
\fI\fIrealm\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIrealm\fR\fR\fI = \fR\fImysambabox\.mycompany\.com\fR\fI \fR
.RE

registry shares (G)
.PP
.RS 4
レジストリから参照される共有定義のサポートのオンオフを切り替える。
\fIsmb\.conf\fR
で定義された共有は、レジストリ内に同じ名前で 定義されたものより優先する。詳細はレジストリベースの設定の章を参照してほしい。
.sp
注意：このパラメータはデフォルトでは
\fIno\fR
であるが、
\fIconfig backend\fR
が
\fIregistry\fR
にセットされている場合は\fIyes\fR
となる。
.sp
Default:
\fI\fIregistry shares\fR\fR\fI = \fR\fIno\fR\fI \fR
.sp
Example:
\fI\fIregistry shares\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

remote announce (G)
.PP
.RS 4
このオプションにより、
\fBnmbd\fR(8)
は、指定したIPアドレスに対して設定したワークグループ情報を定期的にアナウンスするようになる。
.sp
これは、Samba サーバを通常のブラウズリストの交換ができない別のワークグループ上に表示させたい場合に有用である。 別のワークグループは、IP パケットを送信できるところであればどこにあってもよい。
.sp
以下に例を示す:
.sp
.RS 4
.nf
remote announce = 192\.168\.2\.255/SERVERS 192\.168\.4\.255/STAFF
.fi
.RE
.sp
上記の設定は、nmbd
が指定された2つのアドレスに対して、 指定されたワークグループ名を使って自身のアナウンスを行なう設定である。 ワークグループ名を指定しなかった場合、
\fIworkgroup\fR
パラメータで指定された値が代わりに利用される。
.sp
設定するIPアドレスとしては、 通常リモートネットワークのブロードキャストが用いられるが、 ネットワークが安定していれば、マスタブラウザのIPアドレスを指定することもできる。
.sp
Samba HOWTO の Network Browsing 章を参照のこと。
.sp
Default:
\fI\fIremote announce\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

remote browse sync (G)
.PP
.RS 4
このオプションにより、
\fBnmbd\fR(8)
が、 別セグメントにある Samba サーバのマスタブラウザと定期的にブラウズリストの同期要求を行なうように構成される。 このオプションにより、 ルーティングされたネットワーク上に存在する複数ワークグループからなるブラウズリストを構築することが可能になる。 これは Samba 固有の方式で動作するため、 Samba 以外のサーバでは機能しない。
.sp
これは、Samba サーバおよび同じセグメント上のクライアントマシンを、 通常のブラウズリストの交換ができない別のワークグループ上に表示させたい場合に有用である。 別のワークグループは、IP パケットを送信できるところであればどこにあってもよい。
.sp
以下に例を示す:
.sp
.RS 4
.nf
\fIremote browse sync = 192\.168\.2\.255 192\.168\.4\.255\fR
.fi
.RE
.sp
上記の設定は、nmbdが指定されたサブネットのマスタブラウザに対して、 ローカルサーバとのブラウズリストの同期を要求する設定である。
.sp
設定するIPアドレスとしては、 通常リモートネットワークのブロードキャストが用いられるが、 ネットワークが安定していればマスタブラウザのIPアドレスを指定することもできる。 IPアドレスが設定された場合、Sambaはそのマシンが起動していて、 要求を待っているかについても、そのセグメントのマスタブラウザであるかどうかについても確認しない。
.sp

\fIremote browse sync\fR
は、 WINS サーバが存在しない場合も、 ネットワーク毎に異なる WINS サーバを指定している場合にも用いることができる。
.sp
Default:
\fI\fIremote browse sync\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

rename user script (G)
.PP
.RS 4
This is the full pathname to a script that will be run as root by
\fBsmbd\fR(8)
under special circumstances described below\.
.sp
When a user with admin authority or SeAddUserPrivilege rights renames a user (e\.g\.: from the NT4 User Manager for Domains), this script will be run to rename the POSIX user\. Two variables,
%uold
and
%unew, will be substituted with the old and new usernames, respectively\. The script should return 0 upon successful completion, and nonzero otherwise\.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
The script has all responsibility to rename all the necessary data that is accessible in this posix method\. This can mean different requirements for different backends\. The tdbsam and smbpasswd backends will take care of the contents of their respective files, so the script is responsible only for changing the POSIX username, and other data that may required for your circumstances, such as home directory\. Please also consider whether or not you need to rename the actual home directories themselves\. The ldapsam backend will not make any changes, because of the potential issues with renaming the LDAP naming attribute\. In this case the script is responsible for changing the attribute that samba uses (uid) for locating users, as well as any data that needs to change for other applications using the same directory\.

Default:
\fI\fIrename user script\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

reset on zero vc (G)
.PP
.RS 4
この真偽値オプションは、到着したセッションセットアップが、 同一の IP アドレスからの別のセッションを切断するかを制御する。 これは Windows Server 2003 のデフォルトの挙動である。 ネットワークが不安定で、 Windows が、古い接続がファイルを共有モードでオープンしているにも関わらず、再接続を試行してしまうような環境では、このパラメータを yes にする必要があるだろう。 これらのファイルは、新しい接続経由ではアクセスできなくなるが、 クライアントが新しい接続中で 0 VC を送信すると、Windows Server 2003 は同一の IP が送信元のすべての他の接続を切断する。 これにより、ロックされたファイルが再度アクセスできるようになる。 このオプションを有効にすると、ルータで同一 IP アドレスに隠蔽されている接続も切断されてしまうことに注意。
.sp
Default:
\fI\fIreset on zero vc\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

restrict anonymous (G)
.PP
.RS 4
The setting of this parameter determines whether user and group list information is returned for an anonymous connection\. and mirrors the effects of the
.sp
.RS 4
.nf
HKEY_LOCAL_MACHINE\eSYSTEM\eCurrentControlSet\e
           Control\eLSA\eRestrictAnonymous
.fi
.RE
.sp
registry key in Windows 2000 and Windows NT\. When set to 0, user and group list information is returned to anyone who asks\. When set to 1, only an authenticated user can retrive user and group list information\. For the value 2, supported by Windows 2000/XP and Samba, no anonymous connections are allowed at all\. This can break third party and Microsoft applications which expect to be allowed to perform operations anonymously\.
.sp
The security advantage of using restrict anonymous = 1 is dubious, as user and group list information can be obtained using other means\.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
The security advantage of using restrict anonymous = 2 is removed by setting
\fIguest ok = yes\fR
on any share\.

Default:
\fI\fIrestrict anonymous\fR\fR\fI = \fR\fI0\fR\fI \fR
.RE

root
.PP
.RS 4
This parameter is a synonym for
root directory\.
.RE

root dir
.PP
.RS 4
This parameter is a synonym for
root directory\.
.RE

root directory (G)
.PP
.RS 4
The server will
chroot()
(i\.e\. Change its root directory) to this directory on startup\. This is not strictly necessary for secure operation\. Even without it the server will deny access to files not in one of the service entries\. It may also check for, and deny access to, soft links to other parts of the filesystem, or attempts to use "\.\." in file names to access other directories (depending on the setting of the
\fIwide smbconfoptions\fR
parameter)\.
.sp
Adding a
\fIroot directory\fR
entry other than "/" adds an extra level of security, but at a price\. It absolutely ensures that no access is given to files not in the sub\-tree specified in the
\fIroot directory\fR
option,
\fIincluding\fR
some files needed for complete operation of the server\. To maintain full operability of the server you will need to mirror some system files into the
\fIroot directory\fR
tree\. In particular you will need to mirror
\fI/etc/passwd\fR
(or a subset of it), and any binaries or configuration files needed for printing (if required)\. The set of files that must be mirrored is operating system dependent\.
.sp
Default:
\fI\fIroot directory\fR\fR\fI = \fR\fI/\fR\fI \fR
.sp
Example:
\fI\fIroot directory\fR\fR\fI = \fR\fI/homes/smb\fR\fI \fR
.RE

root postexec (S)
.PP
.RS 4
このパラメータは、 コマンドが root で実行されることを除き、
\fIpostexec\fR
パラメータと同一である。 このコマンドは、コネクションの切断後に(CD\-ROMなどの)ファイルシステムをアンマウントするのに便利である。
.sp
Default:
\fI\fIroot postexec\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

root preexec (S)
.PP
.RS 4
このパラメータは、 コマンドが root で実行されることを除き、
\fIpreexec \fR
パラメータと同一である。 このコマンドは、コネクションの開始時に(CD\-ROMなどの)ファイルシステムをマウントするのに便利である。
.sp
Default:
\fI\fIroot preexec\fR\fR\fI = \fR\fI\fR\fI \fR
.RE

root preexec close (S)
.PP
.RS 4
このパラメータは、 コマンドが root で実行されることを除き、
\fIpreexec close \fR
パラメータと同一である。
.sp
Default:
\fI\fIroot preexec close\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

security (G)
.PP
.RS 4
This option affects how clients respond to Samba and is one of the most important settings in the
\fI smb\.conf\fR
file\.
.sp
The option sets the "security mode bit" in replies to protocol negotiations with
\fBsmbd\fR(8)
to turn share level security on or off\. Clients decide based on this bit whether (and how) to transfer user and password information to the server\.
.sp
The default is
security = user, as this is the most common setting needed when talking to Windows 98 and Windows NT\.
.sp
The alternatives are
security = share,
security = server
or
security = domain\.
.sp
In versions of Samba prior to 2\.0\.0, the default was
security = share
mainly because that was the only option at one stage\.
.sp
There is a bug in WfWg that has relevance to this setting\. When in user or server level security a WfWg client will totally ignore the username and password you type in the "connect drive" dialog box\. This makes it very difficult (if not impossible) to connect to a Samba service as anyone except the user that you are logged into WfWg as\.
.sp
If your PCs use usernames that are the same as their usernames on the UNIX machine then you will want to use
security = user\. If you mostly use usernames that don\'t exist on the UNIX box then use
security = share\.
.sp
You should also use
security = share
if you want to mainly setup shares without a password (guest shares)\. This is commonly used for a shared printer server\. It is more difficult to setup guest shares with
security = user, see the
\fImap to guest\fRparameter for details\.
.sp
It is possible to use
smbd
in a
\fI hybrid mode\fR
where it is offers both user and share level security under different
\fINetBIOS aliases\fR\.
.sp
The different settings will now be explained\.
.sp
\fISECURITY = SHARE\fR
.sp
When clients connect to a share level security server they need not log onto the server with a valid username and password before attempting to connect to a shared resource (although modern clients such as Windows 95/98 and Windows NT will send a logon request with a username but no password when talking to a
security = share
server)\. Instead, the clients send authentication information (passwords) on a per\-share basis, at the time they attempt to connect to that share\.
.sp
Note that
smbd
\fIALWAYS\fR
uses a valid UNIX user to act on behalf of the client, even in
security = share
level security\.
.sp
As clients are not required to send a username to the server in share level security,
smbd
uses several techniques to determine the correct UNIX user to use on behalf of the client\.
.sp
A list of possible UNIX usernames to match with the given client password is constructed using the following methods :
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
If the
\fIguest only\fR
parameter is set, then all the other stages are missed and only the
\fIguest account\fR
username is checked\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Is a username is sent with the share connection request, then this username (after mapping \- see
\fIusername map\fR), is added as a potential username\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
If the client did a previous
\fIlogon \fR
request (the SessionSetup SMB call) then the username sent in this SMB will be added as a potential username\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
The name of the service the client requested is added as a potential username\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
The NetBIOS name of the client is added to the list as a potential username\.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Any users on the
\fIuser\fR
list are added as potential usernames\.
.sp
.RE
If the
\fIguest only\fR
parameter is not set, then this list is then tried with the supplied password\. The first user for whom the password matches will be used as the UNIX user\.
.sp
If the
\fIguest only\fR
parameter is set, or no username can be determined then if the share is marked as available to the
\fIguest account\fR, then this guest user will be used, otherwise access is denied\.
.sp
Note that it can be
\fIvery\fR
confusing in share\-level security as to which UNIX username will eventually be used in granting access\.
.sp
See also the section
NOTE ABOUT USERNAME/PASSWORD VALIDATION\.
.sp
\fISECURITY = USER\fR
.sp
This is the default security setting in Samba 3\.0\. With user\-level security a client must first "log\-on" with a valid username and password (which can be mapped using the
\fIusername map\fR
parameter)\. Encrypted passwords (see the
\fIencrypted passwords\fR
parameter) can also be used in this security mode\. Parameters such as
\fIuser\fR
and
\fIguest only\fR
if set are then applied and may change the UNIX user to use on this connection, but only after the user has been successfully authenticated\.
.sp
\fINote\fR
that the name of the resource being requested is
\fInot\fR
sent to the server until after the server has successfully authenticated the client\. This is why guest shares don\'t work in user level security without allowing the server to automatically map unknown users into the
\fIguest account\fR\. See the
\fImap to guest\fR
parameter for details on doing this\.
.sp
See also the section
NOTE ABOUT USERNAME/PASSWORD VALIDATION\.
.sp
\fISECURITY = DOMAIN\fR
.sp
This mode will only work correctly if
\fBnet\fR(8)
has been used to add this machine into a Windows NT Domain\. It expects the
\fIencrypted passwords\fR
parameter to be set to
\fByes\fR\. In this mode Samba will try to validate the username/password by passing it to a Windows NT Primary or Backup Domain Controller, in exactly the same way that a Windows NT Server would do\.
.sp
\fINote\fR
that a valid UNIX user must still exist as well as the account on the Domain Controller to allow Samba to have a valid UNIX account to map file access to\.
.sp
\fINote\fR
that from the client\'s point of view
security = domain
is the same as
security = user\. It only affects how the server deals with the authentication, it does not in any way affect what the client sees\.
.sp
\fINote\fR
that the name of the resource being requested is
\fInot\fR
sent to the server until after the server has successfully authenticated the client\. This is why guest shares don\'t work in user level security without allowing the server to automatically map unknown users into the
\fIguest account\fR\. See the
\fImap to guest\fR
parameter for details on doing this\.
.sp
See also the section
NOTE ABOUT USERNAME/PASSWORD VALIDATION\.
.sp
See also the
\fIpassword server\fR
parameter and the
\fIencrypted passwords\fR
parameter\.
.sp
\fISECURITY = SERVER\fR
.sp
In this mode Samba will try to validate the username/password by passing it to another SMB server, such as an NT box\. If this fails it will revert to
security = user\. It expects the
\fIencrypted passwords\fR
parameter to be set to
\fByes\fR, unless the remote server does not support them\. However note that if encrypted passwords have been negotiated then Samba cannot revert back to checking the UNIX password file, it must have a valid
\fIsmbpasswd\fR
file to check users against\. See the chapter about the User Database in the Samba HOWTO Collection for details on how to set this up\.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
This mode of operation has significant pitfalls since it is more vulnerable to man\-in\-the\-middle attacks and server impersonation\. In particular, this mode of operation can cause significant resource consuption on the PDC, as it must maintain an active connection for the duration of the user\'s session\. Furthermore, if this connection is lost, there is no way to reestablish it, and futher authentications to the Samba server may fail (from a single client, till it disconnects)\.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
From the client\'s point of view
security = server
is the same as
security = user\. It only affects how the server deals with the authentication, it does not in any way affect what the client sees\.

\fINote\fR
that the name of the resource being requested is
\fInot\fR
sent to the server until after the server has successfully authenticated the client\. This is why guest shares don\'t work in user level security without allowing the server to automatically map unknown users into the
\fIguest account\fR\. See the
\fImap to guest\fR
parameter for details on doing this\.
.sp
See also the section
NOTE ABOUT USERNAME/PASSWORD VALIDATION\.
.sp
See also the
\fIpassword server\fR
parameter and the
\fIencrypted passwords\fR
parameter\.
.sp
\fISECURITY = ADS\fR
.sp
In this mode, Samba will act as a domain member in an ADS realm\. To operate in this mode, the machine running Samba will need to have Kerberos installed and configured and Samba will need to be joined to the ADS realm using the net utility\.
.sp
Note that this mode does NOT make Samba operate as a Active Directory Domain Controller\.
.sp
Read the chapter about Domain Membership in the HOWTO for details\.
.sp
Default:
\fI\fIsecurity\fR\fR\fI = \fR\fIUSER\fR\fI \fR
.sp
Example:
\fI\fIsecurity\fR\fR\fI = \fR\fIDOMAIN\fR\fI \fR
.RE

security mask (S)
.PP
.RS 4
This parameter controls what UNIX permission bits will be set when a Windows NT client is manipulating the UNIX permission on a file using the native NT security dialog box\.
.sp
This parameter is applied as a mask (AND\'ed with) to the incoming permission bits, thus resetting any bits not in this mask\. Make sure not to mix up this parameter with
\fIforce security mode\fR, which works in a manner similar to this one but uses a logical OR instead of an AND\.
.sp
Essentially, all bits set to zero in this mask will result in setting to zero the corresponding bits on the file permissions regardless of the previous status of this bits on the file\.
.sp
If not set explicitly this parameter is 0777, allowing a user to set all the user/group/world permissions on a file\.
.sp
\fI Note\fR
that users who can access the Samba server through other means can easily bypass this restriction, so it is primarily useful for standalone "appliance" systems\. Administrators of most normal systems will probably want to leave it set to
\fB0777\fR\.
.sp
Default:
\fI\fIsecurity mask\fR\fR\fI = \fR\fI0777\fR\fI \fR
.sp
Example:
\fI\fIsecurity mask\fR\fR\fI = \fR\fI0770\fR\fI \fR
.RE

server schannel (G)
.PP
.RS 4
This controls whether the server offers or even demands the use of the netlogon schannel\.
\fIserver schannel = no\fR
does not offer the schannel,
\fIserver schannel = auto\fR
offers the schannel but does not enforce it, and
\fIserver schannel = yes\fR
denies access if the client is not able to speak netlogon schannel\. This is only the case for Windows NT4 before SP4\.
.sp
Please note that with this set to
no
you will have to apply the WindowsXP
\fIWinXP_SignOrSeal\.reg\fR
registry patch found in the docs/registry subdirectory of the Samba distribution tarball\.
.sp
Default:
\fI\fIserver schannel\fR\fR\fI = \fR\fIauto\fR\fI \fR
.sp
Example:
\fI\fIserver schannel\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

server signing (G)
.PP
.RS 4
This controls whether the server offers or requires the client it talks to to use SMB signing\. Possible values are
\fIauto\fR,
\fImandatory\fR
and
\fIdisabled\fR\.
.sp
When set to auto, SMB signing is offered, but not enforced\. When set to mandatory, SMB signing is required and if set to disabled, SMB signing is not offered either\.
.sp
Default:
\fI\fIserver signing\fR\fR\fI = \fR\fIDisabled\fR\fI \fR
.RE

server string (G)
.PP
.RS 4
このパラメータにより、プリンタマネージャにおける各プリンタのコメント欄および
net view
において IPC 接続の横に表示されるテキストが設定される。ユーザに表示させたい任意のテキストを設定することができる。
.sp
このパラメータにより、ブラウズリストでコンピュータ名の横に表示されるテキストも設定される。
.sp
\fI%v\fR
は、 Samba のバージョン番号に置換される。
.sp
\fI%h\fR
は、ホスト名に置換される。
.sp
Default:
\fI\fIserver string\fR\fR\fI = \fR\fISamba %v\fR\fI \fR
.sp
Example:
\fI\fIserver string\fR\fR\fI = \fR\fIUniversity of GNUs Samba Server\fR\fI \fR
.RE

set directory (S)
.PP
.RS 4
set directory = no
の場合、 サービスの利用者が、 ディレクトリ変更のための setdir コマンドを使えなくなる。
.sp

setdir
コマンドは Digital Pathworks クライアントにおいてのみ実装されている。 詳細については、Pathworks の説明書を参照のこと。
.sp
Default:
\fI\fIset directory\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

set primary group script (G)
.PP
.RS 4
NT の POSIX サブシステムのおかげで、 Windows ユーザには、 auxiliary (補助)グループに加えて、 プライマリグループを設定することができる。 このスクリプトにより、管理者が Windows のユーザマネージャからプライマリグループを設定したり、
net rpc vampire
により SAM を取得したりした際に、 UNIX のユーザデータベースのプライマリグループが設定される。
\fI%u\fR
は、プライマリグループを設定するユーザに置き換えられる。
\fI%g\fR
は設定されるグループ名に置き換えられる。
.sp
Default:
\fI\fIset primary group script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIset primary group script\fR\fR\fI = \fR\fI/usr/sbin/usermod \-g \'%g\' \'%u\'\fR\fI \fR
.RE

set quota command (G)
.PP
.RS 4
The
set quota command
should only be used whenever there is no operating system API available from the OS that samba can use\.
.sp
This option is only available if Samba was configured with the argument
\-\-with\-sys\-quotas
or on linux when
\./configure \-\-with\-quotas
was used and a working quota api was found in the system\. Most packages are configured with these options already\.
.sp
This parameter should specify the path to a script that can set quota for the specified arguments\.
.sp
The specified script should take the following arguments:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
1 \- quota type
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
1 \- user quotas
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
2 \- user default quotas (uid = \-1)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
3 \- group quotas
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
4 \- group default quotas (gid = \-1)
.sp
.RE
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
2 \- id (uid for user, gid for group, \-1 if N/A)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
3 \- quota state (0 = disable, 1 = enable, 2 = enable and enforce)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
4 \- block softlimit
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
5 \- block hardlimit
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
6 \- inode softlimit
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
7 \- inode hardlimit
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
8(optional) \- block size, defaults to 1024
.sp
.RE
The script should output at least one line of data on success\. And nothing on failure\.
.sp
Default:
\fI\fIset quota command\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIset quota command\fR\fR\fI = \fR\fI/usr/local/sbin/set_quota\fR\fI \fR
.RE

share modes (S)
.PP
.RS 4
このパラメータは、ファイルオープン中の
\fIshare modes\fR
の制御を有効にするかどうかを設定する。 このモードは、ファイルへの排他的な読み出し又は書き込みアクセスを得るために、クライアントによって利用されるものである。
.sp
これらのモードは、UNIX では提供されていないため、 共有メモリ、共有メモリをサポートしていない場合はロックファイル(共有メモリはほとんどすべてのUNIXでサポートされている)で疑似的に実現されている。
.sp
このオプションで有効化される共有モードは
\fBDENY_DOS\fR、\fBDENY_ALL\fR,
\fBDENY_READ\fR、\fBDENY_WRITE\fR,
\fBDENY_NONE\fR、\fBDENY_FCB\fR
である。
.sp
このオプションは共有機能の互換性を保つため、 デフォルトで有効になっている。
.sp
このパラメータは、
\fI絶対に\fR
off にしてはならない。 off にした場合、多くの Windows アプリケーションが誤動作するであろう。
.sp
Default:
\fI\fIshare modes\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

short preserve case (S)
.PP
.RS 4
この真偽値パラメータは、 すべて大文字で適切な長さという 8\.3 形式の条件を満たすファイル名を大文字のファイル名にして作成するか、
\fIdefault case\fR
パラメータに従って作成するかを指定する(訳注: 実際は、8+3 形式の名前において大文字小文字の混在を容認するか、規定値の文字指定に統一するかを制御する)。 このオプションは、
\fIpreserve case = yes\fR
を用いて長いファイル名の大文字小文字の情報を保持している際に、 短いファイル名における大文字小文字の情報を保持するために利用する。
.sp
名前の短縮セクションも参照のこと。
.sp
Default:
\fI\fIshort preserve case\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

show add printer wizard (G)
.PP
.RS 4
Samba 2\.2 での Windows NT/2000 クライアントに対する MS\-RPC ベースのプリンタサポート機能のサポートによって、 Samba ホスト上の共有一覧で「プリンタ」フォルダが表示されようになっている。 通常、このフォルダにはプリンタの追加ウィザード (MS Add Printer Wizard (APW))のアイコンが存在している。 しかし、接続したユーザの権限に関わらず、 この機能を無効にすることも可能である。
.sp
通常の場合、Windows NT/2000 クライアントは Administrator 権限を持っているかどうかを確認するために、 OpenPrinterEx() 関数により、プリンタサーバ上のハンドルをオープンしようとする。 ユーザにプリンタサーバ上での管理者権限がない場合 (root でなく、\fIprinter admin\fR
グループのメンバでもない)、 OpenPrinterEx() の呼出は失敗して、 client は低い権限でも可能な別の関数呼出を行なう。 これに成功しても、APW のアイコンは表示されない。
.sp
\fIshow add printer wizard\fR
パラメータを無効にすることにより、サーバ上での OpenPrinterEx() 呼出が常に失敗するようになる。 そのため、APW のアイコンは決して表示されなくなる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
このパラメータは、ユーザが個々のプリンタの管理権限を持つことを制限するものではない。

Default:
\fI\fIshow add printer wizard\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

shutdown script (G)
.PP
.RS 4
このパラメータは、
\fBsmbd\fR(8)
が呼び出すことで、 シャットダウン処理を実行するスクリプトのフルパス名である。
.sp
サーバに接続しているユーザが
\fBSeRemoteShutdownPrivilege\fR
権利を有している場合、 このコマンドはそのユーザの権限で実行される。
.sp
%m %t %r %f パラメータは以下のように展開される:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%m\fR
はサーバに送信されるシャットダウンメッセージに置換される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%t\fR
は実際にシャットダウン処理が開始されるまでに待機する時間(秒単位)に置換される。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%r\fR
は
\fI\-r\fR
スイッチに置換される。これは NT の「シャットダウン後再起動」を意味する。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI%f\fR
は
\fI\-f\fR
スイッチに置換される。これは NT の「アプリケーションが応答しない場合でも強制的にシャットダウンする」を意味する。
.sp
.RE
シャットダウンスクリプト例を以下に示す:
.sp
.RS 4
.nf
#!/bin/bash
		
$time=0
let "time/60"
let "time++"

/sbin/shutdown $3 $4 +$time $1 &
.fi
.RE
.sp
シャットダウン処理から復帰することはないので、この処理はバックグラウンドで実行する必要がある。
.sp
Default:
\fI\fIshutdown script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIshutdown script\fR\fR\fI = \fR\fI/usr/local/samba/sbin/shutdown %m %t %r %f\fR\fI \fR
.RE

smb encrypt (S)
.PP
.RS 4
This is a new feature introduced with Samba 3\.2 and above\. It is an extension to the SMB/CIFS protocol negotiated as part of the UNIX extensions\. SMB encryption uses the GSSAPI (SSPI on Windows) ability to encrypt and sign every request/response in a SMB protocol stream\. When enabled it provides a secure method of SMB/CIFS communication, similar to an ssh protected session, but using SMB/CIFS authentication to negotiate encryption and signing keys\. Currently this is only supported by Samba 3\.2 smbclient, and hopefully soon Linux CIFSFS and MacOS/X clients\. Windows clients do not support this feature\.
.sp
This controls whether the server offers or requires the client it talks to to use SMB encryption\. Possible values are
\fIauto\fR,
\fImandatory\fR
and
\fIdisabled\fR\. This may be set on a per\-share basis, but clients may chose to encrypt the entire session, not just traffic to a specific share\. If this is set to mandatory then all traffic to a share
\fImust\fR
must be encrypted once the connection has been made to the share\. The server would return "access denied" to all non\-encrypted requests on such a share\. Selecting encrypted traffic reduces throughput as smaller packet sizes must be used (no huge UNIX style read/writes allowed) as well as the overhead of encrypting and signing all the data\.
.sp
If SMB encryption is selected, Windows style SMB signing (see the
\fIserver signing\fR
option) is no longer necessary, as the GSSAPI flags use select both signing and sealing of the data\.
.sp
When set to auto, SMB encryption is offered, but not enforced\. When set to mandatory, SMB encryption is required and if set to disabled, SMB encryption can not be negotiated\.
.sp
Default:
\fI\fIsmb encrypt\fR\fR\fI = \fR\fIauto\fR\fI \fR
.RE

smb passwd file (G)
.PP
.RS 4
This option sets the path to the encrypted smbpasswd file\. By default the path to the smbpasswd file is compiled into Samba\.
.sp
An example of use is:
.sp
.RS 4
.nf
smb passwd file = /etc/samba/smbpasswd
.fi
.RE
.sp
.sp
Default:
\fI\fIsmb passwd file\fR\fR\fI = \fR\fI${prefix}/private/smbpasswd\fR\fI \fR
.RE

smb ports (G)
.PP
.RS 4
サーバが SMB トラヒックを町受けるポートを設定する。
.sp
Default:
\fI\fIsmb ports\fR\fR\fI = \fR\fI445 139\fR\fI \fR
.RE

socket address (G)
.PP
.RS 4
このオプションは、 Samba がどのアドレスで接続を listen するかを設定する。 これは、サーバ上で複数の仮想インタフェースを用いる必要があり、 各々のインタフェース上で 異なる構成の Samba を動作させる際に利用できる。
.sp
デフォルトの場合、 Sambaはどのアドレスからのアクセスでも受け付ける。
.sp
Default:
\fI\fIsocket address\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIsocket address\fR\fR\fI = \fR\fI192\.168\.2\.20\fR\fI \fR
.RE

socket options (G)
.PP
.RS 4
This option allows you to set socket options to be used when talking with the client\.
.sp
Socket options are controls on the networking layer of the operating systems which allow the connection to be tuned\.
.sp
This option will typically be used to tune your Samba server for optimal performance for your local network\. There is no way that Samba can know what the optimal parameters are for your net, so you must experiment and choose them yourself\. We strongly suggest you read the appropriate documentation for your operating system first (perhaps
man setsockopt
will help)\.
.sp
You may find that on some systems Samba will say "Unknown socket option" when you supply an option\. This means you either incorrectly typed it or you need to add an include file to includes\.h for your OS\. If the latter is the case please send the patch to
samba\-technical@samba\.org\.
.sp
Any of the supported socket options may be combined in any way you like, as long as your OS allows it\.
.sp
This is the list of socket options currently settable using this option:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_KEEPALIVE
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_REUSEADDR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_BROADCAST
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
TCP_NODELAY
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
IPTOS_LOWDELAY
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
IPTOS_THROUGHPUT
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_SNDBUF *
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_RCVBUF *
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_SNDLOWAT *
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
SO_RCVLOWAT *
.sp
.RE
Those marked with a
\fI\'*\'\fR
take an integer argument\. The others can optionally take a 1 or 0 argument to enable or disable the option, by default they will be enabled if you don\'t specify 1 or 0\.
.sp
To specify an argument use the syntax SOME_OPTION = VALUE for example
SO_SNDBUF = 8192\. Note that you must not have any spaces before or after the = sign\.
.sp
If you are on a local network then a sensible option might be:
.sp
socket options = IPTOS_LOWDELAY
.sp
If you have a local network then you could try:
.sp
socket options = IPTOS_LOWDELAY TCP_NODELAY
.sp
If you are on a wide area network then perhaps try setting IPTOS_THROUGHPUT\.
.sp
Note that several of the options may cause your Samba server to fail completely\. Use these options with caution!
.sp
Default:
\fI\fIsocket options\fR\fR\fI = \fR\fITCP_NODELAY\fR\fI \fR
.sp
Example:
\fI\fIsocket options\fR\fR\fI = \fR\fIIPTOS_LOWDELAY\fR\fI \fR
.RE

stat cache (G)
.PP
.RS 4
このパラメータにより、
\fBsmbd\fR(8)
が、 大文字小文字を区別しない名前のマップ操作を高速化するためにキャッシュを利用するかどうかが設定される。 このパラメータを変更する必要はないであろう。
.sp
Default:
\fI\fIstat cache\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

store dos attributes (S)
.PP
.RS 4
このパラメータが設定されると、Samba は DOS のファイル属性(システム、隠し、アーカイブ、読み取り専用)を、 (\fImap hidden\fR
や
\fImap readonly\fR
パラメータにより制御される) UNIX のパーミッションビットからのマッピングを行なう前に、 ファイルシステムの拡張属性から読み取ろうとする。 このパラメータが設定されると、DOS のファイル属性は、UNIX ファイルシステム上で、各ファイルやディレクトリ毎に割り当てられた拡張属性の領域に格納される。 これ以外のマッピング機構が動作しないようにするため、
\fImap hidden\fR、
\fImap system\fR、\fImap archive\fR、\fImap readonly\fR
といったパラメータは無効にする必要がある。 このパラメータは DOS のファイル属性を「user\.DOSATTRIB」という名前の拡張属性に、文字列として書き込む。 この拡張属性は、クライアントの拡張属性に関するリクエストからは明示的に隠蔽されている。 Linux において拡張属性を有効にするには、 Linux カーネルで拡張属性がコンパイルされており、 ファイルシステムが user_xattr オプションをつけてマウントされている必要がある。
.sp
Default:
\fI\fIstore dos attributes\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

strict allocate (S)
.PP
.RS 4
This is a boolean that controls the handling of disk space allocation in the server\. When this is set to
\fByes\fR
the server will change from UNIX behaviour of not committing real disk storage blocks when a file is extended to the Windows behaviour of actually forcing the disk system to allocate real storage blocks when a file is created or extended to be a given size\. In UNIX terminology this means that Samba will stop creating sparse files\. This can be slow on some systems\.
.sp
When strict allocate is
\fBno\fR
the server does sparse disk block allocation when a file is extended\.
.sp
Setting this to
\fByes\fR
can help Samba return out of quota messages on systems that are restricting the disk quota of users\.
.sp
Default:
\fI\fIstrict allocate\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

strict locking (S)
.PP
.RS 4
これは、 サーバ上でのロックの扱いを制御する列挙型の値のパラメータである。
\fByes\fR
に設定された場合、 サーバはすべての読み書きのアクセスについてファイルのロック状態を検査し、 ロックされている場合はアクセスを拒否する。 システムによっては、アクセス速度の低下につながるだろう。
.sp
strict locking が Auto (デフォルト値)の場合、サーバは oplock が行なわれていないファイルについてのみ、ロック状態の検査を行なう。 Windows のリダイレクタの多くは、oplock が行なわれているファイルについてはファイルロックのチェックをローカルで実施しているため、 この設定は、パフォーマンス低下とのうまいトレードオフを実現している。
.sp
strict locking が無効の場合、 サーバは、クライアントが明示的に要求したときに限って、 ファイルのロック状態の確認を行なう。
.sp
行儀のよいクライアントは、 重要な操作を行ない際には必ずロックの状態を問い合わせる。 従って、大抵の場合は
strict locking = Auto
か
strict locking = no
がよい。
.sp
Default:
\fI\fIstrict locking\fR\fR\fI = \fR\fIAuto\fR\fI \fR
.RE

strict sync (S)
.PP
.RS 4
Many Windows applications (including the Windows 98 explorer shell) seem to confuse flushing buffer contents to disk with doing a sync to disk\. Under UNIX, a sync call forces the process to be suspended until the kernel has ensured that all outstanding data in kernel disk buffers has been safely stored onto stable storage\. This is very slow and should only be done rarely\. Setting this parameter to
\fBno\fR
(the default) means that
\fBsmbd\fR(8)
ignores the Windows applications requests for a sync call\. There is only a possibility of losing data if the operating system itself that Samba is running on crashes, so there is little danger in this default setting\. In addition, this fixes many performance problems that people have reported with the new Windows98 explorer shell file copies\.
.sp
Default:
\fI\fIstrict sync\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

svcctl list (G)
.PP
.RS 4
このパラメータにより、smbd が Win32 の ServiceControl API 経由で UNIX 側のサービスを起動、停止させる際に用いられる起動スクリプトの一覧を定義する。 これにより、Windows の管理者が Microsoft Management Console プラグインを用いて Samba サーバ上が動作する UNIX サービスを制御することが可能となる。
.sp
管理者は、Samba の $(libdir) 以下に
\fIsvcctl\fR
というディレクトリを作成して、
\fI/etc/init\.d/\fR
に存在する起動スクリプトのシンボリックリンクを作成しておく必要がある。 シンボリックリンク名は、
\fIsvcctl list\fR
パラメータに記載した名称と同一にしておくこと。
.sp
Default:
\fI\fIsvcctl list\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIsvcctl list\fR\fR\fI = \fR\fIcups postfix portmap httpd\fR\fI \fR
.RE

sync always (S)
.PP
.RS 4
This is a boolean parameter that controls whether writes will always be written to stable storage before the write call returns\. If this is
\fBno\fR
then the server will be guided by the client\'s request in each write call (clients can set a bit indicating that a particular write should be synchronous)\. If this is
\fByes\fR
then every write will be followed by a
fsync()
call to ensure the data is written to disk\. Note that the
\fIstrict sync\fR
parameter must be set to
\fByes\fR
in order for this parameter to have any affect\.
.sp
Default:
\fI\fIsync always\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

syslog (G)
.PP
.RS 4
このパラメータは、 Samba のデバッグメッセージと syslog のプライオリティとの対応づけを行なう。 Samba のデバッグレベル 0 は、 syslog の
\fBLOG_ERR\fRに割り当てられ、以下、 デバッグレベル 1 は
\fBLOG_WARNING\fR、 デバッグレベル 2 は
\fBLOG_NOTICE\fR、 デバッグレベル 3 は
\fBLOG_INFO\fR、 それ以上のデバッグレベルは
\fBLOG_DEBUG\fR
にそれぞれ割り当てられている。
.sp
このパラメータは どのデバッグレベルまでのメッセージを syslog に送るかのしきい値を設定する。 この値未満の Samba のデバッグメッセージのみが syslog に送られる。
.sp
Default:
\fI\fIsyslog\fR\fR\fI = \fR\fI1\fR\fI \fR
.RE

syslog only (G)
.PP
.RS 4
このパラメータが設定されると、 Samba のデバッグメッセージが システムの syslog にのみ記録されるようになり、 デバッグログファイルに出力されなくなる。 もしも、\fIsyslog only\fRが有効になっていたとしても、 log\.[sn]mbdへのロギングは引き続き行われる。
.sp
Default:
\fI\fIsyslog only\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

template homedir (G)
.PP
.RS 4
NT ドメインのユーザに対応するユーザ情報を作成する際、
\fBwinbindd\fR(8)
デーモンは、 このパラメータによってユーザのホームディレクトリの位置を設定する。 文字列中に
\fI%D\fR
があれば、 ユーザの所属する NT ドメイン名に置き換えられる。文字列中に
\fI%U\fR
があれば、 ユーザの NT ドメインにおけるユーザ名に置き換えられる。
.sp
Default:
\fI\fItemplate homedir\fR\fR\fI = \fR\fI/home/%D/%U\fR\fI \fR
.RE

template shell (G)
.PP
.RS 4
NT ドメインのユーザに対応するユーザ情報を作成する際、
\fBwinbindd\fR(8)デーモンは、 このパラメータによってユーザのログインシェルを設定する。
.sp
\fINo default\fR
.RE

time offset (G)
.PP
.RS 4
このパラメータは、GMT からローカル時間への変換時に追加する時間(分単位)を設定する。 夏時間処理に問題があるPCを多数管理している際に有効である。
.sp
Default:
\fI\fItime offset\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fItime offset\fR\fR\fI = \fR\fI60\fR\fI \fR
.RE

time server (G)
.PP
.RS 4
このパラメータにより、
\fBnmbd\fR(8)
が、 Windows クライアントに対して、自身をタイムサーバとしてアナウンスするかどうかが制御される。
.sp
Default:
\fI\fItime server\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

unix charset (G)
.PP
.RS 4
Samba が動作する UNIX マシンで使われている文字コードを指定する。 この情報は、Samba が SMB クライアントの使用している文字コードと文字列の変換を行なうために必要である。
.sp
ここで設定した文字コードは、Samba から実行するスクリプトの引数にも用いられる。
.sp
Default:
\fI\fIunix charset\fR\fR\fI = \fR\fIUTF8\fR\fI \fR
.sp
Example:
\fI\fIunix charset\fR\fR\fI = \fR\fIASCII\fR\fI \fR
.RE

unix extensions (G)
.PP
.RS 4
この真偽値パラメータは、Samba が HP 社によって定義された CIFS の UNIX拡張を利用するかどうかを制御する。 これらの拡張は、UNIX クライアントから UNIX サーバに対して接続する際に有用な CIFS を有効にし、 シンボリックリンクやハードリンクなどを利用可能にする。 これらの拡張により、Samba は UNIX の CIFS クライアントに対して、 シンボリックリンクやハードリンクといった機能を提供することが可能となる。
.sp
Default:
\fI\fIunix extensions\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

unix password sync (G)
.PP
.RS 4
This boolean parameter controls whether Samba attempts to synchronize the UNIX password with the SMB password when the encrypted SMB password in the smbpasswd file is changed\. If this is set to
\fByes\fR
the program specified in the
\fIpasswd program\fR
parameter is called
\fIAS ROOT\fR
\- to allow the new UNIX password to be set without access to the old UNIX password (as the SMB password change code has no access to the old password cleartext, only the new)\.
.sp
Default:
\fI\fIunix password sync\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

update encrypted (G)
.PP
.RS 4
This boolean parameter allows a user logging on with a plaintext password to have their encrypted (hashed) password in the smbpasswd file to be updated automatically as they log on\. This option allows a site to migrate from plaintext password authentication (users authenticate with plaintext password over the wire, and are checked against a UNIX account atabase) to encrypted password authentication (the SMB challenge/response authentication mechanism) without forcing all users to re\-enter their passwords via smbpasswd at the time the change is made\. This is a convenience option to allow the change over to encrypted passwords to be made over a longer period\. Once all users have encrypted representations of their passwords in the smbpasswd file this parameter should be set to
\fBno\fR\.
.sp
In order for this parameter to be operative the
\fIencrypt passwords\fR
parameter must be set to
\fBno\fR\. The default value of
\fIencrypt passwords = Yes\fR\. Note: This must be set to
\fBno\fR
for this
\fIupdate encrypted\fR
to work\.
.sp
Note that even when this parameter is set a user authenticating to
smbd
must still enter a valid password in order to connect correctly, and to update their hashed (smbpasswd) passwords\.
.sp
Default:
\fI\fIupdate encrypted\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

use client driver (S)
.PP
.RS 4
このパラメータは、Windows NT/2000 クライアントに対してのみ影響し、 Windows 95/98/Me クライアントに対しては影響しない。 Windows NT/2000 クライアントに対して、 Samba ホスト上に適切なプリンタドライバをインストールせずに、プリンタ共有を提供する場合、 クライアント側ローカルにプリンタドライバをインストールする必要がある。 このため、クライアントは、そのプリンタをローカルプリンタとして扱い、 ネットワークプリンタとしては扱わなくなる。 これは、disable spoolss = yesにしたときとほぼ同様の動作になる。
.sp
違いが発生するのは、通常の環境下において、 NT/2000 クライアントは MS\-RPC を用いてネットワークプリンタをオープンしようとする点にある。 クライアントはプリンタがローカルにあると判断しているため、 ログオンしているユーザに割り当てられたアクセス権を要求して OpenPrinterEx() 呼出を発行してしまう点が問題となる。 ユーザがローカルで管理者権限を持っているが、Samba ホスト上では root 権限を持っていない場合(これはよくあるケースになる)、 OpenPrinterEx() 呼出は失敗する。 その結果、(印刷ジョブが正常に印刷されているにも関わらず、) クライアント側のプリンタキューのウインドウには、 「Access Denied; Unable to connect」というメッセージが表示される。
.sp
このパラメータが有効になっているプリンタに対しては、 PRINTER_ACCESS_ADMINISTER 権限によるプリンタのオープンの試みはすべて、 PRINTER_ACCESS_USE の権限で行なわれ、 これにより、OpenPrinterEx() が成功することになる。
\fI適切なプリンタドライバがインストールされている Samba サーバ上のプリンタ共有に対して、このパラメータを有効にしてはならない。\fR
.sp
Default:
\fI\fIuse client driver\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

use kerberos keytab (G)
.PP
.RS 4
Specifies whether Samba should attempt to maintain service principals in the systems keytab file for
\fBhost/FQDN\fR
and
\fBcifs/FQDN\fR\.
.sp
When you are using the heimdal Kerberos libraries, you must also specify the following in
\fI/etc/krb5\.conf\fR:
.sp
.RS 4
.nf
[libdefaults]
default_keytab_name = FILE:/etc/krb5\.keytab
.fi
.RE
.sp
.sp
Default:
\fI\fIuse kerberos keytab\fR\fR\fI = \fR\fIFalse\fR\fI \fR
.RE

use mmap (G)
.PP
.RS 4
This global parameter determines if the tdb internals of Samba can depend on mmap working correctly on the running system\. Samba requires a coherent mmap/read\-write system memory cache\. Currently only HPUX does not have such a coherent cache, and so this parameter is set to
\fBno\fR
by default on HPUX\. On all other systems this parameter should be left alone\. This parameter is provided to help the Samba developers track down problems with the tdb internal code\.
.sp
Default:
\fI\fIuse mmap\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

user
.PP
.RS 4
This parameter is a synonym for
username\.
.RE

users
.PP
.RS 4
This parameter is a synonym for
username\.
.RE

username (S)
.PP
.RS 4
Multiple users may be specified in a comma\-delimited list, in which case the supplied password will be tested against each username in turn (left to right)\.
.sp
The
\fIusername\fR
line is needed only when the PC is unable to supply its own username\. This is the case for the COREPLUS protocol or where your users have different WfWg usernames to UNIX usernames\. In both these cases you may also be better using the \e\eserver\eshare%user syntax instead\.
.sp
The
\fIusername\fR
line is not a great solution in many cases as it means Samba will try to validate the supplied password against each of the usernames in the
\fIusername\fR
line in turn\. This is slow and a bad idea for lots of users in case of duplicate passwords\. You may get timeouts or security breaches using this parameter unwisely\.
.sp
Samba relies on the underlying UNIX security\. This parameter does not restrict who can login, it just offers hints to the Samba server as to what usernames might correspond to the supplied password\. Users can login as whoever they please and they will be able to do no more damage than if they started a telnet session\. The daemon runs as the user that they log in as, so they cannot do anything that user cannot do\.
.sp
To restrict a service to a particular set of users you can use the
\fIvalid users\fR
parameter\.
.sp
If any of the usernames begin with a \'@\' then the name will be looked up first in the NIS netgroups list (if Samba is compiled with netgroup support), followed by a lookup in the UNIX groups database and will expand to a list of all users in the group of that name\.
.sp
If any of the usernames begin with a \'+\' then the name will be looked up only in the UNIX groups database and will expand to a list of all users in the group of that name\.
.sp
If any of the usernames begin with a \'&\' then the name will be looked up only in the NIS netgroups database (if Samba is compiled with netgroup support) and will expand to a list of all users in the netgroup group of that name\.
.sp
Note that searching though a groups database can take quite some time, and some clients may time out during the search\.
.sp
See the section
NOTE ABOUT USERNAME/PASSWORD VALIDATION
for more information on how this parameter determines access to the services\.
.sp
Default:
\fI\fIusername\fR\fR\fI = \fR\fI # The guest account if a guest service, else <empty string>\.\fR\fI \fR
.sp
Example:
\fI\fIusername\fR\fR\fI = \fR\fIfred, mary, jack, jane, @users, @pcgroup\fR\fI \fR
.RE

username level (G)
.PP
.RS 4
This option helps Samba to try and \'guess\' at the real UNIX username, as many DOS clients send an all\-uppercase username\. By default Samba tries all lowercase, followed by the username with the first letter capitalized, and fails if the username is not found on the UNIX machine\.
.sp
If this parameter is set to non\-zero the behavior changes\. This parameter is a number that specifies the number of uppercase combinations to try while trying to determine the UNIX user name\. The higher the number the more combinations will be tried, but the slower the discovery of usernames will be\. Use this parameter when you have strange usernames on your UNIX machine, such as
\fBAstrangeUser \fR\.
.sp
This parameter is needed only on UNIX systems that have case sensitive usernames\.
.sp
Default:
\fI\fIusername level\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIusername level\fR\fR\fI = \fR\fI5\fR\fI \fR
.RE

username map (G)
.PP
.RS 4
This option allows you to specify a file containing a mapping of usernames from the clients to the server\. This can be used for several purposes\. The most common is to map usernames that users use on DOS or Windows machines to those that the UNIX box uses\. The other is to map multiple users to a single username so that they can more easily share files\.
.sp
Please note that for user or share mode security, the username map is applied prior to validating the user credentials\. Domain member servers (domain or ads) apply the username map after the user has been successfully authenticated by the domain controller and require fully qualified enties in the map table (e\.g\. biddle =
DOMAIN\efoo)\.
.sp
The map file is parsed line by line\. Each line should contain a single UNIX username on the left then a \'=\' followed by a list of usernames on the right\. The list of usernames on the right may contain names of the form @group in which case they will match any UNIX username in that group\. The special client name \'*\' is a wildcard and matches any name\. Each line of the map file may be up to 1023 characters long\.
.sp
The file is processed on each line by taking the supplied username and comparing it with each username on the right hand side of the \'=\' signs\. If the supplied name matches any of the names on the right hand side then it is replaced with the name on the left\. Processing then continues with the next line\.
.sp
If any line begins with a \'#\' or a \';\' then it is ignored\.
.sp
If any line begins with an \'!\' then the processing will stop after that line if a mapping was done by the line\. Otherwise mapping continues with every line being processed\. Using \'!\' is most useful when you have a wildcard mapping line later in the file\.
.sp
For example to map from the name
\fBadmin\fR
or
\fBadministrator\fR
to the UNIX name
\fB root\fR
you would use:
.sp
.RS 4
.nf
root = admin administrator
.fi
.RE
.sp
Or to map anyone in the UNIX group
\fBsystem\fR
to the UNIX name
\fBsys\fR
you would use:
.sp
.RS 4
.nf
sys = @system
.fi
.RE
.sp
.sp
You can have as many mappings as you like in a username map file\.
.sp
If your system supports the NIS NETGROUP option then the netgroup database is checked before the
\fI/etc/group \fR
database for matching groups\.
.sp
You can map Windows usernames that have spaces in them by using double quotes around the name\. For example:
.sp
.RS 4
.nf
tridge = "Andrew Tridgell"
.fi
.RE
.sp
would map the windows username "Andrew Tridgell" to the unix username "tridge"\.
.sp
The following example would map mary and fred to the unix user sys, and map the rest to guest\. Note the use of the \'!\' to tell Samba to stop processing if it gets a match on that line:
.sp
.RS 4
.nf
!sys = mary fred
guest = *
.fi
.RE
.sp
.sp
Note that the remapping is applied to all occurrences of usernames\. Thus if you connect to \e\eserver\efred and
\fBfred\fR
is remapped to
\fBmary\fR
then you will actually be connecting to \e\eserver\emary and will need to supply a password suitable for
\fBmary\fR
not
\fBfred\fR\. The only exception to this is the username passed to the
\fIpassword server\fR
(if you have one)\. The password server will receive whatever username the client supplies without modification\.
.sp
Also note that no reverse mapping is done\. The main effect this has is with printing\. Users who have been mapped may have trouble deleting print jobs as PrintManager under WfWg will think they don\'t own the print job\.
.sp
Samba versions prior to 3\.0\.8 would only support reading the fully qualified username (e\.g\.:
DOMAIN\euser) from the username map when performing a kerberos login from a client\. However, when looking up a map entry for a user authenticated by NTLM[SSP], only the login name would be used for matches\. This resulted in inconsistent behavior sometimes even on the same server\.
.sp
The following functionality is obeyed in version 3\.0\.8 and later:
.sp
When performing local authentication, the username map is applied to the login name before attempting to authenticate the connection\.
.sp
When relying upon a external domain controller for validating authentication requests, smbd will apply the username map to the fully qualified username (i\.e\.
DOMAIN\euser) only after the user has been successfully authenticated\.
.sp
An example of use is:
.sp
.RS 4
.nf
username map = /usr/local/samba/lib/users\.map
.fi
.RE
.sp
.sp
Default:
\fI\fIusername map\fR\fR\fI = \fR\fI # no username map\fR\fI \fR
.RE

username map script (G)
.PP
.RS 4
This script is a mutually exclusive alternative to the
\fIusername map\fR
parameter\. This parameter specifies and external program or script that must accept a single command line option (the username transmitted in the authentication request) and return a line line on standard output (the name to which the account should mapped)\. In this way, it is possible to store username map tables in an LDAP or NIS directory services\.
.sp
Default:
\fI\fIusername map script\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIusername map script\fR\fR\fI = \fR\fI/etc/samba/scripts/mapusers\.sh\fR\fI \fR
.RE

usershare allow guests (G)
.PP
.RS 4
このパラメータは、ユーザ定義共有に認証されていないユーザのアクセスを許可するかどうかを制御する。 これは、ユーザが共有の定義において
\fIguest ok = yes\fR
オプションを付与した共有を作成することの許可と同義である。 セキュリティ上注意を要するため、デフォルト値は無効となっている。
.sp
Default:
\fI\fIusershare allow guests\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

usershare max shares (G)
.PP
.RS 4
このパラメータは(訳注: usershare path パラメータで定義された) ユーザ定義共有ディレクトリの所有グループに所属するユーザによって作成可能なユーザ定義共有の最大数を設定する。 0 (デフォルト) の場合、ユーザ定義共有は作成できない。
.sp
Default:
\fI\fIusershare max shares\fR\fR\fI = \fR\fI0\fR\fI \fR
.RE

usershare owner only (G)
.PP
.RS 4
このパラメータは、ユーザ定義共有として公開されるパスが、 ユーザ定義共有を作成しようとしているユーザの所有であることを必須とするかどうかを制御する。 必須とした場合 (デフォルト値) 、smbd は公開しようとしているディレクトリが、ユーザ定義共有の設定ファイルの所有者と同一であることを確認し、もし異なっていた倍は作成を拒否する。 必須としなかった場合、こうした確認は行なわれず、誰が所有しているかに関わらず、ディレクトリの公開が可能となる。
.sp
Default:
\fI\fIusershare owner only\fR\fR\fI = \fR\fITrue\fR\fI \fR
.RE

usershare path (G)
.PP
.RS 4
このパラメータにより、ユーザ定義共有の設定ファイルが格納されるファイルシステム上のディレクトリの絶対パスが指定される。 このディレクトリは root の所有でなければならず、その他(other)がアクセス可能であってはならず、グループの所有者のみが書き込み可能となっている必要がある。 加えて、ファイルの所有者による名前の変更と削除を制限するため、「sticky」ビットが設定されている必要がある (これは /tmp ディレクトリに対して通常行なわれる設定と同義である)。 このディレクトリのグループ所有者が、ユーザ定義共有を作成可能なユーザとなる。 このパラメータが設定されていない場合、誰もユーザ定義共有を作成できない。
.sp
一例として、ユーザ定義共有のディレクトリを /use/local/samba/lib/usershares に設定する場合、以下のようにする。
.sp
.RS 4
.nf
	ls \-ld /usr/local/samba/lib/usershares/
	drwxrwx\-\-T  2 root power_users 4096 2006\-05\-05 12:27 /usr/local/samba/lib/usershares/
	
.fi
.RE
.sp
.sp
この場合、「power_users」グループのメンバのみがユーザ定義共有を作成できる。
.sp
Default:
\fI\fIusershare path\fR\fR\fI = \fR\fINULL\fR\fI \fR
.RE

usershare prefix allow list (G)
.PP
.RS 4
このパラメータには、ユーザ定義共有による共有を許可する絶対パス名のリストを指定する。 共有しようとしているパス名の先頭がこのリストに指定されたパス名のいずれかと合致していない場合、公開は許可されない。 これにより、Samba の管理者がユーザ定義共有による公開を可能とするディレクトリを制限することが可能となる。
.sp
「usershare prefix deny list」と「usershare prefix allow list」の両方が定義されている場合は、 拒否リスト側が先に処理され、後から許可リストが処理される。 これにより、拒否リストによる制限を優先している。
.sp
Default:
\fI\fIusershare prefix allow list\fR\fR\fI = \fR\fINULL\fR\fI \fR
.sp
Example:
\fI\fIusershare prefix allow list\fR\fR\fI = \fR\fI/home /data /space\fR\fI \fR
.RE

usershare prefix deny list (G)
.PP
.RS 4
このパラメータには、ユーザ定義共有による公開を拒否する絶対パス名のリストを指定する。 公開しようとしているパス名の先頭がこのリストに指定されたパス名のいずれかと合致している場合、公開は許可されない。 このリストに指定されたパス名のいずれとも合致していないパス名から始まるパス名は、ユーザ定義共有として公開を許可することができる。 これにより、Samba の管理者がユーザ定義共有による公開を可能とするディレクトリを制限することが可能となる。
.sp
「usershare prefix deny list」と「usershare prefix allow list」の両方が定義されている場合は、 拒否リスト側が先に処理され、後から許可リストが処理される。 これにより、拒否リストによる制限を優先している。
.sp
Default:
\fI\fIusershare prefix deny list\fR\fR\fI = \fR\fINULL\fR\fI \fR
.sp
Example:
\fI\fIusershare prefix deny list\fR\fR\fI = \fR\fI/etc /dev /private\fR\fI \fR
.RE

usershare template share (G)
.PP
.RS 4
ユーザ定義共有では、path 、 guest ok といった幾つかのパラメータしか設定できないが、 このパラメータにより、ユーザ定義共有を既存の共有から「複製」することが可能となる。 「usershare template share」に既存の共有名が設定されていた場合、作成されるすべてのユーザ定義共有では、デフォルト値としてこの共有に設定されたパラメータが用いられる。
.sp
対象となる共有には、「\-valid = False」の設定をテンプレートの設定として行なっておくことで、実際のファイル共有として機能しないようにしておくことができる。 これにより、ユーザ定義共有のテンプレートとして用いつつ、その共有が実際に公開されないようにできる。
.sp
Default:
\fI\fIusershare template share\fR\fR\fI = \fR\fINULL\fR\fI \fR
.sp
Example:
\fI\fIusershare template share\fR\fR\fI = \fR\fItemplate_share\fR\fI \fR
.RE

use sendfile (S)
.PP
.RS 4
If this parameter is
\fByes\fR, and the
\fBsendfile()\fR
system call is supported by the underlying operating system, then some SMB read calls (mainly ReadAndX and ReadRaw) will use the more efficient sendfile system call for files that are exclusively oplocked\. This may make more efficient use of the system CPU\'s and cause Samba to be faster\. Samba automatically turns this off for clients that use protocol levels lower than NT LM 0\.12 and when it detects a client is Windows 9x (using sendfile from Linux will cause these clients to fail)\.
.sp
Default:
\fI\fIuse sendfile\fR\fR\fI = \fR\fIfalse\fR\fI \fR
.RE

use spnego (G)
.PP
.RS 4
このパラメータの値により、 Samba が Windows 2000 や Windows XP クライアントの間で行なわれる認証の際に Simple and Protected NEGOciation (RFC2478 で規定) の使用を試みるかどうかが制御される。
.sp
SPNEGO の実装に問題点が発見されない限り、 これを無効にする必要性はない。
.sp
Default:
\fI\fIuse spnego\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

utmp (G)
.PP
.RS 4
この真偽値パラメータは、 Sambaが
\-\-with\-utmp
オプションで configure され、コンパイルされた時にのみに有効である。 このパラメータを
\fByes\fR
に設定することで、 Sambaは utmp または utmpx レコード(UNIXシステムに依存)に、 Sambaサーバへの接続時の情報を追加するようになる。 このパラメータにより、 Sambaの共有への接続を記録することが可能になる。
.sp
utmp レコードの仕様のため、接続する個々のユーザ毎に一意な識別子が生成されている必要がある。 この、オプションを有効にすることで、 n^2 アルゴリズムを使ってその番号を検索する処理が発生する。 大規模システムの場合、この処理がパフォーマンスに影響を与える場合も考えられる。
.sp
Default:
\fI\fIutmp\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

utmp directory (G)
.PP
.RS 4
このパラメータは、 Sambaが
\-\-with\-utmp
オプションで configure され、コンパイルされた時にのみに有効である。 このパラメータは、 Sambaサーバへの接続を記録する utmp または utmpx ファイル (UNIXシステムに依存)が存在するディレクトリを指定する。 デフォルトではこの値は設定されない。 この場合、システムが利用している utmp ファイルが使われる (Linux の場合、通常
\fI/var/run/utmp\fR
にある)。
.sp
Default:
\fI\fIutmp directory\fR\fR\fI = \fR\fI # Determined automatically\fR\fI \fR
.sp
Example:
\fI\fIutmp directory\fR\fR\fI = \fR\fI/var/run/utmp\fR\fI \fR
.RE

\-valid (S)
.PP
.RS 4
このパラメータは、共有が有効であり、使用可能かどうかを制御する。 このパラメータを false に設定した場合、いかなる方法を用いても、共有を表示したり、共有に対してアクセスしたりすることができなくなる。
.sp
このオプションは一般ユーザが利用すべきものではなく、開発者の利便性のために設けられている。 Samba はこのオプションを内部的に用いて、共有が削除されたことを記録している。
.sp
Default:
\fI\fI\-valid\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

valid users (S)
.PP
.RS 4
This is a list of users that should be allowed to login to this service\. Names starting with \'@\', \'+\' and \'&\' are interpreted using the same rules as described in the
\fIinvalid users\fR
parameter\.
.sp
If this is empty (the default) then any user can login\. If a username is in both this list and the
\fIinvalid users\fR
list then access is denied for that user\.
.sp
The current servicename is substituted for
\fI%S\fR\. This is useful in the [homes] section\.
.sp
Default:
\fI\fIvalid users\fR\fR\fI = \fR\fI # No valid users list (anyone can login) \fR\fI \fR
.sp
Example:
\fI\fIvalid users\fR\fR\fI = \fR\fIgreg, @pcusers\fR\fI \fR
.RE

veto files (S)
.PP
.RS 4
このパラメータは、 一覧することもアクセスすることもできないファイルとディレクトリのリストを指定する。 リストの各エントリは \'/\' で区切ること。これにより、 エントリ中に空白文字を用いることが可能になっている。 \'*\'と \'?\'は DOS のワイルドカードと同様、 複数のファイルやディレクトリを指定するために利用できる。
.sp
各エントリはDOSの形式ではなく、 UNIXでのパス形式である必要があり、 UNIX のディレクトリ区切りである \'/\'を\fI含めてはならない\fR。
.sp

\fIcase sensitive\fR
オプションが、この処理に影響することに注意。
.sp
veto files パラメータの利用に際して注意すべき重要な点が、 ディレクトリ削除時の動作である。 削除されるディレクトリに veto files パラメータに一致するファイルが存在する場合、
\fIdelete veto files\fR
パラメータが
\fIyes\fR
でない限り、削除は\fI失敗\fRする。
.sp
このパラメータを設定した場合は、 ファイルやディレクトリの一覧を取得する際、 すべてのファイルとディレクトリについて、 このパラメータのマッチング処理が行なわれるようになるため、 Samba の性能に影響が発生する。
.sp
以下に設定例を記載する:
.sp
.RS 4
.nf
; Veto any files containing the word Security,
; any ending in \.tmp, and any directory containing the
; word root\.
veto files = /*Security*/*\.tmp/*root*/

; Veto the Apple specific files that a NetAtalk server
; creates\.
veto files = /\.AppleDouble/\.bin/\.AppleDesktop/Network Trash Folder/
.fi
.RE
.sp
.sp
Default:
\fI\fIveto files\fR\fR\fI = \fR\fIアクセスできないファイルやディレクトリはない\fR\fI \fR
.RE

veto oplock files (S)
.PP
.RS 4
このパラメータは、
\fIoplocks\fR
パラメータが有効になっている共有でのみ意味がある。 Samba の管理者は、このパラメータを使って リストにマッチしたファイルに対する oplock を禁止することができる。 リストは
\fIveto files\fR
パラメータで利用されているものと同様の形式である。
.sp
クライアントによるロック競合が激しいファイルに対して、 このオプションを適用したいということがあるだろう。 例としては NetBench SMB ベンチマーク・プログラムがある。 このプログラムは
\fI「\.SEM」\fR
で終わる名前のファイルに対して激しい競合を発生させる。 これらのファイルに対する oplock を禁止するためには、 以下の設定例のように指定する ([global] セクションか、 Net Bench 用の共有のいずれかにおいて)。
.sp
以下に設定例を示す。
.sp
.RS 4
.nf
veto oplock files = /\.*SEM/
.fi
.RE
.sp
.sp
Default:
\fI\fIveto oplock files\fR\fR\fI = \fR\fI # oplock 取得を禁止されるファイルやディレクトリはない\fR\fI \fR
.RE

vfs object
.PP
.RS 4
This parameter is a synonym for
vfs objects\.
.RE

vfs objects (S)
.PP
.RS 4
This parameter specifies the backend names which are used for Samba VFS I/O operations\. By default, normal disk I/O operations are used but these can be overloaded with one or more VFS objects\.
.sp
Default:
\fI\fIvfs objects\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIvfs objects\fR\fR\fI = \fR\fIextd_audit recycle\fR\fI \fR
.RE

volume (S)
.PP
.RS 4
このパラメータにより、共有のボリュームラベルの設定が可能になる。 これは、特定のボリューム名が必要なインストールプログラムを格納した CD\-ROM を共有する際に便利である。
.sp
Default:
\fI\fIvolume\fR\fR\fI = \fR\fI # the name of the share\fR\fI \fR
.RE

wide links (S)
.PP
.RS 4
このパラメータは、 UNIXファイルシステム上のリンクをサーバが追跡するかどうかを制御する。 サーバが公開するディレクトリツリー内部へのリンクは、 常に許可されている。このパラメータは、 公開されているディレクトリツリー外部へのアクセスを制御する。
.sp
このパラメータを no に設定すると、 リンク先のチェックを行なうための余分なシステムコールを実行する必要があるため、 サーバのパフォーマンスに悪影響を及ぼすことに注意。
.sp
Default:
\fI\fIwide links\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

winbind cache time (G)
.PP
.RS 4
このパラメータにより、
\fBwinbindd\fR(8)
デーモンが Windows NT Server に問い合わせを行なう代わりに、キャッシュしたユーザとグループの情報を 使用する時間を秒単位で指定する。
.sp
この設定は認証要求には適用されない。認証要求は
\fIwinbind offline logon\fRオプションが有効に されない限り、常にその度ごとに処理される。
.sp
Default:
\fI\fIwinbind cache time\fR\fR\fI = \fR\fI300\fR\fI \fR
.RE

winbind enum groups (G)
.PP
.RS 4
非常に大規模な環境において、
\fBwinbindd\fR(8)
を使用する際には、
setgrent()、
getgrent()、
endgrent()
といった システムコール群の呼び出しによるグループの一覧取得を抑止する 必要があるかも知れない。
\fIwinbind enum groups\fR
パラメータが
\fBno\fR
の場合、
getgrent()
システムコールの呼び出しは、全くデータを返却しない。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
グループ一覧(enumeration)を無効にするとプログラムによっては異常動作を引き起こす恐れがある。

Default:
\fI\fIwinbind enum groups\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

winbind enum users (G)
.PP
.RS 4
非常に大規模な環境において、
\fBwinbindd\fR(8)を使用する際には、
setpwent()、
getpwent()
や
endpwent()
といったシステムコール群の呼び出しによるユーザの一覧取得を抑止する必要があるかも知れない。
\fIwinbind enum users\fRパラメータが
\fBno\fR
の場合、
getpwent
システムコールの呼び出しは、全くデータを返却しない。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
ユーザ一覧(enumeration)を無効にするとプログラムによっては 異常動作を引き起こす恐れがある。 例えば、finger プログラムは、全てのユーザの一覧にアクセスできる前提で、 ユーザ名のマッチングを行なっている。

Default:
\fI\fIwinbind enum users\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

winbind expand groups (G)
.PP
.RS 4
このオプションは Windows ドメイングループのネストされた グループメンバーを展開する際に winbindd が探索を繰り返す 最大の階層を制御する。 これは ローカルグループのネスト化を Windows NT4 形式で実装している
\fIwinbind nested groups\fR
オプションとは 異なる。 "winbind expand groups" パラメーターはドメイングループの メンバーシップを明確に適用する。
.sp
このパラメーターに高い値を設定することは、最上位の winbindd デーモンがグループの展開を処理しなければならず、その間、 NSSや認証要求に対する応答が不可能となるために、システムの 性能低下をもたらすことに注意しなさい。
.sp
Default:
\fI\fIwinbind expand groups\fR\fR\fI = \fR\fI1\fR\fI \fR
.RE

winbind nested groups (G)
.PP
.RS 4
このパラメータを yes にすると、グループの入れ子が可能になる。 入れ子になるグループは、ローカルグループやエイリアスと呼ばれる。 これは、Windows のローカルグループに対応するものである。 入れ子になるグループは、各マシンローカルで定義され (ただしドメインコントローラ間では SAM を共有するため共有され)、 信頼される任意の SAM で定義されたユーザやグローバルグループを 含めることができる。 入れ子になるグループを用いるには、nss_winbind を有効にしておく 必要がある。
.sp
Default:
\fI\fIwinbind nested groups\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

winbind normalize names (G)
.PP
.RS 4
このパラメーターは、winbindd がユーザー名やグループ名に含まれる 空白をアンダースコア「_」に置き換えるかどうかを制御する。 例えば、"Space Kadet" という名前が、"space_kadet" という文字列に置き換えられるべきかどうかということを意味する。 シェルのデフォルトのフィールドセパレーターが空白であるため、 Unixのシェルスクリプトは空白を含むユーザー名を扱うことが難しい。 もしあなたのドメインでアカウント名にアンダースコアを含む場合には このオプションを有効にしてはならない。
.sp
Default:
\fI\fIwinbind normalize names\fR\fR\fI = \fR\fIno\fR\fI \fR
.sp
Example:
\fI\fIwinbind normalize names\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

winbind nss info (G)
.PP
.RS 4
このパラメータは、Winbind が Name Service Information からユーザの ホームディレクトリやログインシェルの情報を取得する方法を指定する。 現在のところ、以下の値が利用できる:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fItemplate\fR
\- デフォルト値であり、\fItemplate shell\fR
および
\fItemplate homedir\fRパラメータの値を用いる。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fI<sfu | rfc2307 >\fR
\- Samba が security = ads で実行されており、 Active Directory の DC が Microsoft Services for Unix (SFU) の LDAP スキーマをサポートしている場合、Winbind 機構は ログインシェルおよびホームディレクトリ属性を DC から 直接取得する。 UID や GID 情報を DC から取得したい場合は、
\fIidmap backend\fR
= ad や
\fIidmap config DOMAIN:backend\fR
= ad も設定すること。
.sp
.RE
.sp
Default:
\fI\fIwinbind nss info\fR\fR\fI = \fR\fItemplate\fR\fI \fR
.sp
Example:
\fI\fIwinbind nss info\fR\fR\fI = \fR\fItemplate sfu\fR\fI \fR
.RE

winbind offline logon (G)
.PP
.RS 4
このパラメータは、Winbind 機構で
\fIpam_winbind\fR
モジュールにキャッシュされた資格情報を用いたログインを可能に するかどうかを指定する。 有効にした場合、winbindd は、ログインに 成功したユーザの資格情報を、暗号化してローカルのキャッシュに 格納する。
.sp
Default:
\fI\fIwinbind offline logon\fR\fR\fI = \fR\fIfalse\fR\fI \fR
.sp
Example:
\fI\fIwinbind offline logon\fR\fR\fI = \fR\fItrue\fR\fI \fR
.RE

winbind refresh tickets (G)
.PP
.RS 4
このパラメータは Winbind 機構が
\fIpam_winbind\fR
モジュールから取得した Kerberos チケットをリフレッシュするかどうかを制御する。
.sp
Default:
\fI\fIwinbind refresh tickets\fR\fR\fI = \fR\fIfalse\fR\fI \fR
.sp
Example:
\fI\fIwinbind refresh tickets\fR\fR\fI = \fR\fItrue\fR\fI \fR
.RE

winbind rpc only (G)
.PP
.RS 4
このパラメーターをyesに 設定すると、winbindd がドメインコントローラーから情報を取得する際に、 LDAPの代わりにRPCを利用する。
.sp
Default:
\fI\fIwinbind rpc only\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

winbind separator (G)
.PP
.RS 4
このパラメータは、
\fIDOMAIN\fR\e\fIuser\fR
の形式でユーザ名を表示する際に使用される区切り文字を指定する。 このパラメータは UNIX のサービスが
\fIpam_winbind\.so\fR
および
\fInss_winbind\.so\fRモジュールを 使用する時のみ適用される。
.sp
+ 文字は NIS において /etc/group 中で特別な意味を持っているため、このパラメータを + に設定した場合、少なくとも glibc システムにおいては問題が発生する。
.sp
Default:
\fI\fIwinbind separator\fR\fR\fI = \fR\fI\'\e\'\fR\fI \fR
.sp
Example:
\fI\fIwinbind separator\fR\fR\fI = \fR\fI+\fR\fI \fR
.RE

winbind trusted domains only (G)
.PP
.RS 4
このパラメータは、Samba が管理するドメインの、他の Samba メンバーサーバに対して、NIS、rsync や LDAP で配布されている UNIX アカウントの uid を、プライマリドメインの winbindd ユーザの uid として使用するのを目的として設計された。 これにより、DOMAIN\euser1
というユーザは、 新しい uid が割り当てられる代わりに /etc/passwd の user1 というアカウントに割り当てられる。
.sp
このパラメーターは現在では idmap_nss バックエンドによって不要となっている。 詳細は、smb\.conf の
\fIidmap domains\fR
オプションと\fBidmap_nss\fR(8)
のmanページを参照のこと。
.sp
Default:
\fI\fIwinbind trusted domains only\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

winbind use default domain (G)
.PP
.RS 4
このパラメータにより、
\fBwinbindd\fR(8)
デーモンが、ドメイン名が 付加されていないユーザ名を扱う方式が指定される。 ドメイン名が付加されていないユーザは、winbindd サーバのドメイン のものとして扱われる。 Windows ユーザにとっては、どちらでもよい話であるが、 SSH, FTP や e\-mail を利用する際に、 UNIX システム本来のやり方に近い方法で 指定することが可能となる。
.sp
Default:
\fI\fIwinbind use default domain\fR\fR\fI = \fR\fIno\fR\fI \fR
.sp
Example:
\fI\fIwinbind use default domain\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

wins hook (G)
.PP
.RS 4
Samba が WINS サーバとして動いている場合、このオプションによって、 WINS データベースに対して変更が行なわれる度に外部のプログラムが起動されるようになる。このオプションの主な目的は、ダイナミック DNS のような外部の名前解決データベースの動的な更新を実現することである。
.sp
wins hook パラメータは、以下の形式で呼びだされるスクリプト又は実行形式のプログラムを指定する。
.sp
wins_hook operation name nametype ttl IP_list
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
最初の引数は操作の指定であり、 "add", "delete", "refresh" のいずれかを取る。 ほとんどの場合、残りのパラメータで提供される情報が不足している場合、操作は無視される(訳注: sufficient は insufficient の typo と思われる)。 "refresh" は名前がまだ追加されていない時点で呼び出されることがあるので注意。この場合操作は add として扱われる。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
3番目の引数は NetBIOS名のタイプで、2桁の16進数である。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
4番目の引数は 名前の TTL(生存時間) で秒数単位である。
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
5番目以降の引数は、その名前で現在登録されているIPアドレスである。リストが空の場合、名前は削除される。
.sp
.RE
BIND の動的なDNS更新プログラムである
nsupdate
を呼び出すスクリプトのサンプルが、 Samba ソースコードの examples ディレクトリに格納されている。
.sp
\fINo default\fR
.RE

wins proxy (G)
.PP
.RS 4
この真偽値パラメータにより、
\fBnmbd\fR(8)
が別のホストの代理としてブロードキャストによる名前問い合わせに応答するかどうかが設定される。古いクライアントの為に、このパラメータを
\fByes\fR
にする必要があるかも知れない。
.sp
Default:
\fI\fIwins proxy\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

wins server (G)
.PP
.RS 4
このパラメータは、
\fBnmbd\fR(8)
が名前を登録する WINS サーバの IP アドレス(もしくはDNS名: IPアドレスが望ましい)を指定する。ネットワークに WINS サーバが存在している場合は、このパラメータを WINS サーバの IP アドレスに設定すること。
.sp
複数サブネットからなるネットワークの場合は、このパラメータで WINS サーバを指定すべきである。
.sp
複数の名前空間が存在している場合、各々の WINS サーバに「タグ」をつけることが可能である。同じタグのついたサーバ内では 1 台の(動作中の)サーバに対してのみ、名前の問い合わせが行なわれる。タグはコロンによって IP アドレスと区切られる。
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
複数のサブネットからなるネットワークで、サブネット越しのブラウジングを正しく機能させたい場合は、 Samba で WINS サーバの設定を行なう必要がある。

Samba3\-HOWTO の Network Browsing 章を参照のこと。
.sp
Default:
\fI\fIwins server\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIwins server\fR\fR\fI = \fR\fImary:192\.9\.200\.1 fred:192\.168\.3\.199 mary:192\.168\.2\.61 # この例では、名前の問い合わせを行なう際に、 192\.9\.200\.1 に最初に問い合わせが行なわれる。応答がなかった場合は、 192\.168\.2\.61 に問い合わせが行なわれる。いずれのサーバからにも名前が存在しなかった場合、 192\.168\.3\.199 に対して問い合わせが行なわれる。\fR\fI \fR
.sp
Example:
\fI\fIwins server\fR\fR\fI = \fR\fI192\.9\.200\.1 192\.168\.2\.61\fR\fI \fR
.RE

wins support (G)
.PP
.RS 4
この真偽値パラメータにより、 Samba の
\fBnmbd\fR(8)
プロセスを WINS サーバして機能させるかどうかが設定される。複数サブネットに及ぶネットワークを構築しており、いずれかの
nmbd
を WINS サーバとして機能させようとしない限り、このパラメータを
\fByes\fR
にしないこと。
.sp
ネットワーク上の複数のマシンで、このパラメータを
\fByes\fR
に設定することが\fI絶対に\fRないように注意すること。
.sp
Default:
\fI\fIwins support\fR\fR\fI = \fR\fIno\fR\fI \fR
.RE

workgroup ()
.PP
.RS 4
これは、クライアントが問い合わせを行なった際に、 サーバが表示されるワークグループを設定する。 このパラメータにより、
\fIsecurity = domain\fR
の設定におけるドメイン名も設定されることに注意。
.sp
Default:
\fI\fIworkgroup\fR\fR\fI = \fR\fIWORKGROUP\fR\fI \fR
.sp
Example:
\fI\fIworkgroup\fR\fR\fI = \fR\fIMYGROUP\fR\fI \fR
.RE

writable
.PP
.RS 4
This parameter is a synonym for
writeable\.
.RE

writeable (S)
.PP
.RS 4
Inverted synonym for
\fIread only\fR\.
.sp
\fINo default\fR
.RE

write cache size (S)
.PP
.RS 4
If this integer parameter is set to non\-zero value, Samba will create an in\-memory cache for each oplocked file (it does
\fInot\fR
do this for non\-oplocked files)\. All writes that the client does not request to be flushed directly to disk will be stored in this cache if possible\. The cache is flushed onto disk when a write comes in whose offset would not fit into the cache or when the file is closed by the client\. Reads for the file are also served from this cache if the data is stored within it\.
.sp
This cache allows Samba to batch client writes into a more efficient write size for RAID disks (i\.e\. writes may be tuned to be the RAID stripe size) and can improve performance on systems where the disk subsystem is a bottleneck but there is free memory for userspace programs\.
.sp
The integer parameter specifies the size of this cache (per oplocked file) in bytes\.
.sp
Default:
\fI\fIwrite cache size\fR\fR\fI = \fR\fI0\fR\fI \fR
.sp
Example:
\fI\fIwrite cache size\fR\fR\fI = \fR\fI262144 # for a 256k cache size per file\fR\fI \fR
.RE

write list (S)
.PP
.RS 4
This is a list of users that are given read\-write access to a service\. If the connecting user is in this list then they will be given write access, no matter what the
\fIread only\fR
option is set to\. The list can include group names using the @group syntax\.
.sp
Note that if a user is in both the read list and the write list then they will be given write access\.
.sp
By design, this parameter will not work with the
\fIsecurity = share\fR
in Samba 3\.0\.
.sp
Default:
\fI\fIwrite list\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIwrite list\fR\fR\fI = \fR\fIadmin, root, @staff\fR\fI \fR
.RE

write raw (G)
.PP
.RS 4
このパラメータは、クライアントからのデータ転送時に、 サーバ側で raw write SMB のサポートを行なうかどうかを制御する。 このパラメータを変更する必要はないだろう。
.sp
Default:
\fI\fIwrite raw\fR\fR\fI = \fR\fIyes\fR\fI \fR
.RE

wtmp directory (G)
.PP
.RS 4
このパラメータは、 Sambaが
\-\-with\-utmp
オプションで configure され、コンパイルされた時にのみに有効である。 このパラメータは、 Sambaサーバへの接続を記録する wtmp または wtmpx ファイル (UNIXシステムに依存)が存在するディレクトリを指定する。 utmp directory との違いは、ユーザ情報がユーザのログオフ後も記録され続ける点である。
.sp
デフォルトではこの値は設定されない。 この場合、システムが利用している utmp ファイルが使われる (Linux の場合、通常
\fI/var/run/wtmp\fR
にある)。
.sp
Default:
\fI\fIwtmp directory\fR\fR\fI = \fR\fI\fR\fI \fR
.sp
Example:
\fI\fIwtmp directory\fR\fR\fI = \fR\fI/var/log/wtmp\fR\fI \fR
.RE
.SH "注意"
.PP
設定ファイルでは、スペースを含むサービス名も利用できるが、 クライアント側のソフトウェアで禁止されているかもしれない。 文字列比較を行なう際にスペースは常に無視されるため、 問題は発生しないはずであるが、可能性は考慮しておく必要がある。
.PP
同様の注意事項として、多くのクライアント、特に DOS クライアントでは、サービス名が最長8文字に制限されている。
\fBsmbd\fR(8)
にはそのような制限はなく、 こうしたクライアントからの接続要求は、サービス名が切り捨てられてしまう ために失敗することになる。このため、サービス名の長さは、最大 8 文字に制限すべきである。
.PP

[homes]
および
[printers]
という特殊セクションにより、 管理者の負担を軽減することができるが、デフォルトの設定の組合せ方に よっては、予期しない設定が行なわれる可能性もある。これらのセクションの 設定を行なう際には、特に注意深く行なうこと。特にスプールディレクトリの パーミッションが適切であることを確認しておくこと。
.SH "バージョン"
.PP
このマニュアルページは Samba 3\.0 対応のものである。
.SH "関連項目"
.PP

\fBsamba\fR(7),
\fBsmbpasswd\fR(8),
\fBswat\fR(8),
\fBsmbd\fR(8),
\fBnmbd\fR(8),
\fBsmbclient\fR(1),
\fBnmblookup\fR(1),
\fBtestparm\fR(1),
\fBtestprns\fR(1)
.SH "作者"
.PP
オリジナルの Samba ソフトウェアと関連するユーティリティは、 Andrew Tridgell によって作成された。現在 Samba は Samba Team によって、 Linux カーネルの開発と同様のオープンソースプロジェクトとして開発が 行なわれている。
.PP
オリジナルの Samba マニュアルページは Karl Auer によって 作成された。マニュアルページは YODL 形式 (ftp://ftp\.icce\.rug\.nl/pub/unix/
で入手可能な優れた オープンソースソフトウェア) に変換され、Samba 2\.0 リリースに伴い、 Jeremy Allison によって更新された。Samba 2\.2 における DocBook 形式への変換は、Gerald Carter によって行なわれた。Samba 3\.0 における DocBook XML 4\.2 形式への変換は Alexander Bokovoy によって行われた。
.SH "日本語訳"
.PP
このマニュアルページは Samba 3\.2\.4対応のものである。
.PP
Samba 3\.0\.23d 対応の翻訳は、たかはしもとのぶ (monyo@samba\.gr\.jp) によって行なわれた。
.PP
Samba 3\.2\.4 対応の翻訳は、 太田俊哉 (ribbon@samba\.gr\.jp) によって行なわれた。
